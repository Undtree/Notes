
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../OS/">
      
      
        <link rel="next" href="../CT/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>æ•°æ®åº“ç³»ç»Ÿ - Undertree's å°ç«™</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="../css/timeline.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jetbrains-mono@1.0.6/css/jetbrains-mono.min.css">
    
      <link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.1.0/style.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../stylesheets/card.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#relational-model" class="md-skip">
          è·³è½¬è‡³
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="é¡µçœ‰">
    <a href=".." title="Undertree&#39;s å°ç«™" class="md-header__button md-logo" aria-label="Undertree's å°ç«™" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 4v6l-2-2-2 2V4H9v16h10V4zM3 7V5h2V4a2 2 0 0 1 2-2h12c1.05 0 2 .95 2 2v16c0 1.05-.95 2-2 2H7c-1.05 0-2-.95-2-2v-1H3v-2h2v-4H3v-2h2V7zm2-2v2h2V5zm0 14h2v-2H5zm0-6h2v-2H5z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Undertree's å°ç«™
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              æ•°æ®åº“ç³»ç»Ÿ
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="åˆ‡æ¢è‡³æ—¥é—´æ¨¡å¼"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="åˆ‡æ¢è‡³æ—¥é—´æ¨¡å¼" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="åˆ‡æ¢è‡³å¤œé—´æ¨¡å¼"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="åˆ‡æ¢è‡³å¤œé—´æ¨¡å¼" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="åˆ‡æ¢è‡³è·Ÿéšç³»ç»Ÿ"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="åˆ‡æ¢è‡³è·Ÿéšç³»ç»Ÿ" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="æœç´¢" placeholder="æœç´¢" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="æŸ¥æ‰¾">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="åˆ†äº«" aria-label="åˆ†äº«" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="æ¸…ç©ºå½“å‰å†…å®¹" aria-label="æ¸…ç©ºå½“å‰å†…å®¹" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            æ­£åœ¨åˆå§‹åŒ–æœç´¢å¼•æ“
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Undtree/Notes/" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Undtree/Notes
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="æ ‡ç­¾" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../Network/" class="md-tabs__link">
          
  
  
    
  
  è®¡ç®—æœºç§‘å­¦

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../Crypto/" class="md-tabs__link">
          
  
  
    
  
  å®‰å…¨

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="å¯¼èˆªæ " data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Undertree&#39;s å°ç«™" class="md-nav__button md-logo" aria-label="Undertree's å°ç«™" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 4v6l-2-2-2 2V4H9v16h10V4zM3 7V5h2V4a2 2 0 0 1 2-2h12c1.05 0 2 .95 2 2v16c0 1.05-.95 2-2 2H7c-1.05 0-2-.95-2-2v-1H3v-2h2v-4H3v-2h2V7zm2-2v2h2V5zm0 14h2v-2H5zm0-6h2v-2H5z"/></svg>

    </a>
    Undertree's å°ç«™
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Undtree/Notes/" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Undtree/Notes
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    è®¡ç®—æœºç§‘å­¦
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            è®¡ç®—æœºç§‘å­¦
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Network/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    è®¡ç®—æœºç½‘ç»œ
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    æ“ä½œç³»ç»Ÿ
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    æ•°æ®åº“ç³»ç»Ÿ
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    æ•°æ®åº“ç³»ç»Ÿ
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="ç›®å½•">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ç›®å½•
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#relational-model" class="md-nav__link">
    <span class="md-ellipsis">
      Relational Model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relational-algebra" class="md-nav__link">
    <span class="md-ellipsis">
      Relational Algebra
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Relational Algebra">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      åŸºç¡€æ“ä½œ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      è¿›é˜¶æ“ä½œ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sql" class="md-nav__link">
    <span class="md-ellipsis">
      SQL
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SQL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sql_1" class="md-nav__link">
    <span class="md-ellipsis">
      SQLçš„å†å²å‘å±•
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql_2" class="md-nav__link">
    <span class="md-ellipsis">
      SQLæ•°æ®ç±»å‹
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql_3" class="md-nav__link">
    <span class="md-ellipsis">
      SQLè¯­å¥è§„èŒƒ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql_4" class="md-nav__link">
    <span class="md-ellipsis">
      é«˜çº§SQL
    </span>
  </a>
  
    <nav class="md-nav" aria-label="é«˜çº§SQL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sql_5" class="md-nav__link">
    <span class="md-ellipsis">
      åœ¨é«˜çº§ç¼–ç¨‹è¯­è¨€ä¸­ä½¿ç”¨SQL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      è¿‡ç¨‹åŒ–æ‰©å±•
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trigger" class="md-nav__link">
    <span class="md-ellipsis">
      è§¦å‘å™¨(Trigger)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olap" class="md-nav__link">
    <span class="md-ellipsis">
      é«˜çº§èšåˆä¸OLAP
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      æ•°æ®åº“è®¾è®¡èŒƒå¼
    </span>
  </a>
  
    <nav class="md-nav" aria-label="æ•°æ®åº“è®¾è®¡èŒƒå¼">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#e-r" class="md-nav__link">
    <span class="md-ellipsis">
      E-Ræ¨¡å‹
    </span>
  </a>
  
    <nav class="md-nav" aria-label="E-Ræ¨¡å‹">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      æ¨¡å‹æ¦‚å¿µ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      å­˜å‚¨
    </span>
  </a>
  
    <nav class="md-nav" aria-label="å­˜å‚¨">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      å­˜å‚¨å±‚çº§
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      ç£ç›˜å­˜å‚¨æ¥å£
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      ç£ç›˜å·¥ä½œæœºåˆ¶
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      ç£ç›˜æ€§èƒ½è¯„ä¼°
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flash-storage" class="md-nav__link">
    <span class="md-ellipsis">
      é—ªå­˜ Flash Storage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      æ•°æ®å­˜å‚¨ç»“æ„
    </span>
  </a>
  
    <nav class="md-nav" aria-label="æ•°æ®å­˜å‚¨ç»“æ„">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      å•æ¡è®°å½•
    </span>
  </a>
  
    <nav class="md-nav" aria-label="å•æ¡è®°å½•">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      å®šé•¿è®°å½•å­˜å‚¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      ä¸å®šé•¿è®°å½•å­˜å‚¨
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slotted-page" class="md-nav__link">
    <span class="md-ellipsis">
      æ§½å¼é¡µ(Slotted Page)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      æ–‡ä»¶è®°å½•ç»„ç»‡
    </span>
  </a>
  
    <nav class="md-nav" aria-label="æ–‡ä»¶è®°å½•ç»„ç»‡">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#heap" class="md-nav__link">
    <span class="md-ellipsis">
      å †(Heap)æ–‡ä»¶ç®¡ç†
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequential" class="md-nav__link">
    <span class="md-ellipsis">
      é¡ºåº(Sequential)æ–‡ä»¶ç®¡ç†
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multitable-clustering" class="md-nav__link">
    <span class="md-ellipsis">
      å¤šè¡¨èšç°‡(Multitable Clustering)æ–‡ä»¶ç®¡ç†
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#table-partitioning" class="md-nav__link">
    <span class="md-ellipsis">
      Table Partitioning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-tree-file-index" class="md-nav__link">
    <span class="md-ellipsis">
      B+ Tree File Index
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-dictionary-storage" class="md-nav__link">
    <span class="md-ellipsis">
      æ•°æ®å­—å…¸å­˜å‚¨(Data Dictionary Storage)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      ç¼“å†²åŒº/ç¼“å­˜
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#indexing" class="md-nav__link">
    <span class="md-ellipsis">
      ç´¢å¼•(Indexing)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç´¢å¼•(Indexing)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      æœ‰åºç´¢å¼•å’Œæ— åºç´¢å¼•
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b" class="md-nav__link">
    <span class="md-ellipsis">
      B+æ ‘ç´¢å¼•
    </span>
  </a>
  
    <nav class="md-nav" aria-label="B+æ ‘ç´¢å¼•">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#b_1" class="md-nav__link">
    <span class="md-ellipsis">
      B+æ ‘çš„ç»“æ„
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b_2" class="md-nav__link">
    <span class="md-ellipsis">
      B+æ ‘ç´¢å¼•çš„æ“ä½œ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      å†…å­˜ç´¢å¼•ä¼˜åŒ–
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      é«˜çº§ç´¢å¼•
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      å†™å…¥ä¼˜åŒ–ç´¢å¼•
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      æŸ¥è¯¢å¤„ç†
    </span>
  </a>
  
    <nav class="md-nav" aria-label="æŸ¥è¯¢å¤„ç†">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#selection" class="md-nav__link">
    <span class="md-ellipsis">
      é€‰æ‹©(Selection)æ“ä½œ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sorting" class="md-nav__link">
    <span class="md-ellipsis">
      æ’åº(Sorting)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#join" class="md-nav__link">
    <span class="md-ellipsis">
      è¿æ¥(Join)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="è¿æ¥(Join)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nested-loop-join" class="md-nav__link">
    <span class="md-ellipsis">
      Nested-Loop Join
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#block-nested-loop-join" class="md-nav__link">
    <span class="md-ellipsis">
      Block Nested-Loop Join
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#indexed-nested-loop-join" class="md-nav__link">
    <span class="md-ellipsis">
      Indexed Nested-Loop Join
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#merge-join" class="md-nav__link">
    <span class="md-ellipsis">
      Merge Join
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hash-join" class="md-nav__link">
    <span class="md-ellipsis">
      Hash Join
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      æ•´ä½“è¡¨è¾¾å¼æ ‘çš„æ›¿ä»£æ–¹æ³•
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      æŸ¥è¯¢ä¼˜åŒ–
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transaction" class="md-nav__link">
    <span class="md-ellipsis">
      äº‹åŠ¡(Transaction)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="äº‹åŠ¡(Transaction)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#acid" class="md-nav__link">
    <span class="md-ellipsis">
      ACID
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      å¹¶å‘æ§åˆ¶
    </span>
  </a>
  
    <nav class="md-nav" aria-label="å¹¶å‘æ§åˆ¶">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#serializability" class="md-nav__link">
    <span class="md-ellipsis">
      å¯ä¸²è¡Œæ€§(Serializability)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      çº§è”è°ƒåº¦
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    <span class="md-ellipsis">
      å¼±ä¸€è‡´æ€§ç­‰çº§
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    <span class="md-ellipsis">
      å¹¶å‘æ§åˆ¶å®ç°
    </span>
  </a>
  
    <nav class="md-nav" aria-label="å¹¶å‘æ§åˆ¶å®ç°">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lock-based-protocols" class="md-nav__link">
    <span class="md-ellipsis">
      Lock-Based Protocols
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#two-phase-locking-2pl-protocol" class="md-nav__link">
    <span class="md-ellipsis">
      Two-Phase Locking (2PL) Protocol
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    <span class="md-ellipsis">
      æ­»é”å¤„ç†
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tree-based-protocol" class="md-nav__link">
    <span class="md-ellipsis">
      Tree-Based Protocol
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-granularity-locking" class="md-nav__link">
    <span class="md-ellipsis">
      å¤šç²’åº¦é”(Multiple Granularity Locking)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    <span class="md-ellipsis">
      é”™è¯¯æ¢å¤
    </span>
  </a>
  
    <nav class="md-nav" aria-label="é”™è¯¯æ¢å¤">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    <span class="md-ellipsis">
      æ—¥å¿—
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    è®¡ç®—ç†è®º
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    å®‰å…¨
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            å®‰å…¨
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Crypto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    å¯†ç å­¦
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="ç›®å½•">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ç›®å½•
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#relational-model" class="md-nav__link">
    <span class="md-ellipsis">
      Relational Model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relational-algebra" class="md-nav__link">
    <span class="md-ellipsis">
      Relational Algebra
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Relational Algebra">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      åŸºç¡€æ“ä½œ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      è¿›é˜¶æ“ä½œ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sql" class="md-nav__link">
    <span class="md-ellipsis">
      SQL
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SQL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sql_1" class="md-nav__link">
    <span class="md-ellipsis">
      SQLçš„å†å²å‘å±•
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql_2" class="md-nav__link">
    <span class="md-ellipsis">
      SQLæ•°æ®ç±»å‹
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql_3" class="md-nav__link">
    <span class="md-ellipsis">
      SQLè¯­å¥è§„èŒƒ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql_4" class="md-nav__link">
    <span class="md-ellipsis">
      é«˜çº§SQL
    </span>
  </a>
  
    <nav class="md-nav" aria-label="é«˜çº§SQL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sql_5" class="md-nav__link">
    <span class="md-ellipsis">
      åœ¨é«˜çº§ç¼–ç¨‹è¯­è¨€ä¸­ä½¿ç”¨SQL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      è¿‡ç¨‹åŒ–æ‰©å±•
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trigger" class="md-nav__link">
    <span class="md-ellipsis">
      è§¦å‘å™¨(Trigger)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olap" class="md-nav__link">
    <span class="md-ellipsis">
      é«˜çº§èšåˆä¸OLAP
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      æ•°æ®åº“è®¾è®¡èŒƒå¼
    </span>
  </a>
  
    <nav class="md-nav" aria-label="æ•°æ®åº“è®¾è®¡èŒƒå¼">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#e-r" class="md-nav__link">
    <span class="md-ellipsis">
      E-Ræ¨¡å‹
    </span>
  </a>
  
    <nav class="md-nav" aria-label="E-Ræ¨¡å‹">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      æ¨¡å‹æ¦‚å¿µ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      å­˜å‚¨
    </span>
  </a>
  
    <nav class="md-nav" aria-label="å­˜å‚¨">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      å­˜å‚¨å±‚çº§
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      ç£ç›˜å­˜å‚¨æ¥å£
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      ç£ç›˜å·¥ä½œæœºåˆ¶
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      ç£ç›˜æ€§èƒ½è¯„ä¼°
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flash-storage" class="md-nav__link">
    <span class="md-ellipsis">
      é—ªå­˜ Flash Storage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      æ•°æ®å­˜å‚¨ç»“æ„
    </span>
  </a>
  
    <nav class="md-nav" aria-label="æ•°æ®å­˜å‚¨ç»“æ„">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      å•æ¡è®°å½•
    </span>
  </a>
  
    <nav class="md-nav" aria-label="å•æ¡è®°å½•">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      å®šé•¿è®°å½•å­˜å‚¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      ä¸å®šé•¿è®°å½•å­˜å‚¨
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slotted-page" class="md-nav__link">
    <span class="md-ellipsis">
      æ§½å¼é¡µ(Slotted Page)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      æ–‡ä»¶è®°å½•ç»„ç»‡
    </span>
  </a>
  
    <nav class="md-nav" aria-label="æ–‡ä»¶è®°å½•ç»„ç»‡">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#heap" class="md-nav__link">
    <span class="md-ellipsis">
      å †(Heap)æ–‡ä»¶ç®¡ç†
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequential" class="md-nav__link">
    <span class="md-ellipsis">
      é¡ºåº(Sequential)æ–‡ä»¶ç®¡ç†
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multitable-clustering" class="md-nav__link">
    <span class="md-ellipsis">
      å¤šè¡¨èšç°‡(Multitable Clustering)æ–‡ä»¶ç®¡ç†
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#table-partitioning" class="md-nav__link">
    <span class="md-ellipsis">
      Table Partitioning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-tree-file-index" class="md-nav__link">
    <span class="md-ellipsis">
      B+ Tree File Index
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-dictionary-storage" class="md-nav__link">
    <span class="md-ellipsis">
      æ•°æ®å­—å…¸å­˜å‚¨(Data Dictionary Storage)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      ç¼“å†²åŒº/ç¼“å­˜
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#indexing" class="md-nav__link">
    <span class="md-ellipsis">
      ç´¢å¼•(Indexing)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç´¢å¼•(Indexing)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      æœ‰åºç´¢å¼•å’Œæ— åºç´¢å¼•
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b" class="md-nav__link">
    <span class="md-ellipsis">
      B+æ ‘ç´¢å¼•
    </span>
  </a>
  
    <nav class="md-nav" aria-label="B+æ ‘ç´¢å¼•">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#b_1" class="md-nav__link">
    <span class="md-ellipsis">
      B+æ ‘çš„ç»“æ„
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b_2" class="md-nav__link">
    <span class="md-ellipsis">
      B+æ ‘ç´¢å¼•çš„æ“ä½œ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      å†…å­˜ç´¢å¼•ä¼˜åŒ–
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      é«˜çº§ç´¢å¼•
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      å†™å…¥ä¼˜åŒ–ç´¢å¼•
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      æŸ¥è¯¢å¤„ç†
    </span>
  </a>
  
    <nav class="md-nav" aria-label="æŸ¥è¯¢å¤„ç†">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#selection" class="md-nav__link">
    <span class="md-ellipsis">
      é€‰æ‹©(Selection)æ“ä½œ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sorting" class="md-nav__link">
    <span class="md-ellipsis">
      æ’åº(Sorting)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#join" class="md-nav__link">
    <span class="md-ellipsis">
      è¿æ¥(Join)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="è¿æ¥(Join)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nested-loop-join" class="md-nav__link">
    <span class="md-ellipsis">
      Nested-Loop Join
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#block-nested-loop-join" class="md-nav__link">
    <span class="md-ellipsis">
      Block Nested-Loop Join
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#indexed-nested-loop-join" class="md-nav__link">
    <span class="md-ellipsis">
      Indexed Nested-Loop Join
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#merge-join" class="md-nav__link">
    <span class="md-ellipsis">
      Merge Join
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hash-join" class="md-nav__link">
    <span class="md-ellipsis">
      Hash Join
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      æ•´ä½“è¡¨è¾¾å¼æ ‘çš„æ›¿ä»£æ–¹æ³•
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      æŸ¥è¯¢ä¼˜åŒ–
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transaction" class="md-nav__link">
    <span class="md-ellipsis">
      äº‹åŠ¡(Transaction)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="äº‹åŠ¡(Transaction)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#acid" class="md-nav__link">
    <span class="md-ellipsis">
      ACID
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      å¹¶å‘æ§åˆ¶
    </span>
  </a>
  
    <nav class="md-nav" aria-label="å¹¶å‘æ§åˆ¶">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#serializability" class="md-nav__link">
    <span class="md-ellipsis">
      å¯ä¸²è¡Œæ€§(Serializability)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      çº§è”è°ƒåº¦
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    <span class="md-ellipsis">
      å¼±ä¸€è‡´æ€§ç­‰çº§
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    <span class="md-ellipsis">
      å¹¶å‘æ§åˆ¶å®ç°
    </span>
  </a>
  
    <nav class="md-nav" aria-label="å¹¶å‘æ§åˆ¶å®ç°">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lock-based-protocols" class="md-nav__link">
    <span class="md-ellipsis">
      Lock-Based Protocols
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#two-phase-locking-2pl-protocol" class="md-nav__link">
    <span class="md-ellipsis">
      Two-Phase Locking (2PL) Protocol
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    <span class="md-ellipsis">
      æ­»é”å¤„ç†
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tree-based-protocol" class="md-nav__link">
    <span class="md-ellipsis">
      Tree-Based Protocol
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-granularity-locking" class="md-nav__link">
    <span class="md-ellipsis">
      å¤šç²’åº¦é”(Multiple Granularity Locking)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    <span class="md-ellipsis">
      é”™è¯¯æ¢å¤
    </span>
  </a>
  
    <nav class="md-nav" aria-label="é”™è¯¯æ¢å¤">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    <span class="md-ellipsis">
      æ—¥å¿—
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>æ•°æ®åº“ç³»ç»Ÿ</h1>

<div style="margin-top: -30px; font-size: 0.75em; opacity: 0.7;">
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10h-2a8 8 0 0 1-8 8 8 8 0 0 1-8-8 8 8 0 0 1 8-8zm6.78 1a.7.7 0 0 0-.48.2l-1.22 1.21 2.5 2.5L20.8 5.7c.26-.26.26-.7 0-.95L19.25 3.2c-.13-.13-.3-.2-.47-.2m-2.41 2.12L9 12.5V15h2.5l7.37-7.38z"/></svg></span> çº¦ 17797 ä¸ªå­— <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M360.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6m64.6 136.1c-12.5 12.5-12.5 32.8 0 45.3l73.4 73.4-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l96-96c12.5-12.5 12.5-32.8 0-45.3l-96-96c-12.5-12.5-32.8-12.5-45.3 0zm-274.7 0c-12.5-12.5-32.8-12.5-45.3 0l-96 96c-12.5 12.5-12.5 32.8 0 45.3l96 96c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l73.3-73.4c12.5-12.5 12.5-32.8 0-45.3z"/></svg></span> 69 è¡Œä»£ç  <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 17H7V3h14m0-2H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2M3 5H1v16a2 2 0 0 0 2 2h16v-2H3m12.96-10.71-2.75 3.54-1.96-2.36L8.5 15h11z"/></svg></span> 41 å¼ å›¾ç‰‡ <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20c4.42 0 8-3.58 8-8s-3.58-8-8-8-8 3.58-8 8 3.58 8 8 8m0-18c5.5 0 10 4.5 10 10s-4.5 10-10 10C6.47 22 2 17.5 2 12S6.5 2 12 2m.5 11H11V7h1.5v4.26l3.7-2.13.75 1.3z"/></svg></span> é¢„è®¡é˜…è¯»æ—¶é—´ 60 åˆ†é’Ÿ</p>
</div>
<div class="admonition abstract">
<p class="admonition-title">Abstract</p>
<p><strong>è¯¾ç¨‹ä¿¡æ¯</strong>
- é»„å¿ ä¸œè€å¸ˆæˆè¯¾ã€‚</p>
<ul>
<li>
<p>å‚è€ƒç”¨ä¹¦ï¼šã€ŠDatabase System Conceptã€‹, 7th Edition</p>
</li>
<li>
<p>Grading Policy</p>
</li>
</ul>
</div>
<div class="admonition è¿™é—¨è¯¾è®²ä»€ä¹ˆ">
<p class="admonition-title">è¿™é—¨è¯¾è®²ä»€ä¹ˆ</p>
<p>åœ¨è¿™é—¨è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ åˆ°æœ‰ä¸¥æ ¼äº‹åŠ¡è¦æ±‚(data access requirement)çš„ç»“æ„åŒ–æ•°æ®(data type)çš„ç®¡ç†ã€‚</p>
</div>
<div class="admonition success">
<p class="admonition-title">ç‰¹åˆ«é¸£è°¢ğŸ™‡â€</p>
<ul>
<li>
<p>Github ä¸Š [@yile-liu] (https://github.com/yile-liu/ZJU_database_system)è€å¸ˆçš„æ•°æ®åº“ç³»ç»Ÿç¬”è®°ã€‚</p>
</li>
<li>
<p>Chritch è€å¸ˆçš„åšå®¢ <a href="https://obsidian.zerokei.top/Hub/Database%20System/">æ•°æ®åº“ç³»ç»Ÿç¯‡</a></p>
</li>
<li>
<p>MEM ä½¬çš„åšå®¢ <a href="https://mem.ac">mem.ac</a></p>
</li>
</ul>
</div>
<!---->

<h2 id="relational-model">Relational Model<a class="headerlink" href="#relational-model" title="Permanent link">&para;</a></h2>
<p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š</p>
<p><img alt="relation_example" src="../images/DB/db1.png" /></p>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè“åº•çš„åˆ—åè¢«ç§°ä¸º<strong>attributes(å±æ€§)</strong>ï¼Œä¸‹é¢çš„æ¯ä¸€è¡Œè¢«ç§°ä¸ºä¸€ä¸ª<strong>tuple(å…ƒç»„)</strong>ã€‚æˆ‘ä»¬ç»™å®š <span class="arithmatex">\(A_1, A_2, â€¦, A_n\)</span> æ˜¯ä¸€ç³»åˆ— attributes ï¼Œé‚£ä¹ˆ</p>
<div class="arithmatex">\[
R = (A_1, A_2, â€¦, A_n )
\]</div>
<p>è¢«ç§°ä¸º<strong>relation schema</strong>ã€‚ä¸€èˆ¬åœ°ï¼Œæˆ‘ä»¬ç”¨ <span class="arithmatex">\(R\)</span> ç­‰å¤§å†™å­—æ¯è¡¨è®°ä¸€ä¸ª relation schema ï¼Œç”¨ <span class="arithmatex">\(r\)</span> ç­‰å°å†™å­—æ¯è¡¨è®°ä¸€ä¸ª relation instanceã€‚</p>
<p>æ¯ä¸€åˆ—çš„æ‰€æœ‰å¯å–å€¼(å–å€¼èŒƒå›´)è¢«ç§°ä¸ºå®ƒçš„<strong>domain</strong>ã€‚æˆ‘ä»¬ç»™å®šåˆ— <span class="arithmatex">\(A_i\)</span> çš„ domain æ˜¯ <span class="arithmatex">\(D_i\)</span> ï¼Œé‚£ä¹ˆä»å½¢å¼ä¸Šè¯´ï¼Œä¸€ä¸ª<strong>å…³ç³»(relation)</strong>å°±æ˜¯ <span class="arithmatex">\(D_1 \times D_2 \times ... \times D_n\)</span> çš„ä¸€ä¸ªå­é›†ã€‚</p>
<p>æ¢å¥è¯è¯´ï¼Œä¸€ä¸ª relation instance å°±æ˜¯ä¸€å¼ è¡¨æ ¼ï¼Œæ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªäº‹ç‰©ï¼Œæ¯ä¸€åˆ—ä»£è¡¨ä¸€é¡¹å±æ€§ã€‚</p>
<p>ä¸€ä¸ª<strong>æ•°æ®åº“(Database)</strong>å°±æ˜¯ç”±å¤šä¸ª relation ç»„æˆçš„ã€‚è¿™ä¸€ç‚¹åœ¨åç»­ SQL éƒ¨åˆ†è¿˜ä¼šæœ‰æ‰€ä½“ç°ã€‚</p>
<p>æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ¦‚å¿µï¼š<strong>é”®(key)</strong>ï¼Œå¹¶è§„å®šé”® <span class="arithmatex">\(K \subseteq R~\mbox{(Relation Schema)}\)</span>ï¼Œé”®å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªåˆ—åã€‚</p>
<ul>
<li>
<p><span class="arithmatex">\(K\)</span> is a <strong>superkey(è¶…é”®)</strong> of <span class="arithmatex">\(R\)</span> if values for <span class="arithmatex">\(K\)</span> are sufficient to identify a unique tuple of each possible relation <span class="arithmatex">\(r\)</span>.</p>
</li>
<li>
<p>Superkey <span class="arithmatex">\(K\)</span> is a <strong>candidate key(å€™é€‰é”®)</strong> if the number of attributes in <span class="arithmatex">\(K\)</span> is minimal (If we remove one more attribute in <span class="arithmatex">\(K\)</span>, <span class="arithmatex">\(K\)</span> will not be a superkey).</p>
<p>Note that <u>Candidate key can have more than one attribute</u>.</p>
</li>
<li>
<p>One of the candidate keys is selected to be the <strong>primary key(ä¸»é”®)</strong>.</p>
</li>
<li>
<p><strong>Foreign key(å¤–é”®)</strong> constraint: Value in one relation must appear in another.</p>
<p>Assume there exists relations <span class="arithmatex">\(r\)</span> and <span class="arithmatex">\(s\)</span>: <span class="arithmatex">\(r(A,B,C)\)</span>, <span class="arithmatex">\(s(B,D)\)</span>, we can say that attribute <span class="arithmatex">\(B\)</span> in relation <span class="arithmatex">\(r\)</span> is foreign key referencing <span class="arithmatex">\(s\)</span>, and <span class="arithmatex">\(r\)</span> is a referencing relation, and <span class="arithmatex">\(s\)</span> is a referenced relation.</p>
<p>referencing relation æ˜¯â€œå¼•ç”¨â€ï¼Œå…¶è¡¨è¿°çš„æ˜¯å¤–é”®æ‰€åœ¨çš„ relation ï¼› referenced relation æ˜¯â€œè¢«å¼•ç”¨â€ï¼Œå…¶è¡¨è¿°çš„æ˜¯è¢«å¼•ç”¨çš„é”®æ‰€åœ¨çš„ relationã€‚</p>
</li>
</ul>
<h2 id="relational-algebra">Relational Algebra<a class="headerlink" href="#relational-algebra" title="Permanent link">&para;</a></h2>
<p>éœ€è¦æ³¨æ„ï¼š</p>
<ul>
<li>å…³ç³»ä»£æ•°çš„è¾“å…¥å’Œè¾“å‡ºéƒ½æ˜¯ relationsã€‚</li>
</ul>
<h3 id="_1">åŸºç¡€æ“ä½œ<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th style="text-align: center;">æ“ä½œ</th>
<th style="text-align: center;">è¡¨è¾¾å¼</th>
<th style="text-align: center;">å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">é€‰æ‹©</td>
<td style="text-align: center;"><span class="arithmatex">\(\sigma_{p}{(r)}\)</span></td>
<td style="text-align: center;">å•å…³ç³»æ“ä½œã€‚è¿”å›å…³ç³» <span class="arithmatex">\(r\)</span> ä¸­æ»¡è¶³å…³ç³»å¼ <span class="arithmatex">\(p\)</span> çš„å…ƒç»„çš„å…³ç³»</td>
</tr>
<tr>
<td style="text-align: center;">æŠ•å½±</td>
<td style="text-align: center;"><span class="arithmatex">\(\Pi_{~A_1,A_2,...,A_3~}{(r)}\)</span></td>
<td style="text-align: center;">å•å…³ç³»æ“ä½œã€‚è¿”å›å…³ç³» <span class="arithmatex">\(r\)</span> ä¸­å±æ€§ä¸º <span class="arithmatex">\(A_1, A_2, ..., A_n\)</span> çš„åˆ—å¹¶<strong>å»é‡</strong></td>
</tr>
<tr>
<td style="text-align: center;">é‡å‘½å</td>
<td style="text-align: center;"><span class="arithmatex">\(\rho_{x}{(E)}\)</span></td>
<td style="text-align: center;">å•å…³ç³»æ“ä½œã€‚å°† <span class="arithmatex">\(E\)</span> é‡å‘½åä¸º <span class="arithmatex">\(x\)</span> å¹¶è¿”å›</td>
</tr>
<tr>
<td style="text-align: center;">é›†åˆå¹¶</td>
<td style="text-align: center;"><span class="arithmatex">\(r \cup s\)</span></td>
<td style="text-align: center;">å°†ä¸¤ä¸ªå±æ€§æ•°ç›¸ç­‰ä¸”æ‰€æœ‰å±æ€§çš„åŸŸç›¸åŒçš„ä¸¤ä¸ªå…³ç³»åˆå¹¶ä¸ºåŒä¸€ä¸ªå…³ç³»ï¼Œå¹¶<strong>å»é‡</strong></td>
</tr>
<tr>
<td style="text-align: center;">é›†åˆå·®</td>
<td style="text-align: center;"><span class="arithmatex">\(r - s\)</span></td>
<td style="text-align: center;">è¿”å›<u>å±äºå…³ç³» <span class="arithmatex">\(r\)</span> </u>å´ä¸å‡ºç°åœ¨å…³ç³» <span class="arithmatex">\(s\)</span> ä¸­çš„å…ƒç»„çš„å…³ç³»</td>
</tr>
<tr>
<td style="text-align: center;">ç¬›å¡å°”ç§¯</td>
<td style="text-align: center;"><span class="arithmatex">\(r \times s\)</span></td>
<td style="text-align: center;">è¿”å›ä»»æ„ä¸¤ä¸ªå…³ç³»çš„å…ƒç»„ç»„åˆ (ä¸¤ä¸ªå…³ç³»çš„å±æ€§åº”ä¸ç›¸äº¤ï¼Œå¦åˆ™åº”é‡å‘½å)</td>
</tr>
</tbody>
</table>
<h3 id="_2">è¿›é˜¶æ“ä½œ<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th style="text-align: center;">æ“ä½œ</th>
<th style="text-align: center;">è¡¨è¾¾å¼</th>
<th style="text-align: center;">å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">é›†åˆäº¤</td>
<td style="text-align: center;"><span class="arithmatex">\(r \cap s\)</span></td>
<td style="text-align: center;">å–åŒæ—¶å‡ºç°åœ¨ä¸¤ä¸ªå…³ç³»ä¸­çš„å…ƒç»„ï¼Œå¯è½¬åŒ–ä¸º <span class="arithmatex">\(r - (r - s)\)</span></td>
</tr>
<tr>
<td style="text-align: center;">è‡ªç„¶è¿æ¥</td>
<td style="text-align: center;"><span class="arithmatex">\(r \bowtie s\)</span></td>
<td style="text-align: center;">å–ä¸¤ä¸ªå…³ç³»å…¬å…±å±æ€§ä¸­å…·æœ‰<strong>ç›¸åŒå±æ€§å€¼</strong>çš„å…ƒç»„è¿›è¡Œæ‹¼æ¥</td>
</tr>
<tr>
<td style="text-align: center;"><span class="arithmatex">\(\theta\)</span> è¿æ¥</td>
<td style="text-align: center;"><span class="arithmatex">\(r \bowtie_{\theta} s\)</span></td>
<td style="text-align: center;">è¿”å›æ»¡è¶³å…³ç³»å¼</td>
</tr>
<tr>
<td style="text-align: center;">é™¤</td>
<td style="text-align: center;">$r \div s $</td>
<td style="text-align: center;"><span class="arithmatex">\(r \div s = \Pi_{R-S}(r) - \Pi_{R-S}\big( (\Pi_{R-S}(r) \times s - r \big)\)</span>ï¼Œæ‰¾å‡ºä¸â€œé™¤æ•°â€å…³ç³»ä¸­æ‰€æœ‰å…ƒç»„éƒ½æœ‰è”ç³»(èƒ½è¿æ¥)çš„å…ƒç»„ã€‚<span class="arithmatex">\(R-S\)</span> ä»£è¡¨ <span class="arithmatex">\( r \)</span> å’Œ <span class="arithmatex">\( s \)</span> çš„å±æ€§é›†å·®ã€‚</td>
</tr>
<tr>
<td style="text-align: center;">èµ‹å€¼</td>
<td style="text-align: center;"><span class="arithmatex">\(r \leftarrow E\)</span></td>
<td style="text-align: center;">å°†å³è¾¹çš„è®¡ç®—ç»“æœèµ‹å€¼ç»™å·¦è¾¹çš„è¡¨</td>
</tr>
<tr>
<td style="text-align: center;"><br>èšé›†</td>
<td style="text-align: center;"><br><span class="arithmatex">\(_{G_1, G_2, ..., G_n}~\mathcal{G}_{F_1(A_1), F_2(A_2), ..., F_n(A_n)}{r}\)</span></td>
<td style="text-align: center;"><span class="arithmatex">\(G_i\)</span> æ˜¯ç”¨äºåˆ†ç»„çš„å±æ€§ (å¯ä¸ºç©º) ï¼Œ<span class="arithmatex">\(F_i\)</span> æ˜¯èšé›†å‡½æ•° (åæ˜ åœ¨æ•°æ®åº“ä¸­å°±æ˜¯<code>sum</code>/<code>avg</code>ç­‰å‡½æ•°) ï¼Œ<span class="arithmatex">\(A_i\)</span> æ˜¯å±æ€§åã€‚èšé›†æ“ä½œå¯¹ä¸€ç»„å€¼æ‰§è¡Œè®¡ç®—å¹¶è¿”å›å•ä¸ªå€¼ï¼Œå®ƒå¯¹æ•°æ®é›†åˆè¿›è¡Œ"çºµå‘"è®¡ç®— (è·¨å¤šè¡Œè®¡ç®—)ã€‚å‡è®¾å·²ç»æŒ‡å®šç”¨äºåˆ†ç»„çš„å±æ€§ï¼Œåˆ™æŒ‰æŒ‡å®šå±æ€§å°†å…³ç³»åˆ’åˆ†ä¸ºå¤šä¸ªç»„ï¼Œå¯¹æ¯ä¸ªç»„ç‹¬ç«‹åº”ç”¨èšåˆå‡½æ•°ï¼Œæ¯ç»„äº§ç”Ÿä¸€ä¸ªç»“æœå…ƒç»„</td>
</tr>
</tbody>
</table>
<h2 id="sql">SQL<a class="headerlink" href="#sql" title="Permanent link">&para;</a></h2>
<div class="admonition tip">
<p class="admonition-title">è¿™ä¸ªç« èŠ‚å¯¹åº”æ•™æç¬¬ 3-5 ç« ã€‚</p>
</div>
<p>SQL å…¨ç§°ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€(Structured Query Language)ã€‚SQL æ•°æ®å®šä¹‰è¯­è¨€(DDL)å…è®¸å®šä¹‰ä»¥ä¸‹å…³ç³»ä¿¡æ¯ï¼š</p>
<ul>
<li>
<p>æ¯ä¸ªå…³ç³»çš„æ¨¡å¼(schema)</p>
</li>
<li>
<p>å„å±æ€§å…³è”çš„å€¼ç±»å‹</p>
</li>
<li>
<p>å®Œæ•´æ€§çº¦æŸ</p>
</li>
<li>
<p>ä¸ºæ¯ä¸ªå…³ç³»ç»´æŠ¤çš„ç´¢å¼•é›†åˆ</p>
</li>
<li>
<p>å…³ç³»çš„å®‰å…¨æ€§ä¸æˆæƒä¿¡æ¯</p>
</li>
<li>
<p>å…³ç³»åœ¨ç£ç›˜ä¸Šçš„ç‰©ç†å­˜å‚¨ç»“æ„</p>
</li>
</ul>
<h4 id="sql_1">SQL çš„å†å²å‘å±•<a class="headerlink" href="#sql_1" title="Permanent link">&para;</a></h4>
<p>è¿™é‡Œåº”è¯¥ä¸è€ƒï¼Œæš‚æ—¶é¸½äº†(</p>
<h3 id="sql_2">SQL æ•°æ®ç±»å‹<a class="headerlink" href="#sql_2" title="Permanent link">&para;</a></h3>
<div class="card">
<div class="card-header">char(n)</div>
<div class="card-body">
<p><strong>å«ä¹‰</strong>ï¼šå®šé•¿ä¸º n çš„å­—ç¬¦ä¸²</p>
</div>
</div>
<div class="card">
<div class="card-header">varchar(n)</div>
<div class="card-body">
<p><strong>å«ä¹‰</strong>ï¼šé•¿åº¦å¯å˜çš„å­—ç¬¦ä¸²ï¼Œæœ€å¤§é•¿åº¦ä¸º n</p>
</div>
</div>
<div class="card">
<div class="card-header">varchar(n)</div>
<div class="card-body">
<p><strong>å«ä¹‰</strong>ï¼šé•¿åº¦å¯å˜çš„å­—ç¬¦ä¸²ï¼Œæœ€å¤§é•¿åº¦ä¸º n</p>
</div>
</div>
<div class="card">
<div class="card-header">int</div>
<div class="card-body">
<p><strong>å«ä¹‰</strong>ï¼šæ•´æ•°ã€‚å…¶æ•°æ®èŒƒå›´æ˜¯æ•°å­¦ä¸Šçš„â€œæ•´æ•°â€çš„ä¸€ä¸ª<u>ç”±åº“å’Œè®¡ç®—æœºæ¶æ„å†³å®šçš„</u>æœ‰é™å­é›†</p>
</div>
</div>
<div class="card">
<div class="card-header">smallint</div>
<div class="card-body">
<p><strong>å«ä¹‰</strong>ï¼šå°æ•´æ•°ã€‚å…¶æ•°æ®èŒƒå›´æ˜¯æ•°å­¦ä¸Šçš„â€œæ•´æ•°â€çš„ä¸€ä¸ª<u>ç”±åº“å’Œè®¡ç®—æœºæ¶æ„å†³å®šçš„</u>æœ‰é™å­é›†ï¼Œåªä¸è¿‡æ¯” int æ‰€åŒ…å«çš„èŒƒå›´å°ã€‚</p>
</div>
</div>
<div class="card">
<div class="card-header">numeric(p, d)</div>
<div class="card-body">
<p><strong>å«ä¹‰</strong>ï¼šåè¿›åˆ¶è¡¨ç¤ºï¼Œæ€»å…±æœ‰ p ä½ï¼Œå…¶ä¸­å°æ•°ç‚¹åæœ‰ d ä½ã€‚</p>
<blockquote>
<p>ä¾‹å¦‚å¯¹ numeric(3, 1)ï¼Œ 10.5ã€01.0 æ˜¯åˆæ³•çš„ï¼Œ 1.05ã€105ã€1 éƒ½æ˜¯ä¸åˆæ³•çš„ã€‚</p>
</blockquote>
</div>
</div>
<div class="card">
<div class="card-header">float(n)</div>
<div class="card-body">
<p><strong>å«ä¹‰</strong>ï¼š<u>è‡³å°‘</u>æœ‰ n ä¸ªæ•°å­—çš„æµ®ç‚¹æ•°ã€‚</p>
</div>
</div>
<div class="card">
<div class="card-header">real/double precision</div>
<div class="card-body">
<p><strong>å«ä¹‰</strong>ï¼šå•ç²¾åº¦æµ®ç‚¹æ•°å’ŒåŒç²¾åº¦æµ®ç‚¹æ•°ã€‚å’Œ C è¯­è¨€ç­‰çš„<code>float</code>/<code>double</code>å¤§è‡´å¯¹åº”ã€‚å…è®¸çš„æ•°æ®èŒƒå›´<u>ç”±åº“å’Œè®¡ç®—æœºæ¶æ„</u>å†³å®šã€‚</p>
</div>
</div>
<p>SQL è¿˜æœ‰ä¸€äº›å…³äºæ—¶é—´çš„é¢„è®¾ç±»å‹ï¼š</p>
<div class="card">
<div class="card-header">date</div>
<div class="card-body">
<p><strong>å«ä¹‰</strong>ï¼šæ—¥æœŸï¼Œèƒ½ä¸”ä»…èƒ½åŒ…å«(å››ä½æ•°å­—çš„)å¹´ä»½ã€æœˆä»½å’Œæ—¥æœŸã€‚</p>
<blockquote>
<p>ä¾‹å¦‚"2025-6-9"ã€"2025-06-09"</p>
</blockquote>
</div>
</div>
<div class="card">
<div class="card-header">time</div>
<div class="card-body">
<p><strong>å«ä¹‰</strong>ï¼šæ—¶é—´ï¼Œæœ€å¤§å•ä½æ˜¯å°æ—¶ï¼Œè‡³å°‘åŒ…å«å°æ—¶ã€åˆ†é’Ÿã€ç§’ã€‚</p>
<blockquote>
<p>"18:12:20" å’Œ "18:12:20.111" éƒ½æ˜¯å¯æ¥å—çš„è¾“å…¥ã€‚è™½ç„¶æ ‡å‡†æ ¼å¼è¦æ±‚å°æ—¶ã€åˆ†é’Ÿã€ç§’éƒ½åº”è¯¥æ˜¯ 2 ä½æ•°å­—ï¼Œä½†å¤§å¤šæ•°æ•°æ®åº“ç³»ç»Ÿåœ¨è¾“å…¥æ—¶å…è®¸çœç•¥å‰å¯¼ 0ã€‚</p>
</blockquote>
</div>
</div>
<div class="card">
<div class="card-header">timestamp</div>
<div class="card-body">
<p><strong>å«ä¹‰</strong>ï¼šä»ç»„æˆä¸Šçœ‹å°±æ˜¯ date+timeã€‚</p>
<blockquote>
<p>ä¾‹å¦‚"2005-7-27 09:00:30.75"ã€‚</p>
</blockquote>
</div>
</div>
<div class="card">
<div class="card-header">interval</div>
<div class="card-body">
<p><strong>å«ä¹‰</strong>ï¼šæè¿°ä¸€ä¸ªæ—¶é—´æ®µã€‚interval å€¼å¯ä»¥è¢«åŠ åœ¨ date/time/timestamp å€¼ä¸Šã€‚</p>
</div>
</div>
<p>SQL è¿˜æœ‰é’ˆå¯¹å¤§å‹æ•°æ®çš„è¡¨ç¤ºæ–¹å¼ã€‚</p>
<div class="card">
<div class="card-header">blob</div>
<div class="card-body">
<p><strong>å«ä¹‰</strong>ï¼šäºŒè¿›åˆ¶å¤§å¯¹è±¡ï¼Œæ˜¯ä¸€ä¸ªå¯ä»¥å­˜å‚¨äºŒè¿›åˆ¶æ–‡ä»¶çš„å®¹å™¨ã€‚å…¸å‹çš„ blob æ˜¯ä¸€å¼ å›¾ç‰‡æˆ–è€…å£°éŸ³æ–‡ä»¶ç­‰ã€‚å¯¹å…¶çš„è§£æä¼šäº¤ç»™å¤–éƒ¨ç¨‹åºå»è¿è¡Œï¼Œæ•°æ®åº“åªè´Ÿè´£å­˜å‚¨è¿™äº›å¤§å¯¹è±¡ã€‚</p>
</div>
</div>
<div class="card">
<div class="card-header">clob</div>
<div class="card-body">
<p><strong>å«ä¹‰</strong>ï¼šå­—ç¬¦å¤§å¯¹è±¡ï¼Œæ˜¯ä¸€ä¸ªå¯ä»¥å‚¨å­˜å¤§æ®µå­—ç¬¦æ•°æ®çš„å®¹å™¨ã€‚</p>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ä¸€ä¸ªæŸ¥è¯¢æ“ä½œéœ€è¦æŸ¥è¯¢ä¸€ä¸ªå¤§å¯¹è±¡æ—¶ï¼Œä¼šè¿”å›ç»™å®ƒä¸€ä¸ªæŒ‡å‘è¿™ä¸ªå¯¹è±¡çš„æŒ‡é’ˆè€Œéè¿™ä¸ªå¤§å¯¹è±¡æœ¬èº«ã€‚ä¼ æŒ‡é’ˆå¯å¿«å¤šäº†ï¼</p>
</div>
<p>SQL è¿˜å…è®¸ç”¨æˆ·è‡ªå®šä¹‰ç±»å‹(<code>create type</code>)ã€‚</p>
<h3 id="sql_3">SQL è¯­å¥è§„èŒƒ<a class="headerlink" href="#sql_3" title="Permanent link">&para;</a></h3>
<p>è¿™é‡Œå°±ä¸åˆ—å‡ºæ‰€æœ‰è¯­æ³•äº†ï¼Œä»…ä»…æ”¾ä¸€äº›ä¸ªäººè§‰å¾—å¯èƒ½ä¼šé”™çš„åœ°æ–¹ã€‚</p>
<p>SQL æ‰€æœ‰çš„å…³é”®å­—éƒ½æ˜¯<strong>å¤§å°å†™ä¸æ•æ„Ÿ</strong>çš„ã€‚</p>
<div class="card">
<div class="card-header">å»ºè¡¨</div>
<div class="card-body">
<p>ä¸€ä¸ªä¾‹å­ï¼š</p>
<div class="language-SQL highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">    </span><span class="n">ID</span><span class="w">             </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">    </span><span class="n">name</span><span class="w">           </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">    </span><span class="n">dept_name</span><span class="w">      </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">    </span><span class="n">tot_cred</span><span class="w">       </span><span class="nb">numeric</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">    </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="p">(</span><span class="n">ID</span><span class="p">),</span><span class="w">          </span><span class="c1">-- å£°æ˜ä¸ºprimary keyçš„å±æ€§ä¼šè‡ªåŠ¨ç¡®ä¿å…¶éç©º</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">    </span><span class="k">foreign</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="p">(</span><span class="n">dept_name</span><span class="p">)</span><span class="w"> </span><span class="k">references</span><span class="w"> </span><span class="n">department</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">                               </span><span class="c1">-- referenceså…³é”®å­—ååº”è¯¥è·Ÿä¸€ä¸ªå…³ç³»(table)å</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="p">);</span>
</span></code></pre></div>
<div class="admonition note">
<p class="admonition-title">å®Œæ•´æ€§çº¦æŸ(Integrity Constraint)</p>
<p>å®Œæ•´æ€§çº¦æŸå³å¯¹ attribute å†…å®¹çš„çº¦æŸï¼Œä¸æ»¡è¶³çº¦æŸæ¡ä»¶çš„ tuple ä¸èƒ½è¢«æ’å…¥ã€‚ä¸€èˆ¬æœ‰ 5 ç±»çº¦æŸæ–¹æ³•ï¼š</p>
<ul>
<li>
<p><code>not NULL</code>ï¼šé™å®šè¯¥å±æ€§å€¼é NULLã€‚</p>
</li>
<li>
<p><code>primary key</code>ï¼šå£°æ˜ä¸º primary key çš„å±æ€§ä¼šè‡ªåŠ¨ç¡®ä¿å…¶éç©º</p>
</li>
<li>
<p><code>foreign key</code>ï¼šæŸä¸ªè¡¨ä¸­è¢«å£°æ˜ä¸ºå¤–é”®çš„å±æ€§ä¸€å®šæ˜¯å¦å¤–æŸä¸ªè¡¨çš„ä¸»é”®ã€‚</p>
</li>
<li>
<p><code>check(&lt;predicate&gt;)</code>ï¼šè‡ªå®šä¹‰æ£€æŸ¥çš„æ¡ä»¶ï¼Œä¾‹å¦‚<code>CHECK (semester in ("spring", "autumn"))</code></p>
</li>
<li>
<p>è‡ªå®šä¹‰ domain ï¼šä¾‹å¦‚<code>create domain person_name char(20) not null</code>ã€‚æ­¤æ“ä½œåœ¨ SQL92 æ ‡å‡†è¢«å¼•å…¥ï¼Œå…è®¸ç”¨æˆ·è‡ªå®šä¹‰ä¸€ä¸ª domainã€‚å…¶æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å¯é‡ç”¨çš„çº¦æŸæ¨¡æ¿ã€‚å…¶åŸºæœ¬è¯­æ³•æ˜¯ï¼š</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">DOMAIN</span><span class="w"> </span><span class="n">domain_name</span><span class="w"> </span><span class="p">[</span><span class="k">AS</span><span class="p">]</span><span class="w"> </span><span class="err">æ•°æ®ç±»å‹</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">    </span><span class="p">[</span><span class="k">DEFAULT</span><span class="w"> </span><span class="err">é»˜è®¤å€¼</span><span class="p">]</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">    </span><span class="p">[</span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="err">çº¦æŸæ¡ä»¶</span><span class="p">)];</span>
</span></code></pre></div>
<p>ç„¶åä½ å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªå€¼åŸŸäº†ã€‚ä¾‹å¦‚ï¼š</p>
<p><div class="language-sql highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">DOMAIN</span><span class="w"> </span><span class="n">Email</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">VALUE</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%@%.%&#39;</span><span class="p">);</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">Users</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="w">    </span><span class="n">user_email</span><span class="w"> </span><span class="n">Email</span><span class="p">,</span><span class="w">  </span><span class="c1">-- ç›´æ¥å¤ç”¨åŸŸå®šä¹‰</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="w">    </span><span class="p">...</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="p">);</span>
</span></code></pre></div>
å®ƒæ˜¯åŸºäºç°æœ‰ç±»å‹çš„ä¸€ç§çº¦æŸæ‰©å±•ï¼Œè¿™ä¸€ç‚¹å’Œç›´æ¥è‡ªå®šä¹‰ç±»å‹(å¯ä»¥æ˜¯å®Œå…¨ç‹¬ç«‹çš„å…¨æ–°ç±»å‹)æœ‰æ‰€ä¸åŒã€‚</p>
</li>
</ul>
</div>
</div>
</div>
<div class="card">
<div class="card-header">æŸ¥è¯¢</div>
<div class="card-body">
<p>ä¸€ä¸ªå…¸å‹çš„æŸ¥è¯¢è¯­å¥å…·æœ‰å¦‚ä¸‹å½¢å¼ï¼š</p>
<div class="language-SQL highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">select</span><span class="w"> </span><span class="n">A1</span><span class="p">,</span><span class="w"> </span><span class="n">A2</span><span class="p">,</span><span class="w"> </span><span class="p">...,</span><span class="w"> </span><span class="n">An</span><span class="w">  </span><span class="c1">-- A_i ä»£è¡¨å±æ€§å</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="k">from</span><span class="w"> </span><span class="n">r1</span><span class="p">,</span><span class="w"> </span><span class="n">r2</span><span class="p">,</span><span class="w"> </span><span class="p">...,</span><span class="w"> </span><span class="n">rm</span><span class="w">    </span><span class="c1">-- r_i ä»£è¡¨å…³ç³»å</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="k">where</span><span class="w"> </span><span class="n">P</span><span class="w">                 </span><span class="c1">-- P ä»£è¡¨ç­›é€‰æ¡ä»¶</span>
</span></code></pre></div>
<p>select å¯ä»¥ç»†åˆ†ä¸º select all ä¸ select distinct ï¼ŒåŒºåˆ«æ˜¯æ˜¯å¦ä¸ºç»“æœå»é‡ï¼Œ select ä¸ä½¿ç”¨åç¼€æ—¶é»˜è®¤ä¸º select allã€‚select distinct ä¸å…³ç³»ä»£æ•°çš„ <span class="arithmatex">\(\Pi\)</span> ç­‰ä»·ï¼Œè€Œ select all åˆ™ä¸ç„¶ã€‚</p>
<p>äº‹å®ä¸Šï¼Œä¸Šè¿°è¯­å¥ç­‰ä»·äºå…³ç³»ä»£æ•°è¡¨è¾¾å¼ï¼š</p>
<div class="arithmatex">\[
\Pi_{A1, \ldots, An} \left( \sigma_P (r1 \times r2 \times \ldots \times rm) \right)
\]</div>
<p>è¿™é‡Œä½¿ç”¨ <span class="arithmatex">\(\Pi\)</span> ä¼šäº§ç”Ÿé‡å¤è¡Œçš„åŸå› æ˜¯ï¼Œå½“å…³ç³»ä¸­çš„ä¸¤ä¸ªå…ƒç»„å„å±æ€§å€¼å®Œå…¨ç›¸åŒæ—¶ï¼Œ<span class="arithmatex">\(\Pi\)</span> æ‰ä¼šå»é‡ï¼Œåƒè¿™æ ·å…ˆç¬›å¡å°”ç§¯åï¼Œè™½ç„¶é€‰å®šçš„å±æ€§å€¼æœ‰é‡å¤ï¼Œä½†æ˜¯æ¯ä¸ªå…ƒç»„éƒ½ä¸å®Œå…¨ä¸€æ ·ã€‚ </p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒæŸ¥è¯¢æ“ä½œè¿”å›ä¸€ä¸ªå…³ç³»(table)ã€‚</p>
<div class="admonition tip">
<p class="admonition-title">éå…¸å‹çš„ç”¨æ³•</p>
<p>select é€‰æ‹©çš„å†…å®¹ä¹Ÿå¯ä»¥æ˜¯è¡¨è¾¾å¼ï¼Œä¾‹å¦‚<code>select salary/1000 from teacher;</code>è¿”å›çš„æ˜¯ salary/1000 çš„ç»“æœã€‚</p>
<p>ä¹Ÿå› æ­¤ select å¯ä»¥æ²¡æœ‰ from å­å¥ï¼Œä¸€èˆ¬ç”¨äºå±•ç¤ºæ•°æ®æˆ–è€…èµ‹å€¼å¹¶å±•ç¤ºç»“æœï¼Œä¾‹å¦‚<code>select 12345/5;</code>å•çº¯æ‰“å°è¿™ä¸ªè¡¨è¾¾å¼çš„ç»“æœæ•°å­—ã€‚</p>
<p>select ç»“æœå¯ä»¥ä½¿ç”¨<code>order by ATTRIBUTE_NAME (desc/asc)</code>å­å¥æ’åºï¼Œ desc/asc è¡¨ç¤ºæŒ‰ç…§é™/å‡åºï¼Œä¸æ˜¾å¼æŒ‡å®šé»˜è®¤ä¸º ascã€‚order by åé¢å¯ä»¥è·Ÿå¤šä¸ª attribute ï¼Œä»¥é€—å·åˆ†éš”ï¼Œé å‰çš„ä¼˜å…ˆã€‚</p>
</div>
</div>
</div>
<div class="card">
<div class="card-header">åˆ«å</div>
<div class="card-body">
<p>as å¯ä»¥ä¸ºä¸€ä¸ªå¯¹è±¡èµ‹åˆ«åã€‚å½“ç„¶ï¼Œ as è¿˜å¯ä»¥ä¸ºåŒä¸€ä¸ªå¯¹è±¡èµ‹ä¸¤ä¸ªåˆ«åä»¥å®ç°è‡ªæˆ‘å¯¹æ¯”ã€‚ä½†æ˜¯ï¼Œ as åˆ«åçš„ä½œç”¨åŸŸä»…é™äºè¿™æ¡è¯­å¥ï¼Œå®é™…åç§°å¹¶ä¸ä¼šè¢«æ›´æ”¹ï¼Œä¸‹å›¾ä¸­çš„ select è¯­å¥å®Œæˆåè¡¨åä»ç„¶å« instructorã€‚as æœ‰æ—¶å¯ä»¥çœç•¥ä¸å†™ã€‚</p>
<div class="language-SQL highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="n">name</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="k">from</span><span class="w"> </span><span class="n">instructoras</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="n">instructor</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">S</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="k">where</span><span class="w"> </span><span class="n">T</span><span class="p">.</span><span class="n">salary</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">S</span><span class="p">.</span><span class="n">salary</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">S</span><span class="p">.</span><span class="n">dept_name</span><span class="w"> </span><span class="o">=</span><span class="s1">&#39;Comp.Sci.&#39;</span>
</span></code></pre></div>
<p><code>instructor as T</code> = <code>instructor T</code>ã€‚ä½†æ˜¯ï¼Œåœ¨ Oracle ä¸­ï¼Œ as å¿…é¡»è¢«çœç•¥ã€‚</p>
</div>
</div>
<div class="card">
<div class="card-header">(å­—ç¬¦ä¸²)æ¨¡ç³Šæœç´¢</div>
<div class="card-body">
<p>like æ˜¯æ¨¡ç³Šæœç´¢çš„å…³é”®å­—ã€‚SQL å­—ç¬¦ä¸²æŸ¥æ‰¾æœ€å¸¸ç”¨çš„ä¸¤ä¸ªè®°å·ä¸º<code>%</code>å’Œ<code>_</code>ã€‚<code>%</code>åŒ¹é…ä»»æ„å­—ç¬¦ä¸²ï¼Œ<code>_</code>åŒ¹é…ä»»æ„å•å­—ç¬¦ã€‚</p>
<p>éœ€è¦å­—ç¬¦ä¸²æŸ¥æ‰¾å†…å®¹æœ¬èº«åŒ…å«<code>%</code>æˆ–<code>_</code>æ—¶ä½¿ç”¨é€ƒé€¸å­—ç¬¦<code>\%</code>ã€<code>\_</code>ã€‚å­—ç¬¦ä¸²å†…å®¹åŒ¹é…é»˜è®¤åŒºåˆ†å¤§å°å†™ã€‚</p>
<p><img alt="like_usage" src="../images/DB/db20.png" /></p>
</div>
</div>
<div class="card">
<div class="card-header">union/intersect/except</div>
<div class="card-body">
<p>å®ƒä»¬ä¸‰è€…å„è‡ªéƒ½åˆæœ‰ all å’Œ distinct ä¸¤ä¸ªç‰ˆæœ¬ï¼ŒåŒºåˆ«æ˜¯ç»“æœæ˜¯å¦å»é‡ï¼Œä½†æ˜¯å®ƒä»¬<strong>é»˜è®¤å»é‡</strong>ï¼Œè¿™ä¸ select ä¸åŒã€‚</p>
<p><code>union</code>/<code>intersect</code>/<code>except</code>åˆ†åˆ«ç­‰ä»·äºäº¤é›†ã€å¹¶é›†ã€é›†åˆçš„å‡æ³•ã€‚</p>
</div>
</div>
<div class="card">
<div class="card-header">group by</div>
<div class="card-body">
<p>é…åˆå„ç±»ä»£æ•°æ“ä½œï¼ŒåŠŸèƒ½ç­‰ä»·äºå…³ç³»ä»£æ•°ä¸­ <span class="arithmatex">\(\mathcal{G}\)</span> å‰éƒ¨çš„ä¸‹æ ‡ã€‚</p>
<p>group by<strong>å…ˆäº select è¿›è¡Œ</strong>ï¼Œåˆ›å»ºä¸€ä¸ªä»…åŒ…å«ä»£æ•°æ“ä½œåˆ—ä¸ group by åˆ—çš„ä¸´æ—¶è¡¨ï¼Œ select æ“ä½œåœ¨è¿™ä¸ªä¸´æ—¶è¡¨ä¸­è¿›è¡Œã€‚</p>
<details class="danger">
<summary>ç”±æ­¤å¸¦æ¥çš„ç‰¹æ€§</summary>
<ul>
<li>select...group by...å¯ä»¥åœ¨å¤šä¸ªåˆ—åå’Œåˆ—æ•°ä¸å®Œå…¨ç›¸åŒçš„è¡¨ä¸­è¿›è¡Œï¼Œåªè¦å…±æœ‰ç”¨äºä»£æ•°æ“ä½œå’Œ group by çš„åˆ—å°±å¯ä»¥äº†ã€‚ä¾‹å¦‚ä¸‹é¢çš„è¡¨ r1ã€r2 ç­‰åªè¦å…±æœ‰ A1ã€A2(ç”¨äº group by)å’Œ A3(ç”¨äº sum)å³å¯ï¼Œå…¶ä½™åˆ—æ— æ‰€è°“ã€‚</li>
</ul>
<div class="language-SQL highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">select</span><span class="w"> </span><span class="n">A1</span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">A3</span><span class="p">)</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="k">from</span><span class="w"> </span><span class="n">r1</span><span class="p">,</span><span class="w"> </span><span class="n">r2</span><span class="p">,</span><span class="w"> </span><span class="n">r3</span><span class="w"> </span><span class="p">.</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="k">where</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">A1</span><span class="p">,</span><span class="w"> </span><span class="n">A2</span>
</span></code></pre></div>
<ul>
<li>åŒæ—¶ select ä»£æ•°æ“ä½œå’Œå…¶ä»–çš„åˆ—æ—¶ï¼Œå…¶ä»–åˆ—å¿…é¡»åŒæ—¶æ”¾åœ¨ group by é‡Œé¢ï¼Œå› ä¸ºä¸èƒ½é€‰æ‹©ä¸´æ—¶è¡¨ä¸­æ²¡æœ‰çš„åˆ—ã€‚</li>
</ul>
</details>
</div>
</div>
<div class="card">
<div class="card-header">where/having</div>
<div class="card-body">
<ul>
<li>
<p>where åœ¨ group by ä¹‹å‰è¿›è¡Œï¼Œä¸æ»¡è¶³æ¡ä»¶çš„ tuble ä¸ä¼šå‚ä¸ group by è¿›å…¥ä¸´æ—¶è¡¨ã€‚</p>
</li>
<li>
<p>having åœ¨ group by ä¹‹åè¿›è¡Œï¼Œåœ¨äº§ç”Ÿçš„ä¸´æ—¶è¡¨ä¸­ç­›é€‰ï¼Œåªè¿”å›æ»¡è¶³çš„ tubleã€‚</p>
</li>
</ul>
<p>å› æ­¤å¼•ç”³å‡º exists åªèƒ½è·Ÿ where ï¼›ä»£æ•°æ“ä½œåšæ¡ä»¶åªèƒ½è·Ÿ having ï¼›åŒæ ·çš„è¯­å¥åœ¨ where å’Œ having ä¹‹åæ•ˆæœä¸ä¸€å®šç›¸åŒã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªæ­£ç¡®ç”¨æ³•ç¤ºä¾‹ï¼š</p>
<p><img alt="where_having_usage" src="../images/DB/db21.png" /></p>
</div>
</div>
<div class="card">
<div class="card-header">å…³äº NULL</div>
<div class="card-body">
<p>NULL å€¼ä¸å‚ä¸å¯¹åˆ—çš„ä»£æ•°å‡½æ•°è¿ç®—ï¼Œå…¨ NULL çš„ tuple ä¸ä¼šè¢« count()è®¡æ•°ã€‚æ²¡æœ‰é NULL å…ƒç´ æ—¶ï¼Œä»£æ•°æ“ä½œè¿”å› NULL ï¼Œ count()è¿”å› 0ã€‚</p>
</div>
</div>
<div class="card">
<div class="card-header">some/all</div>
<div class="card-body">
<p>some/all è·Ÿåœ¨å…³ç³»ç¬¦å·( <span class="arithmatex">\(&lt;\)</span>/<span class="arithmatex">\(&gt;\)</span>/<span class="arithmatex">\(\leq\)</span>/<span class="arithmatex">\(\geq\)</span>/<span class="arithmatex">\(=\)</span>/<span class="arithmatex">\(\neq\)</span> )åï¼Œ some ç›¸å½“äºäºå­˜åœ¨ï¼Œ all ç›¸å½“äºä»»æ„ã€‚å½“å…¶åçš„è¡¨ä¸­å…ƒç´ æ»¡è¶³å‰é¢çš„å…³ç³»åˆ™è¿”å› trueã€‚</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="mi">5</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="k">some</span><span class="err">{</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="err">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="mi">5</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="k">some</span><span class="err">{</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="err">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">false</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="mi">5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">some</span><span class="err">{</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="err">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="mi">5</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">some</span><span class="err">{</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="err">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="c1">-- (=some) = in ä½†æ˜¯ ( != some) != not in</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="mi">5</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="k">all</span><span class="err">{</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="err">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">false</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="mi">5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">all</span><span class="err">{</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="err">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">false</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="mi">5</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="k">all</span><span class="err">{</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="err">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="mi">5</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">all</span><span class="err">{</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="err">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="c1">-- ( != all) = not in ä½†æ˜¯ (=all) != in</span>
</span></code></pre></div>
</div>
</div>
<div class="card">
<div class="card-header">join(è¿æ¥)</div>
<div class="card-body">
<p>Join è¯­å¥çš„åŸºæœ¬åŠŸèƒ½æ˜¯å°†ä¸¤å¼ è¡¨ä¸­çš„ tuple æŒ‰ä¸€å®šè§„åˆ™è¿›è¡ŒåŒ¹é…ï¼Œå°†ä»–ä»¬ç›¸åŒçš„åˆ—ä¿ç•™å…¶ä¸€ï¼Œä¸åŒçš„åˆ—å…¨éƒ¨ä¿ç•™ï¼Œåˆæˆä¸€ä¸ªå¤§ tupleã€‚</p>
<ul>
<li>
<p><strong>Join Conditions ï¼šæ§åˆ¶å“ªä¸€äº›åˆ—æˆ–æ¡ä»¶ç”¨äºåŒ¹é…ä¸¤å¼ è¡¨ä¸­çš„ tuple</strong></p>
<ul>
<li>
<p>natural ï¼š tuple æ‰€æœ‰åŒååˆ—çš„å€¼ç›¸ç­‰(é»˜è®¤)</p>
</li>
<li>
<p>using (A1, A2...)ï¼š tuple åŒååˆ—ä¸­æŒ‡å®šçš„éƒ¨åˆ†åˆ—çš„å€¼ç›¸ç­‰</p>
</li>
<li>
<p>on <predicate>ï¼šæŒ‰ç…§ç‰¹å®šçš„è§„åˆ™åŒ¹é…ï¼Œä¸é™äºåŒååˆ—</p>
</li>
</ul>
</li>
<li>
<p><strong>Join Types ï¼šæ§åˆ¶å¦‚ä½•å¤„ç†æ²¡æœ‰åŒ¹é…å¯¹è±¡çš„ tuple</strong></p>
<ul>
<li>
<p>Inner Join ï¼šæ²¡æœ‰åŒ¹é…å¯¹è±¡åˆ™ä¸è¿”å›(é»˜è®¤)</p>
</li>
<li>
<p>Left Outer Join ï¼šå·¦ä¾§è¡¨çš„ tuple æ²¡æœ‰åŒ¹é…å¯¹è±¡ï¼Œåˆ™ä¸ºæ‰©å±•çš„åˆ—å¡«å…¥ NULL ï¼Œä¸€èµ·è¿”å›</p>
</li>
<li>
<p>Right Outer Join ï¼šå³ä¾§è¡¨çš„ tuple æ²¡æœ‰åŒ¹é…å¯¹è±¡ï¼Œåˆ™ä¸ºæ‰©å±•çš„åˆ—å¡«å…¥ NULL ï¼Œä¸€èµ·è¿”å›</p>
</li>
<li>
<p>Full Outer Join ï¼šä¸Šé¢äºŒè€…çš„å¹¶é›†</p>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="card">
<div class="card-header">with/view</div>
<div class="card-body">
<p>å»ºç«‹ä¸€ä¸ªä½œç”¨åŸŸä¸ºä¸€æ¡è¯­å¥çš„ä¸´æ—¶çš„è¡¨ç”¨äºç®€åŒ–é€»è¾‘è¡¨è¾¾å¼å¢åŠ å¯è¯»æ€§ã€‚ç›¸å½“äºå…³ç³»ä»£æ•°ä¸­çš„èµ‹å€¼æ“ä½œã€‚</p>
<div class="language-SQL highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="k">with</span><span class="w"> </span><span class="n">temp_table_name</span><span class="p">(</span><span class="n">attribute_name1</span><span class="p">,</span><span class="w"> </span><span class="n">attibute_name2</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="k">alias</span>
</span></code></pre></div>
<p>view ä¸€èˆ¬ç”¨äºæŸ¥æ‰¾ä»¥åŠæ¥å£ï¼Œè¯­æ³•å’Œ with ç›¸åŒï¼Œä½œç”¨ä¹ŸåŸºæœ¬ç›¸åŒã€‚å”¯ä¸€çš„åŒºåˆ«æ˜¯ view ä¸€ç»å®šä¹‰åˆ™ä¸€ç›´å¯ç”¨ï¼Œè€Œ with çš„ä½œç”¨åŸŸä»…æœ‰å•æ¡è¯­å¥ã€‚</p>
<details class="note">
<summary>viewçš„ç‰¹æ€§</summary>
<ul>
<li>
<p>view å¹¶ä¸æ˜¯å®é™…å­˜åœ¨çš„è¡¨ï¼Œæ¯æ¬¡è°ƒç”¨ view æ—¶åªæ˜¯é‡å¤è°ƒç”¨äº†ç­›é€‰çš„æ¡ä»¶ã€‚å› æ­¤ update table åï¼Œä¸ä¹‹å…³è”çš„ view ä¹Ÿä¼šæ”¹å˜ã€‚</p>
</li>
<li>
<p>æˆ‘ä»¬ä¸€èˆ¬ä¸å¯¹ view è¿›è¡Œ updateã€‚å¤§éƒ¨åˆ† SQL ç³»ç»Ÿå¯¹ update view æœ‰ä¸¥æ ¼çš„é™åˆ¶ã€‚</p>
<p><img alt="sql_restrictions_on_view" src="../images/DB/db22.png" /></p>
</li>
<li>
<p>éƒ¨åˆ† SQL ä¹Ÿæ”¯æŒ materialize view ï¼Œ view æ­¤æ—¶æ˜¯ä¸€å¼ çœŸå®å­˜åœ¨çš„è¡¨ï¼Œè¿™ä¸€èˆ¬æ˜¯ä¸ºäº†ç”¨ç©ºé—´æ¢æ—¶é—´ã€‚ç‰©åŒ–è§†å›¾ç›¸å…³çš„è¡¨å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå®ƒè‡ªå·±ä¹Ÿå¿…é¡»åŒæ—¶æ›´æ–°ï¼Œä»¥ç»´æŒä¸€èˆ¬ view çš„ç‰¹æ€§ã€‚</p>
</li>
</ul>
</details>
</div>
</div>
<div class="card">
<div class="card-header">index</div>
<div class="card-body">
<p><div class="language-sql highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">index_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">table_name</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">column1</span><span class="p">,</span><span class="w"> </span><span class="n">column2</span><span class="p">.....);</span><span class="w"> </span><span class="c1">-- åˆ›å»º</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">table_name</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">index_name</span><span class="p">;</span><span class="w"> </span><span class="c1">-- åˆ é™¤</span>
</span></code></pre></div>
ç´¢å¼•çš„åŸç†ç±»ä¼¼äºä¹¦çš„ç›®å½•ï¼Œè¦æŸ¥æ‰¾æŸä¸ªè¯ä¸éœ€è¦ä»å¤´å¼€å§‹é˜…è¯»ä¹¦ç±ï¼Œå¯ä»¥ä»ç›®å½•æŸ¥åˆ°é¡µç ç›´æ¥è·³è½¬ï¼Œäºæ˜¯åŠ å¿«äº†æŸ¥æ‰¾çš„é€Ÿåº¦ã€‚å…·ä½“å®ç°è¯·è§<a href="#indexing">#ç´¢å¼•(indexing)</a>ä¸€èŠ‚ã€‚ä¸€ä¸ªè¡¨å¯ä»¥åˆ›å»ºå¤šä¸ªç´¢å¼•ï¼Œä¸€
ä¸ªç´¢å¼•å¯ä»¥åŒ…å«å¤šä¸ªåˆ—ã€‚</p>
<p>ä½†ç´¢å¼•å¹¶ä¸æ˜¯å°½å–„å°½ç¾ï¼Œä¾‹å¦‚ update ä¹‹åï¼Œç´¢å¼•éœ€è¦åŒæ­¥ç»´æŠ¤ï¼›åŒæ—¶ç´¢å¼•æ˜¯ä¸€ç§ç‰©ç†ç»“æ„ï¼Œæœ‰é¢å¤–çš„ç©ºé—´ä¸ IO å¼€é”€ã€‚ä¸é€‚å½“çš„ç´¢å¼•è®¾ç½®åè€Œä¼šé™ä½æ•ˆç‡ã€‚</p>
</div>
</div>
<div class="card">
<div class="card-header">æƒé™æˆäºˆä¸æ”¶å›</div>
<div class="card-body">
<p>æˆäºˆ/æ”¶å›æƒé™çš„åŸºæœ¬è¯­æ³•æ˜¯ï¼š</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="k">grant</span><span class="w"> </span><span class="o">&lt;</span><span class="n">priviledge</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">role</span><span class="w"> </span><span class="n">name</span><span class="o">&gt;</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="k">on</span><span class="w"> </span><span class="o">&lt;</span><span class="n">relation_name</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">view_name</span><span class="o">&gt;</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="o">&lt;</span><span class="k">user</span><span class="w"> </span><span class="n">list</span><span class="o">&gt;</span><span class="p">;</span><span class="w"> </span><span class="c1">-- æˆäºˆ</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="k">revoke</span><span class="w"> </span><span class="o">&lt;</span><span class="n">priviledge</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">role</span><span class="w"> </span><span class="n">name</span><span class="o">&gt;</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="k">on</span><span class="w"> </span><span class="o">&lt;</span><span class="n">relation_name</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">view_name</span><span class="o">&gt;</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="o">&lt;</span><span class="k">user</span><span class="w"> </span><span class="n">list</span><span class="o">&gt;</span><span class="p">;</span><span class="w"> </span><span class="c1">-- æ”¶å›</span>
</span></code></pre></div>
<p>éœ€è¦æ³¨æ„ï¼š</p>
<ul>
<li>
<p>æƒé™å¯ä»¥æ¥è‡ªå¤šä¸ªä¸Šçº§ç”¨æˆ·ï¼Œç›¸äº’å¯ä»¥é‡å ï¼Œä¾‹å¦‚æœ‰ä¸¤è€…éƒ½ä¸ºç¬¬ä¸‰æ–¹æˆäºˆäº†è¯»å–æƒé™ï¼Œæ­¤æ—¶å³ä½¿æœ‰ä¸€æ–¹æ’¤å›äº†æƒé™ï¼Œç¬¬ä¸‰æ–¹ä»ç„¶å¯ä»¥æ­£å¸¸è¯»å–ã€‚</p>
</li>
<li>
<p>æƒé™å¯ä»¥çº§è”ä¸‹æ”¾ï¼Œä¾‹å¦‚ A ä¸º B æˆäºˆäº†æŸäº›æƒé™ï¼Œ B å¯ä»¥ç»§ç»­å‘å…¶ä»–äººæˆäºˆä¸é«˜äºä»–è‡ªå·±çš„æƒé™ã€‚å½“ A æ’¤å›å¯¹ B çš„æƒé™æ—¶ï¼Œ B ä¸‹æ”¾ç»™ä»–äººçš„æƒé™ä¹Ÿä¼šåŒæ—¶è¢«æ”¶å›ã€‚</p>
</li>
<li>
<p>æƒé™çš„åŸºæœ¬å•ä½æ˜¯ relation ï¼Œéœ€è¦æˆäºˆæŸä¸ªæ•°æ®åº“å†…æ‰€æœ‰ relation çš„æƒé™æ—¶å¯ä»¥ä½¿ç”¨<code>DB_name.*</code>ã€‚</p>
</li>
</ul>
<p>æœ‰å¤šä¸ªåŒç±»ç”¨æˆ·éœ€è¦åšç»Ÿä¸€çš„æƒé™è°ƒæ•´æ—¶ï¼Œåˆ—å‡º<user list>çš„ä½¿ç”¨æ–¹å¼æ˜¾ç„¶ä¸ä¾¿ï¼Œæ­¤æ—¶å°±éœ€è¦ roleã€‚role æ˜¯æƒé™ç»„æˆçš„é›†åˆï¼Œä½ å¯ä»¥åƒèµ‹äºˆå•ä¸ªæƒé™ä¸€æ ·å°† role èµ‹äºˆç”¨æˆ·ã€‚ä¿®æ”¹æŸä¸ª role å¯¹åº”çš„æƒé™é›†åˆæ—¶ï¼Œæ‰€æœ‰è¢«èµ‹äºˆè¿™ä¸ª role èº«ä»½çš„ç”¨æˆ·æƒé™éƒ½ä¼šåŒæ—¶è¢«ä¿®æ”¹ã€‚</p>
</div>
</div>
<h3 id="sql_4">é«˜çº§ SQL<a class="headerlink" href="#sql_4" title="Permanent link">&para;</a></h3>
<h4 id="sql_5">åœ¨é«˜çº§ç¼–ç¨‹è¯­è¨€ä¸­ä½¿ç”¨ SQL<a class="headerlink" href="#sql_5" title="Permanent link">&para;</a></h4>
<p><strong>åµŒå…¥å¼ SQL(Embedded SQL)</strong></p>
<p>SQL æ ‡å‡†å®šä¹‰äº†å¦‚ä½•å°† SQL åµŒå…¥åˆ°å¤šç§ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œä¾‹å¦‚ Cã€Java å’Œ Cobolã€‚</p>
<p>ä¸€ç§ç”¨æ¥åµŒå…¥ SQL æŸ¥è¯¢çš„è¯­è¨€è¢«ç§°ä¸º<strong>å®¿ä¸»è¯­è¨€ (host language)</strong>ï¼Œè€Œå®¿ä¸»è¯­è¨€ä¸­å…è®¸çš„ SQL ç»“æ„åˆ™æ„æˆäº†<strong>åµŒå…¥å¼ SQL (embedded SQL)</strong>ã€‚</p>
<p>è¿™äº›è¯­è¨€çš„åŸºæœ¬å½¢å¼éµå¾ªäº† System R å°† SQL åµŒå…¥åˆ° PL/I çš„æ¨¡å¼:</p>
<div class="card">
<div class="card-body">
<p>åµŒå…¥å¼ SQL éœ€è¦è§£å†³çš„é—®é¢˜æœ‰ï¼š</p>
<ul>
<li>åœ¨å®¿ä¸»è¯­è¨€å’Œ SQL è¯­å¥ä¹‹é—´äº¤æ¢å‚æ•°å’Œç»“æœã€‚</li>
<li>å¤„ç†é›†åˆ(sets)ä¸å˜é‡(variables)ä¹‹é—´çš„å·®å¼‚ã€‚</li>
<li>è·å– SQL è¯­å¥çš„æ‰§è¡ŒçŠ¶æ€ã€‚</li>
<li>å°†ä»£ç ç¼–è¯‘æˆå®¿ä¸»è¯­è¨€ã€‚</li>
</ul>
<p><strong>(1) é¢„å¤„ç†å™¨æœºåˆ¶</strong></p>
<ul>
<li>
<p>è¾“å…¥ï¼šæ··åˆäº†å®¿ä¸»è¯­è¨€ä»£ç å’Œç‰¹æ®Šæ ‡è®°çš„ SQL è¯­å¥(é€šè¿‡<code>EXEC SQL</code>ç•Œå®š)ã€‚</p>
</li>
<li>
<p>è¾“å‡ºï¼š</p>
<ul>
<li>
<p>çº¯å®¿ä¸»è¯­è¨€ä»£ç (æ›¿æ¢ SQL ä¸º PL/I çš„æ•°æ®åº“è°ƒç”¨ï¼Œå¦‚ SQLFetch)ã€‚</p>
</li>
<li>
<p>è‡ªåŠ¨ç”Ÿæˆçš„é€šä¿¡åŒº(å¦‚ SQLCA)ç”¨äºä¼ é€’æ‰§è¡ŒçŠ¶æ€(å¦‚é”™è¯¯ç )ã€‚</p>
</li>
</ul>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">å…·ä½“å½¢å¼å› è¯­è¨€è€Œå¼‚(ä¾‹å¦‚ï¼Œ Java çš„åµŒå…¥å¼ SQL ä½¿ç”¨ <code>#SQL { ... };</code>)ã€‚</p>
</div>
<p><strong>(2) å®¿ä¸»å˜é‡(Host Variables)</strong></p>
<ul>
<li>
<p>ä½œç”¨ï¼šåœ¨ PL/I å’Œ SQL é—´ä¼ é€’æ•°æ®ã€‚</p>
</li>
<li>
<p>è¯­æ³•ï¼šå®¿ä¸»è¯­è¨€å˜é‡å‰åŠ å†’å·(å¦‚ <code>:credit_amount</code>)ï¼Œé¢„å¤„ç†å™¨è‡ªåŠ¨ç”Ÿæˆç±»å‹è½¬æ¢ä»£ç ã€‚</p>
</li>
<li>
<p>é™åˆ¶ï¼šéœ€æ˜¾å¼å£°æ˜ç±»å‹åŒ¹é…(å¦‚ PL/I çš„ FIXED BINARY(31) å¯¹åº” SQL çš„ INTEGER)ã€‚</p>
</li>
</ul>
<p><strong>(3) æ¸¸æ ‡(cursor)</strong></p>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œ SQL çš„æŸ¥è¯¢æ“ä½œè¿”å›ä¸€ä¸ªå…ƒç»„é›†åˆï¼Œå³å¤šè¡Œæ•°æ®ï¼Œä½†æ˜¯å®¿ä¸»è¯­è¨€å¾€å¾€åªèƒ½ä¸€è¡Œä¸€è¡Œåœ°å¤„ç†æ•°æ®ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªä¸œè¥¿æ¥æš‚å­˜è¿”å›çš„ç»“æœã€‚æˆ‘ä»¬åœ¨åµŒå…¥å¼ SQL é‡Œå°±å¯ä»¥å£°æ˜ä¸€ä¸ª<strong>æ¸¸æ ‡</strong>ï¼š</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="k">EXEC</span><span class="w"> </span><span class="k">SQL</span><span class="w"> </span><span class="k">DECLARE</span><span class="w"> </span><span class="n">cur</span><span class="w"> </span><span class="k">CURSOR</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">employee</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">dept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">:</span><span class="n">dept_var</span><span class="p">;</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="n">END_EXEC</span><span class="p">;</span>
</span></code></pre></div>
<p>è¿™æ ·ï¼Œåœ¨æ•°æ®åº“ç«¯åˆ›å»ºä¸€ä¸ªä¸´æ—¶å·¥ä½œåŒºï¼Œå­˜å‚¨æŸ¥è¯¢ç»“æœ(é¿å…ä¸€æ¬¡æ€§ä¼ è¾“å¤§é‡æ•°æ®åˆ°å®¢æˆ·ç«¯)ã€‚åŒæ—¶ï¼Œé€šè¿‡æ¸¸æ ‡ä½ç½®ï¼Œå®¿ä¸»è¯­è¨€ä¹Ÿå¯ä»¥é€è¡Œè®¿é—®ç»“æœã€‚</p>
<p><strong>æ“ä½œæµç¨‹</strong>ï¼š</p>
<ul>
<li>
<p><code>OPEN cur</code>ï¼šæ‰§è¡ŒæŸ¥è¯¢ï¼Œåˆ›å»ºä¸´æ—¶ç»“æœé›†ï¼›</p>
</li>
<li>
<p><code>FETCH cur INTO :id, :name</code>ï¼šè·å–å•è¡Œæ•°æ®åˆ°å®¿ä¸»å˜é‡ã€‚å¦‚æœéœ€è¦è¿ç»­è·å–éœ€è¦è€ƒè™‘å¾ªç¯ï¼›</p>
</li>
<li>
<p><code>CLOSE cur</code>ï¼šå…³é—­æŸ¥è¯¢ï¼Œé‡Šæ”¾èµ„æºã€‚</p>
</li>
</ul>
<p><strong>é”™è¯¯æ£€æŸ¥</strong>ï¼š</p>
<p>SQLCA(SQL Communication Area)ï¼š</p>
<ul>
<li>
<p>åŒ…å« SQLSTATE(å¦‚ '02000' è¡¨ç¤ºæ— æ›´å¤šæ•°æ®)ã€‚</p>
</li>
<li>
<p>å®¿ä¸»è¯­è¨€é€šè¿‡æ£€æŸ¥ SQLCA åˆ¤æ–­ SQL æ‰§è¡ŒçŠ¶æ€ã€‚</p>
</li>
</ul>
</div>
</div>
<p><strong>ç¤ºä¾‹</strong>ï¼šå­¦ç”Ÿå­¦åˆ†æŸ¥è¯¢(é€šè¿‡æ¸¸æ ‡é€è¡Œå¤„ç†ç»“æœ)ã€‚</p>
<div class="language-C highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">getStudentInfo</span><span class="p">()</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="p">{</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">credit_amount</span><span class="p">;</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">sId</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">sName</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">    </span><span class="n">EXEC</span><span class="w"> </span><span class="n">SQL</span><span class="w"> </span><span class="n">declare</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="n">cursor</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">student</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">tot_cred</span><span class="o">&gt;</span><span class="w"> </span><span class="o">:</span><span class="n">credit_amount</span><span class="w"> </span><span class="n">END</span><span class="w"> </span><span class="n">EXEC</span><span class="p">;</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Please input the credit amount: &quot;</span><span class="p">);</span><span class="w"> </span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="w">    </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">credit_amount</span><span class="p">);</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="w">    </span><span class="n">EXEC</span><span class="w"> </span><span class="n">SQL</span><span class="w"> </span><span class="n">open</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="n">END_EXEC</span><span class="p">;</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="w">        </span><span class="n">EXEC</span><span class="w"> </span><span class="n">SQL</span><span class="w"> </span><span class="n">fetch</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="o">:</span><span class="n">sId</span><span class="p">,</span><span class="w"> </span><span class="o">:</span><span class="n">sName</span><span class="w"> </span><span class="n">END_EXEC</span><span class="p">;</span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">SQLSTATE</span><span class="p">,</span><span class="s">&quot;02000&quot;</span><span class="p">))</span><span class="w"> </span><span class="c1">// 02000çŠ¶æ€ç è¡¨ç¤ºè¡¨ä¸­å·²ç»æ²¡æœ‰æ•°æ®</span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="w">            </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%s %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">sId</span><span class="p">,</span><span class="n">sName</span><span class="p">);</span>
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="w">    </span><span class="n">EXEC</span><span class="w"> </span><span class="n">SQL</span><span class="w"> </span><span class="n">close</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="n">END_EXEC</span><span class="p">;</span>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>ODBC ä¸ JDBC</strong></p>
<p>å®ƒä»¬éƒ½æ˜¯å®ç°ç¨‹åºä¸æ•°æ®åº“äº¤äº’çš„ API(application-program interface)ã€‚</p>
<p><strong>ODBC</strong>æ˜¯ C/C#/C++/VB çš„é€šç”¨ API ï¼Œé€šè¿‡é©±åŠ¨ç®¡ç†å™¨è¿æ¥æ•°æ®åº“(é…ç½® DSN)ã€‚</p>
<p>æ ¸å¿ƒå‡½æ•°ï¼š<code>SQLConnect()</code>, <code>SQLExecDirect()</code>, <code>SQLFetch()</code>ã€‚</p>
<p>å®‰å…¨é£é™©ï¼š SQL æ³¨å…¥(éœ€ç”¨é¢„ç¼–è¯‘è¯­å¥ SQLPrepare)ã€‚</p>
<h4 id="_3">è¿‡ç¨‹åŒ–æ‰©å±•<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<h4 id="trigger">è§¦å‘å™¨(Trigger)<a class="headerlink" href="#trigger" title="Permanent link">&para;</a></h4>
<h4 id="olap">é«˜çº§èšåˆä¸ OLAP<a class="headerlink" href="#olap" title="Permanent link">&para;</a></h4>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>å¥½åƒä¸è€ƒï¼Œæˆ‘å°±ä¸å†™äº†(</p>
</div>
<h2 id="_4">æ•°æ®åº“è®¾è®¡èŒƒå¼<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<h3 id="e-r">E-R æ¨¡å‹<a class="headerlink" href="#e-r" title="Permanent link">&para;</a></h3>
<h4 id="_5">æ¨¡å‹æ¦‚å¿µ<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>å®ä½“(entity)ï¼šåœ¨ç°å®ä¸–ç•Œä¸­èƒ½å¤Ÿä¸å…¶ä»–å¯¹è±¡åŒºåˆ†å¼€æ¥çš„ä¸€ä¸ªå¯¹è±¡ï¼</p>
<p>ä¸€ä¸ªå®ä½“ä¼šæœ‰ä¸€ç»„å±æ€§(attribute)ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æŸäº›å±æ€§çš„å€¼æ¥è¯†åˆ«å”¯ä¸€çš„å®ä½“ï¼</p>
<p>å®ä½“å¯ä»¥æ˜¯å…·ä½“çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯æŠ½è±¡çš„ï¼</p>
</li>
<li>
<p>å®ä½“é›†(entity set)ï¼šç›¸åŒç±»å‹ï¼ˆå…±äº«ç›¸åŒçš„å±æ€§ï¼‰çš„ä¸€ç»„å®ä½“æ„æˆäº†ä¸€ä¸ªå®ä½“é›†ï¼</p>
<p>ER å›¾ä¸­å®ä½“é›†çš„è¡¨ç¤ºï¼šç”¨çŸ©å½¢è¡¨ç¤ºå®ä½“é›†ï¼çŸ©å½¢è¢«åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œä¸ŠåŠéƒ¨åˆ†æ˜¯å®ä½“é›†çš„åå­—ï¼Œä¸‹åŠéƒ¨åˆ†åŒ…å«äº†æ‰€æœ‰å±æ€§çš„åç§°ï¼Œå…¶ä¸­ä½œä¸ºä¸»é”®çš„å±æ€§ç”¨ä¸‹åˆ’çº¿è¡¨ç¤ºï¼</p>
<p><div align="center">  <br />
<img src="../images/DB/db41.png" alt="perform_1" style="zoom: 90%"/>
</div></p>
</li>
</ul>
<p><strong>è”ç³»(relationship)</strong>æ˜¯å¤šä¸ªï¼ˆä¸¤ä¸ªåŠä»¥ä¸Šï¼‰å®ä½“çš„å…³è”ï¼</p>
<p><strong>è”ç³»é›†(relationship set)</strong>ï¼šä¸€ç»„ç›¸åŒç±»å‹çš„å…³ç³»ï¼</p>
<ul>
<li>
<p>å¤§å¤šæ•°å…³ç³»é›†éƒ½æ˜¯äºŒå…ƒçš„ï¼Œä½†æœ‰æ—¶ä¹Ÿå­˜åœ¨ä¸‰å…ƒç”šè‡³åŒ…å«æ›´å¤šå®ä½“é›†çš„å…³ç³»ï¼æˆ‘ä»¬ç§°å‚ä¸åˆ°æŸä¸ªå…³ç³»é›†çš„å®ä½“é›†ä¸ªæ•°ä¸ºè¯¥å…³ç³»é›†çš„<strong>åº¦(degree)</strong>ï¼</p>
</li>
<li>
<p>è”ç³»é›†çš„å½¢å¼åŒ–å®šä¹‰ï¼šè®¾ <span class="arithmatex">\(n\)</span> ä¸ªå¯é‡å¤çš„å®ä½“é›†åˆ†åˆ«ä¸º <span class="arithmatex">\(E_1, E_2, ..., E_n\)</span>ï¼Œåœ¨ä»–ä»¬ä¹‹ä¸Šå®šä¹‰çš„è”ç³»é›†æ˜¯ä¸€ä¸ªå…³ç³»(relation)ï¼Œä¸”åº”è¯¥æ˜¯ <span class="arithmatex">\(\{ (e_1, e_2, ..., e_n) \mid e_1 \in E_1, e_2 \in E_2, ..., e_n \in E_n \}\)</span> çš„å­é›†ã€‚<span class="arithmatex">\((e_1, e_2, ..., e_n)\)</span> ç§°ä¸ºè”ç³»çš„ä¸€ä¸ªå®ä¾‹ã€‚</p>
</li>
<li>
<p>ä¸€ç»„ç‰¹æ€§çš„å®ä½“é›†ä¹‹é—´å¯èƒ½ä¼šåŒ…å«å¤šä¸ªè”ç³»é›†ã€‚</p>
</li>
</ul>
<p>ER å›¾ä¸­å…³ç³»é›†çš„è¡¨ç¤ºï¼šç”¨è±å½¢(diamond)è¡¨ç¤ºå…³ç³»é›†ï¼Œå¹¶ä»è¿™ä¸ªè±å½¢å‡ºå‘ï¼Œé€šè¿‡ ç›´çº¿(line) è¿æ¥åˆ°å‚ä¸è¯¥å…³ç³»é›†çš„å®ä½“é›†ï¼</p>
<div align="center">    
<img src="../images/DB/db42.png" alt="perform_2" style="zoom: 80%"/>
</div>

<div align="center">    
<img src="../images/DB/db29.png" alt="ER_1" style="zoom: 90%"/>
</div>

<div align="center">    
<img src="../images/DB/db30.png" alt="ER_2" style="zoom: 90%"/>
</div>

<h2 id="_6">å­˜å‚¨<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h2>
<h3 id="_7">å­˜å‚¨å±‚çº§<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<p><img alt="storage" src="../images/DB/db2.png" /></p>
<p>ä¸Šå›¾ä¸­çš„æ˜¯å¦æ˜“å¤±æ˜¯æ ¹æ®æ‰ç”µåæ•°æ®ä¼šä¸ä¼šä¸¢å¤±åŒºåˆ†çš„ã€‚</p>
<h3 id="_8">ç£ç›˜å­˜å‚¨æ¥å£<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<p>å­˜å‚¨è®¾å¤‡é€šå¸¸ç›´æ¥è¿æ¥åˆ°è®¡ç®—æœºç³»ç»Ÿä¸Šï¼Œå› æ­¤å¾€å¾€éœ€è¦ä¸€ä¸ªæ¥å£ã€‚ç›®å‰ä¸€äº›ä¸»æµçš„å­˜å‚¨è®¾å¤‡åè®®å®¶æ—æœ‰ï¼š</p>
<ul>
<li>
<p>SATA</p>
<p>æœ€è¿‘çš„ SATA 3 ç†è®ºå¸¦å®½å¯ä»¥è¾¾åˆ° 6Gbpsã€‚</p>
</li>
<li>
<p>SAS</p>
<p>ç¬¬ä¸‰ä»£ SAS ç†è®ºå¸¦å®½å¯è¾¾ 12Gbps ï¼Œç¬¬å››ä»£çš„ç†è®ºå¸¦å®½å¯è¾¾ 22.5Gbpsã€‚</p>
</li>
<li>
<p>NVMe</p>
<p>æ˜¯ä¸€ç§ç›´æ¥è¿è¡Œåœ¨ PCIe æ€»çº¿ä¸Šçš„é«˜æ•ˆåè®®ã€‚å®ƒé€šè¿‡ PCIe æ¥å£è®¿é—®éæ˜“å¤±æ€§æ•°æ®ï¼Œå»¶è¿Ÿæ›´å°ï¼Œä¼ è¾“é€Ÿåº¦æ›´å¿«ã€‚
NVMe 2.0 é‡‡ç”¨ PCIe 5.0 x4 æ¥å£ï¼Œç†è®ºå¸¦å®½å¯è¾¾çº¦ 16GB/sã€‚</p>
</li>
</ul>
<p>æˆ‘ä»¬ä¹Ÿæ—¶ä¸æ—¶éœ€è¦åœ¨ç½‘ç»œä¸Šå­˜å‚¨æ•°æ®ã€‚<strong>SAN</strong> å’Œ <strong>NAS</strong> å°±æ˜¯ä¸¤ç§ä¸»æµçš„ç½‘ç»œå­˜å‚¨æ¶æ„ã€‚</p>
<ul>
<li>
<p><strong>SAN(Storage Area Networks ï¼Œå­˜å‚¨åŒºåŸŸç½‘ç»œ)</strong></p>
<p>A large number of disks are connected by a high-speed network to a number of servers.</p>
</li>
<li>
<p><strong>NAS(Network Attached Storage ï¼Œç½‘ç»œé™„åŠ å­˜å‚¨)</strong></p>
<p>Networked storage provides a file system interface using networked file system protocol, instead of providing a disk system interface.</p>
</li>
</ul>
<h3 id="_9">ç£ç›˜å·¥ä½œæœºåˆ¶<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<p>ä¸‹å›¾å±•ç¤ºä¸€ä¸ªæœºæ¢°ç¡¬ç›˜çš„ç»“æ„ï¼š</p>
<p><img alt="disk_mechanism" src="../images/DB/db3.png" /></p>
<ol>
<li>
<p><strong>è¯»å†™ç£å¤´ (Read-write head)</strong></p>
<ul>
<li>
<p>å®šä½åœ¨ç›˜ç‰‡è¡¨é¢æè¿‘å¤„(å‡ ä¹æ¥è§¦)</p>
</li>
<li>
<p>é€šè¿‡ç£ç¼–ç æ–¹å¼è¯»å–/å†™å…¥ä¿¡æ¯  </p>
</li>
</ul>
<p><em>æŠ€æœ¯è¯´æ˜ï¼šç°ä»£ç¡¬ç›˜é‡‡ç”¨æ°”æµ®æŠ€æœ¯ä¿æŒ 3-10 çº³ç±³é—´è·ï¼Œç§°ä¸º"é£è¡Œé«˜åº¦"(Flying Height)</em></p>
</li>
<li>
<p>ç›˜ç‰‡è¡¨é¢åˆ’åˆ† </p>
<ul>
<li>
<p>ç”±åŒå¿ƒåœ†çŠ¶çš„<strong>ç£é“(Track)</strong>ç»„æˆ  </p>
</li>
<li>
<p>å…¸å‹ç¡¬ç›˜æ¯ç›˜ç‰‡å« 50,000-100,000 æ¡ç£é“  </p>
</li>
</ul>
<p><em>æ³¨ï¼šç£é“å¯†åº¦éšæŠ€æœ¯å‘å±•æå‡ï¼Œ HAMR(çƒ­è¾…åŠ©ç£è®°å½•)æŠ€æœ¯å¯è¾¾ 200k+TPI(æ¯è‹±å¯¸ç£é“æ•°)</em></p>
</li>
<li>
<p>ç£é“ç»“æ„ </p>
<ul>
<li>
<p>æ¯æ¡ç£é“åˆ’åˆ†ä¸º<strong>æ‰‡åŒº(Sector)</strong>  </p>
</li>
<li>
<p>æ‰‡åŒºæ˜¯ç‰©ç†è¯»å†™çš„æœ€å°æ•°æ®å•å…ƒ  </p>
</li>
<li>
<p>å…¸å‹æ‰‡åŒºå¤§å°ï¼š 512 å­—èŠ‚(ç°ä»£é«˜çº§æ ¼å¼ç›˜ä¸º 4K)  </p>
</li>
<li>
<p>æ¯ç£é“æ‰‡åŒºæ•°ï¼š<br />
    å†…åœˆç£é“ï¼š 500-1000 ä¸ª<br />
    å¤–åœˆç£é“ï¼š 1000-2000 ä¸ª  </p>
</li>
</ul>
<p><em>æŠ€æœ¯æ¼”è¿›ï¼š ZBR(åŒºä½è®°å½•)æŠ€æœ¯ä½¿å¤–åœˆç£é“å­˜å‚¨æ›´å¤šæ‰‡åŒº</em></p>
</li>
<li>
<p>æ‰‡åŒºè®¿é—®æœºåˆ¶</p>
<ul>
<li>
<p>ç£è‡‚æ‘†åŠ¨ä½¿ç£å¤´å®šä½åˆ°ç›®æ ‡ç£é“  </p>
</li>
<li>
<p>ç›˜ç‰‡æŒç»­æ—‹è½¬ï¼Œå½“æ‰‡åŒºç»è¿‡ç£å¤´ä¸‹æ–¹æ—¶å®Œæˆè¯»å†™  </p>
</li>
</ul>
<p><em>å»¶è¿Ÿç»„æˆï¼šå¯»é“æ—¶é—´(Seek Time) + æ—‹è½¬å»¶è¿Ÿ(Rotational Latency)</em></p>
</li>
<li>
<p><strong>ç£å¤´-ç›˜ç‰‡ç»„ä»¶(Head-Disk Assembly, HDA)</strong></p>
<ul>
<li>
<p>å•ä¸ªä¸»è½´å®‰è£…å¤šå±‚ç›˜ç‰‡(é€šå¸¸ 1-5 ç‰‡)  </p>
</li>
<li>
<p>æ¯ä¸ªç›˜é¢å¯¹åº”ä¸€ä¸ªç£å¤´ï¼Œæ‰€æœ‰ç£å¤´å®‰è£…åœ¨åŒä¸€ç£è‡‚ä¸Š  </p>
</li>
</ul>
<p><em>å…³é”®å‚æ•°ï¼šé¢å¯†åº¦(Areal Density) = ç£é“å¯†åº¦ Ã— çº¿æ€§å¯†åº¦</em></p>
</li>
<li>
<p><strong>æŸ±é¢(Cylinder)</strong>  </p>
<ul>
<li>ç”±æ‰€æœ‰ç›˜ç‰‡çš„ç¬¬ <span class="arithmatex">\(i\)</span> å·ç£é“ç»„æˆæŸ±é¢ <span class="arithmatex">\(i\)</span>  </li>
</ul>
<p><em>ä¼˜åŒ–åŸç†ï¼šåŒä¸€æŸ±é¢æ•°æ®æ— éœ€ç§»åŠ¨ç£è‡‚å³å¯è¿ç»­è®¿é—®</em></p>
</li>
</ol>
<p>æœ‰äº†ä¸»æœºç³»ç»Ÿå’Œå­˜å‚¨è®¾å¤‡ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªä¸»æœºç³»ç»Ÿä¸ç‰©ç†å­˜å‚¨è®¾å¤‡ä¹‹é—´çš„æ¡¥æ¢æ¥å®ç°ç®¡ç†å’Œä¼˜åŒ–æ•°æ®å­˜å–ã€‚<strong>ç£ç›˜ç®¡ç†å™¨(Disk Controller)</strong>å°±æ‹…å½“äº†è¿™ä¸€è§’è‰²ã€‚</p>
<p>ç£ç›˜ç®¡ç†å™¨ï¼š</p>
<ul>
<li>
<p>æ¥æ”¶é«˜å±‚è¯»å†™æ‰‡åŒºæŒ‡ä»¤ (è§£ææ¥è‡ªæ“ä½œç³»ç»Ÿçš„è¯»/å†™æ‰‡åŒºå‘½ä»¤)</p>
</li>
<li>
<p>å¯åŠ¨ç£ç›˜æ“ä½œï¼šä¾‹å¦‚é©±åŠ¨ç£å¤´ç§»åŠ¨åˆ°æŒ‡å®šç£é“ã€æ‰§è¡Œç‰©ç†å±‚é¢çš„æ•°æ®è¯»å†™æ“ä½œç­‰</p>
</li>
<li>
<p>æ•°æ®æ ¡éªŒç®¡ç†ï¼šä¸ºæ¯ä¸ªæ‰‡åŒºè®¡ç®—å¹¶é™„åŠ <strong>æ ¡éªŒå’Œ(checksums)</strong> (å¦‚ CRC32/ECC)ï¼Œè¯»å–æ—¶é€šè¿‡æ ¡éªŒå’ŒéªŒè¯æ•°æ®å®Œæ•´æ€§</p>
<ul>
<li>é”™è¯¯æ£€æµ‹æœºåˆ¶ï¼šå½“æ•°æ®æŸåæ—¶ï¼Œå­˜å‚¨çš„æ ¡éªŒå’Œä¸é‡æ–°è®¡ç®—å€¼ä¸åŒ¹é…çš„æ¦‚ç‡æé«˜</li>
</ul>
</li>
<li>
<p>å†™å…¥éªŒè¯ï¼šé‡‡ç”¨â€œå†™åè¯»â€(Read-After-Write)æŠ€æœ¯ç¡®ä¿å†™å…¥æˆåŠŸ</p>
</li>
<li>
<p>åæ‰‡åŒºå¤„ç†ï¼šæ‰§è¡Œåæ‰‡åŒºé‡æ˜ å°„ (remapping of bad sectors ï¼Œé€šè¿‡å¤‡ç”¨æ‰‡åŒºæ›¿æ¢æŸååŒºåŸŸ)</p>
</li>
</ul>
<h3 id="_10">ç£ç›˜æ€§èƒ½è¯„ä¼°<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<p>ç£ç›˜æ€§èƒ½ä¸€èˆ¬ä»ä»¥ä¸‹ç»´åº¦è¯„ä»·ï¼š</p>
<ul>
<li>
<p>Access time è®¿é—®æ—¶é—´</p>
<p>å¯¹ HDD åˆå¯ä»¥ç»†åˆ†ä¸º Seek time å¯»é“æ—¶é—´ å’Œ Rotation latency æ—‹è½¬å»¶è¿Ÿã€‚</p>
</li>
<li>
<p>Data-transfer rate æ•°æ®ä¼ è¾“é€Ÿç‡</p>
</li>
<li>
<p>IOPS æ¯ç§’ I/O æ“ä½œæ•°</p>
</li>
<li>
<p>Mean time of failure(MTTF) å¹³å‡æ•…éšœæ—¶é—´</p>
</li>
</ul>
<p>æ ¹æ®æ‰€è®¿é—®æ•°æ®çš„å‚¨å­˜ä½ç½®ï¼Œå¯ä»¥å°†è®¿é—®åˆ†ä¸ºéšæœºè®¿é—® (Random access)å’Œé¡ºåºè®¿é—® (Sequential access)ã€‚é¡ºåºè®¿é—®çš„ä¸Šé™ä¸»è¦ç”±ä¼ è¾“é€Ÿç‡å†³å®šï¼›éšæœºè®¿é—®çš„ä¸Šé™ä¸»è¦ç”± IOPS å†³å®šï¼Œ IOPS åˆä¸»è¦ç”±è®¿é—®æ—¶é—´å†³å®šã€‚</p>
<p>ä¼˜åŒ–ç£ç›˜æ€§èƒ½çš„å¸¸è§æ–¹å¼ä¸»è¦æœ‰ï¼š</p>
<ul>
<li>
<p>Buffering ç¼“å†²åŒºï¼Œé¿å…é‡å¤è¯»å†™ç›¸åŒæ•°æ®</p>
</li>
<li>
<p>Read-ahead é¢„è¯»å–</p>
</li>
<li>
<p>Disk-arm-scheduling ï¼šé’ˆå¯¹ HDD ï¼Œç›¸æ¯”è®©ç£å¤´æ¥å›æ‘‡æ‘†ï¼Œé€‚å½“é‡æ’ IO è¯·æ±‚ä½¿ç£å¤´æœ‰åºç§»åŠ¨èƒ½å‡å°‘å¹³å‡å¯»é“æ—¶é—´</p>
<div class="admonition ç”µæ¢¯ç®—æ³•">
<p class="admonition-title">ç”µæ¢¯ç®—æ³•</p>
</div>
</li>
<li>
<p>File Organization ï¼šé’ˆå¯¹ HDD ï¼Œæ–‡ä»¶æ•´ç†ï¼Œä½¿æ•°æ®åˆ†å¸ƒå°½å¯èƒ½æœ‰åº</p>
</li>
<li>
<p>Wear Leveling ï¼šé’ˆå¯¹ NVM å’Œ SSD ï¼Œå› ä¸ºæ“¦å†™å¯¿å‘½ç›¸å¯¹æœ‰é™ï¼Œéœ€è¦å®ç°è´Ÿè½½å‡è¡¡</p>
</li>
</ul>
<h3 id="flash-storage">é—ªå­˜ Flash Storage<a class="headerlink" href="#flash-storage" title="Permanent link">&para;</a></h3>
<h2 id="_11">æ•°æ®å­˜å‚¨ç»“æ„<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h2>
<p>ä»ç‰©ç†å­˜å‚¨çš„å±‚é¢ä¸Šçœ‹ï¼Œä¸€ä¸ªæ•°æ®åº“ç”±å¤šä¸ªæ–‡ä»¶(files)ç»„æˆï¼Œæ¯ä¸ªæ–‡ä»¶æ˜¯è®°å½•(records)çš„æœ‰åºåºåˆ—ï¼Œæ¯æ¡è®°å½•æ˜¯å­—æ®µ(fields)çš„æœ‰åºåºåˆ—ã€‚</p>
<p>ç”±äºæ‰‡åŒºçš„ç©ºé—´æ¯”è¾ƒå°ä¸”æ•°ç›®ä¼—å¤šï¼Œåœ¨å¯»å€æ—¶æ¯”è¾ƒå›°éš¾ï¼Œæ‰€ä»¥æ“ä½œç³»ç»Ÿå°±å°†å¤šä¸ªæ‰‡åŒºç»„åˆåœ¨ä¸€èµ·ï¼Œå½¢æˆä¸€ä¸ªæ›´å¤§çš„å•ä½ï¼Œå†å¯¹è¿™ä¸ªå•ä½è¿›è¡Œæ•´ä½“çš„æ“ä½œã€‚ä¸€èˆ¬å°†è¿™ä¸ªå•ä½ç§°ä½œ<strong>å—(blocks)</strong>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ“ä½œç³»ç»Ÿæ˜¯é€šè¿‡å—æ¥åšä¸ºå•ä½è¯»å–ç­‰æ“ä½œæ•°æ®çš„ã€‚è€Œæ–‡ä»¶ç³»ç»Ÿå°±æ˜¯æ“ä½œç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ï¼Œ<u>æ‰€ä»¥æ–‡ä»¶ç³»ç»Ÿæ“ä½œæ–‡ä»¶çš„æœ€å°å•ä½æ˜¯å—</u>ã€‚</p>
<p>æˆ‘ä»¬ä¸‹é¢çš„è®¨è®ºå‡è®¾æ¯æ¡è®°å½•çš„å¤§å°éƒ½ä¸è¶…è¿‡ä¸€ä¸ªå—ã€‚</p>
<h3 id="_12">å•æ¡è®°å½•<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<h4 id="_13">å®šé•¿è®°å½•å­˜å‚¨<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h4>
<p>æŒ‰è¡Œå­˜æ”¾ (Row-Oriented Storage) çš„å®šé•¿æ•°æ®çš„å¢æŸ¥æ”¹éƒ½å®¹æ˜“å®ç°ï¼š</p>
<ul>
<li>
<p>Store record i starting from byte <span class="arithmatex">\(n * (i â€“ 1)\)</span>, where <span class="arithmatex">\(n\)</span> is the size of each record.</p>
</li>
<li>
<p>è®¿é—®æ•°æ®æ˜¯ç®€å•çš„ï¼Œä½†æ˜¯ä¸€æ¡è®°å½•å¯èƒ½è·¨å—å­˜å‚¨ã€‚äºæ˜¯æˆ‘ä»¬åšå‡ºé™å®šï¼šè®°å½•ä¸å…è®¸è·¨è¶Šå—çš„è¾¹ç•Œã€‚</p>
</li>
</ul>
<p>åˆ é™¤ä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼ï¼š</p>
<ul>
<li>
<p>åˆ é™¤åçš„ç©ºä½ç”¨é“¾è¡¨ä¸²è”ä¾›ä¸‹æ¬¡æ’å…¥ç”¨ (å¦‚å›¾æ‰€ç¤ºï¼š link all free records on a free list)</p>
<p><img alt="file_deletion_1" src="../images/DB/db4.png" /></p>
</li>
<li>
<p>åˆ é™¤åå°†æœ€ä¸‹é¢çš„ä¸€ä¸ªæ•°æ®ç§»åˆ°åˆ é™¤åçš„ç©ºä½</p>
</li>
</ul>
<p>ä½†æ˜¯æ•°æ®è¿˜å¯ä»¥æŒ‰åˆ—å­˜æ”¾ï¼Œç§°ä¸º Columnar Representation æˆ– Column-Oriented Storage ã€‚å¢åˆ æŸ¥æ”¹çš„å®ç°ä¸ä¸Šé¢ç±»ä¼¼ï¼›æŒ‰åˆ—å­˜æ”¾æ›´æœ‰åˆ©äºå‘é‡è¿ç®—ã€‚å¦‚æœæŒ‰å±æ€§è®¿é—®å¤šäºæŒ‰ tuple è®¿é—®ï¼Œè¿™ç§å‚¨å­˜æ–¹å¼ä¼šæ›´å¿«ã€‚</p>
<h4 id="_14">ä¸å®šé•¿è®°å½•å­˜å‚¨<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h4>
<details class="tip">
<summary>ä¸ºä»€ä¹ˆä¼šæœ‰å˜é•¿è®°å½•</summary>
<ul>
<li>
<p>å¤šè®°å½•ç±»å‹å…±å­˜ï¼šå•æ–‡ä»¶å­˜å‚¨ä¸åŒç»“æ„è®°å½•(å¦‚ PostgreSQL çš„ TOAST æœºåˆ¶)</p>
</li>
<li>
<p>å˜é•¿å­—æ®µï¼š VARCHARã€TEXTã€BLOB ç­‰ç±»å‹</p>
</li>
<li>
<p>é‡å¤å­—æ®µï¼šå†å²æ•°æ®æ¨¡å‹(å¦‚ç½‘çŠ¶/å±‚æ¬¡æ¨¡å‹)å…è®¸çš„å¤šå€¼å±æ€§</p>
</li>
</ul>
<p>ä¾‹å¦‚ï¼Œå­˜å‚¨ JSON æ•°ç»„æ—¶å¯èƒ½äº§ç”Ÿå˜é•¿è®°å½•</p>
</details>
<p>ç”¨ null-bit map è§£å†³å…è®¸ä¸º NULL çš„æ•°æ®å‚¨å­˜ã€‚n ä¸ªå…è®¸ä¸ºç©ºçš„å±æ€§éœ€è¦ n ä¸ª bit çš„ç©ºä½å›¾ï¼Œç©ºä½å›¾ä¸­æŸä¸€ bit ä¸º 0/1 æ„å‘³ç€å¯¹åº”çš„å±æ€§ä¸æ˜¯/æ˜¯ç©ºçš„ã€‚</p>
<blockquote>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ memory ä¸å…è®¸ä»¥ bit ä¸ºå•ä½çš„è¯»å†™ï¼Œ n ä¸èƒ½è¢« 8 æ•´é™¤æ—¶éœ€è¦è¡¥é½åˆ° 8 çš„æ•´å€æ•° (è‡³å°‘ 1Byte) ä»¥å®ç° Byte ä¸ºå•ä½çš„è¯»å†™ã€‚</p>
</blockquote>
<p>å±æ€§æŒ‰ç…§é¡ºåºå­˜å‚¨ã€‚å¯¹äºä¸å®šé•¿çš„å±æ€§å€¼ï¼Œç”¨å®šé•¿çš„æ•°æ® <span class="arithmatex">\(\mbox{(offset, length)}\)</span> é—´æ¥è¡¨è¾¾ï¼Œä¾‹å¦‚å›¾ä¸­(21, 5)è¡¨ç¤ºè¯¥å±æ€§ä» 21 å· Byte å¼€å§‹ä¸”é•¿åº¦ä¸º 5ã€‚
åœ¨å®šé•¿çš„å±æ€§å€¼å­˜å‚¨å®Œåå†å­˜å‚¨ä¸å®šé•¿å±æ€§å€¼çš„æœ¬ä½“ã€‚</p>
<p><img alt="file_deletion_2" src="../images/DB/db5.png" /></p>
<h3 id="slotted-page">æ§½å¼é¡µ(Slotted Page)<a class="headerlink" href="#slotted-page" title="Permanent link">&para;</a></h3>
<p><strong>Slotted Page(æ§½å¼é¡µ)</strong> æ˜¯æ•°æ®åº“ç³»ç»Ÿä¸­ç”¨äºç»„ç»‡ç£ç›˜æ•°æ®é¡µçš„ä¸€ç§é«˜æ•ˆç»“æ„ï¼Œç‰¹åˆ«é€‚ç”¨äºç®¡ç†å˜é•¿è®°å½•ã€‚</p>
<p>ä¸å®šé•¿æ•°æ®çš„æ•°æ®é¡µä¸€èˆ¬é‡‡ç”¨ä¸¤å¤´å¤¹å‡»çš„ç»“æ„ä¾¿äºå¯¹é½ã€‚</p>
<ul>
<li>
<p>é¡µå¤´(Header)è®¾è®¡</p>
<ul>
<li>
<p>è®°å½•æ¡ç›®æ•°ï¼šç»´æŠ¤å½“å‰é¡µå†…æœ‰æ•ˆè®°å½•æ•°(å¦‚ PostgreSQL çš„<code>pd_lowe</code>)</p>
</li>
<li>
<p>ç©ºé—²ç©ºé—´å°¾æŒ‡é’ˆï¼šæŒ‡å‘å¯ç”¨ç©ºé—´èµ·å§‹ä½ç½®(å¦‚ MySQL çš„<code>PAGE_FREE</code>)</p>
</li>
<li>
<p>è®°å½•ä½ç½®/å¤§å°æ•°ç»„ï¼šæ¯ä¸ªæ§½ä½å­˜å‚¨(offset, length)äºŒå…ƒç»„</p>
</li>
</ul>
</li>
<li>
<p>è®°å½•ç§»åŠ¨ç­–ç•¥</p>
<p>æ•°æ®é¡µå¯ä»¥é€šè¿‡ç§»åŠ¨è®°å½•æ¶ˆé™¤ç¢ç‰‡ï¼Œä¿æŒæ•°æ®çš„è¿ç»­æ€§ã€‚</p>
<p>ä½†æ˜¯éœ€è¦æ³¨æ„ï¼Œæ‰€æœ‰çš„ç›¸å…³æŒ‡é’ˆå¿…é¡»åŒæ­¥åŸå­æ€§æ›´æ–°ï¼Œå¦åˆ™ä¼šç ´åæ•°æ®çš„ä¸€è‡´æ€§ã€‚</p>
</li>
<li>
<p>æŒ‡é’ˆé—´æ¥è®¿é—®ã€‚å¤–éƒ¨æŒ‡é’ˆæŒ‡å‘é¡µå¤´ä¸­æŒ‡å‘å®é™…æ•°æ®çš„æŒ‡é’ˆ(äºŒçº§æŒ‡é’ˆ)ã€‚</p>
</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>graph LR
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>A[å¤–éƒ¨æŒ‡é’ˆ] --&gt; B[æ§½æ•°ç»„æ¡ç›®]
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>B --&gt; C[å®é™…è®°å½•ä½ç½®]
</span></code></pre></div>
<h3 id="_15">æ–‡ä»¶è®°å½•ç»„ç»‡<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h3>
<p>æˆ‘ä»¬æ€»éœ€è¦ä¸€ç§æ–¹å¼ç»„ç»‡å•æ¡æ•°æ®å’Œæ•°æ®é¡µï¼Œå³å®ƒä»¬å¦‚ä½•åˆ†å¸ƒåœ¨æ–‡ä»¶å†…éƒ¨ã€‚ä¸‹å›¾æ˜¯å‡ ç§å¸¸è§çš„ç»“æ„ï¼š</p>
<p><img alt="File_Organization" src="../images/DB/db6.png" /></p>
<h4 id="heap">å †(Heap)æ–‡ä»¶ç®¡ç†<a class="headerlink" href="#heap" title="Permanent link">&para;</a></h4>
<p>å †æ–‡ä»¶çš„<strong>ç‰¹æ€§</strong>æœ‰ï¼š</p>
<ul>
<li>
<p>è®°å½•è‡ªç”±æ”¾ç½®ï¼šè®°å½•å¯ä»¥æ’å…¥åˆ°æ–‡ä»¶ä¸­ä»»ä½•æœ‰ç©ºé—²ç©ºé—´çš„ä½ç½®</p>
</li>
<li>
<p>è®°å½•å›ºå®šæ€§ï¼šè®°å½•ä¸€æ—¦å†™å…¥é€šå¸¸ä¸ç§»åŠ¨(é™¤éä¸»åŠ¨é‡ç»„)</p>
</li>
<li>
<p>å…³é”®éœ€æ±‚ï¼šéœ€è¦é«˜æ•ˆå®šä½ç©ºé—²ç©ºé—´</p>
</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥é‡‡ç”¨<strong>ç©ºé—²ç©ºé—´æ˜ å°„è¡¨(Free-Space Map, FSM)</strong>æ¥å¿«é€Ÿå®šä½æœ‰è¶³å¤Ÿç©ºé—²ç©ºé—´çš„å—ã€‚</p>
<ul>
<li>
<p>å¯¹äºä¸€çº§ FSM ï¼Œæ¯ä¸ªå—å¯¹åº”ä¸€ä¸ªæ¡ç›®(1 entry per block)ã€‚æ¯ä¸€ä¸ªæ¡ç›®éƒ½ç”¨æ•°ä½(ä¸€èˆ¬æœ€å¤šåˆ°ä¸€ä¸ªå­—èŠ‚)æ¥è®°å½•å¯¹åº”å—ä¸­ç©ºä½™ç©ºé—´çš„æ¯”ä¾‹ã€‚</p>
</li>
<li>
<p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š</p>
<details class="example">
<summary>Example</summary>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ¯ä¸ªæ¡ç›®æˆ‘ä»¬ç”¨ 3 ä½ï¼Œæ¡ç›®å€¼é™¤ä»¥ 8 (<span class="arithmatex">\(2^3\)</span>) çš„å€¼å°±æ˜¯å—ä¸­å‰©ä½™ç©ºé—´çš„æ¯”ä¾‹ã€‚</p>
<p>æˆ‘ä»¬è¿˜å¯ä»¥é‡‡å–äºŒçº§ FSM çš„æ–¹å¼åŠ é€Ÿå¤§èŒƒå›´ç©ºé—²å—æœç´¢ã€‚æ¯”å¦‚ï¼Œå¯¹äºè¿™ä¸ªç¤ºä¾‹ï¼Œæˆ‘ä»¬è®©æ¯ä¸ªäºŒçº§æ¡ç›®å¯¹åº” 4 ä¸ªä¸€çº§æ¡ç›®ï¼Œå­˜å‚¨è¿™ 4 ä¸ªå—ä¸­çš„æœ€å¤§ç©ºé—²æ¯”ä¾‹ã€‚</p>
</details>
</li>
<li>
<p>FSM ä¼šå®šæœŸå†™å…¥(éå®æ—¶æ›´æ–°)ç£ç›˜ï¼Œå®¹å¿æš‚æ—¶æ€§ä¸ä¸€è‡´ï¼Œè¿™ç§æš‚æ—¶æ€§çš„ä¸ä¸€è‡´ä¼šè¢«æ£€æµ‹å¹¶ä¿®å¤ã€‚é€šå¸¸é‡‡å–çš„æ£€æµ‹æ–¹å¼æ˜¯ï¼Œåœ¨å®é™…åˆ†é…æ—¶å†æ¬¡éªŒè¯å¯ç”¨ç©ºé—´ã€‚</p>
</li>
</ul>
<h4 id="sequential">é¡ºåº(Sequential)æ–‡ä»¶ç®¡ç†<a class="headerlink" href="#sequential" title="Permanent link">&para;</a></h4>
<p>è¿™é‡Œçš„ Sequential ä¸æ˜¯æŒ‡å‚¨å­˜ç©ºé—´ä¸Šæœ‰åºï¼Œè€Œæ˜¯æŒ‡æ¯ä¸€æ¡æ•°æ®é€»è¾‘å…³ç³»ä¸Šæœ‰åºã€‚åœ¨æ•°æ®ç»å¸¸æŒ‰æŸç§æ’åºå…ˆåå–ç”¨æ—¶ï¼Œå¯ä»¥è€ƒè™‘é¡ºåºæ–‡ä»¶ç³»ç»Ÿã€‚å…ˆåé€»è¾‘ä¸€èˆ¬ç”¨ç±»ä¼¼æŒ‡é’ˆçš„ç»“æ„å®ç°ã€‚</p>
<ul>
<li>
<p>åˆ é™¤ï¼šä½¿ç”¨æŒ‡é’ˆé“¾ã€‚æ”¹å˜æŒ‡é’ˆæŒ‡å‘ä»¥æ”¹å˜é€»è¾‘å…ˆåå…³ç³»ã€‚ç©ºä½™ä½ç½®çš„å¤„ç†è§†å•æ¡æ•°æ®çš„ç»“æ„è€Œå®šã€‚</p>
</li>
<li>
<p>æ’å…¥ï¼šéœ€è¦å…ˆå®šä½è®°å½•åœ¨ä½•å¤„æ’å…¥ã€‚æœ‰å‰©ä½™ç©ºé—´å¯ä»¥ç›´æ¥æ’å…¥ã€‚ä½†æ˜¯å¦‚æœå½“å‰ block æ»¡äº†ï¼Œåªèƒ½æ’å…¥åˆ°æ–° block ä¸­(<strong>overflow block</strong>)ã€‚ä½†æˆ‘ä»¬åˆéœ€è¦ç»´æŒé€»è¾‘å…ˆåå…³ç³»ï¼Œè¿™æ—¶å°±ä¼šå½¢æˆä¸‹å›¾æ‰€ç¤ºçš„ç»“æ„(ä¸ºä¾¿äºç†è§£è¿™é‡Œä»¥å®šé•¿æ•°æ®ä¸ºä¾‹)ã€‚</p>
<p><img alt="overflow_block" src="../images/DB/db7.png" /></p>
</li>
</ul>
<p>å› ä¸ºå­˜åœ¨ä¸Šå›¾æ‰€ç¤ºé—®é¢˜ï¼Œåœ¨å¤šæ¬¡æ’å…¥å’Œåˆ é™¤ä¹‹åæŒ‡é’ˆç³»ç»Ÿä¼šå˜å¾—å¾ˆä½æ•ˆï¼Œå› æ­¤é¡ºåºæ–‡ä»¶ç³»ç»Ÿéœ€è¦é€‚æ—¶ Reorganizeã€‚</p>
<h4 id="multitable-clustering">å¤šè¡¨èšç°‡(Multitable Clustering)æ–‡ä»¶ç®¡ç†<a class="headerlink" href="#multitable-clustering" title="Permanent link">&para;</a></h4>
<p>è¿™ç§æŠ€æœ¯å°†å¤šä¸ªé€»è¾‘ä¸Šå…³è”çš„è¡¨çš„è®°å½•æ··åˆå­˜å‚¨åœ¨åŒä¸€ä¸ªç‰©ç†æ–‡ä»¶å—ä¸­ï¼Œä»¥ä¼˜åŒ–å…³è”æŸ¥è¯¢æ€§èƒ½ã€‚ä»å®ç°ä¸Šçœ‹ï¼Œå®ƒæ˜¯å°†é¢‘ç¹å‚ä¸è¿æ¥æ“ä½œ(å¦‚<code>JOIN</code>)çš„è¡¨è®°å½•å­˜å‚¨åœ¨åŒä¸€ç‰©ç†é¡µæˆ–ç›¸é‚»é¡µä¸­ã€‚ä¸‹é¢å°±æ˜¯ä¸€ä¸ªä¾‹å­ï¼š</p>
<p><img alt="example_of_mul_clus" src="../images/DB/db8.png" /></p>
<p>è¿™å¯ä»¥æé«˜æŸ¥æ‰¾çš„é€Ÿåº¦ï¼Œä½†ä¹Ÿæ„å‘³ç€æˆå€çš„ç©ºé—´å’Œå¢åˆ æ”¹æˆæœ¬ã€‚</p>
<p>ä¼˜åŠ¿ï¼š</p>
<p>âœ… å…³è”æŸ¥è¯¢æ€§èƒ½æå‡</p>
<p>âœ… å‡å°‘è¿æ¥æ“ä½œçš„ CPU å¼€é”€</p>
<p>âœ… æé«˜ç¼“å­˜å±€éƒ¨æ€§(ç›¸å…³æ•°æ®åŒå¤„ CPU ç¼“å­˜è¡Œ)</p>
<p>å±€é™ï¼š</p>
<p>âŒ éå…³è”æŸ¥è¯¢å¯èƒ½å˜æ…¢(å¦‚å…¨è¡¨æ‰«æå•è¡¨)</p>
<p>âŒ æ’å…¥/æ›´æ–°å¼€é”€å¢åŠ (éœ€ç»´æŠ¤å…±ç½®å…³ç³»)</p>
<p>âŒ è®¾è®¡å¤æ‚åº¦é«˜(éœ€é¢„çŸ¥æŸ¥è¯¢æ¨¡å¼)</p>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨æŒ‡é’ˆè¿æ¥èµ·ä¸€äº›å…³ç³»çš„è®°å½•ï¼š</p>
<p><img alt="pointer_mul_clus" src="../images/DB/db9.png" /></p>
<h4 id="table-partitioning">Table Partitioning<a class="headerlink" href="#table-partitioning" title="Permanent link">&para;</a></h4>
<p>ä¸€ä¸ªå…³ç³»é‡Œçš„æœ‰äº›è®°å½•å¯ä»¥è¢«åˆ†æˆä¸€äº›æ›´å°çš„è®°å½•åˆ†åˆ«å‚¨å­˜ã€‚</p>
<p>ä¾‹å¦‚é€‰è¯¾ä¿¡æ¯è¡¨ï¼Œè™½ç„¶ä»é€»è¾‘ä¸Šæ‰€æœ‰å­¦å¹´çš„é€‰è¯¾ä¿¡æ¯éƒ½åœ¨åŒä¸€å¼ è¡¨ä¸Šï¼Œä½†æ˜¯å› ä¸ºå¾€å¹´çš„æ•°æ®å‡ ä¹ä¸éœ€è¦å¢åˆ æŸ¥æ”¹ï¼Œæ•°æ®æ“ä½œé›†ä¸­äºå½“å‰å­¦å¹´ï¼Œæ‰€ä»¥æŒ‰ç…§å­¦å¹´ç‰©ç†åˆ’åˆ†ä¸ºå¤šä¸ªå‚¨å­˜æ–‡ä»¶å°†æœ‰åŠ©äºæé«˜æ€§èƒ½ã€‚</p>
<h4 id="b-tree-file-index">B+ Tree File Index<a class="headerlink" href="#b-tree-file-index" title="Permanent link">&para;</a></h4>
<p>B+æ ‘ä¸ä»…å¯ä»¥ä½œä¸ºç´¢å¼•çš„ç»“æ„ï¼Œè¿˜å¯ä»¥ç›´æ¥ä½œä¸ºæ–‡ä»¶ç»„ç»‡çš„ç»“æ„ã€‚åœ¨ä¸‹ä¸€ç« â€œç´¢å¼•â€ä¸­ä¼šè¿›è¡Œä»‹ç»ã€‚</p>
<h3 id="data-dictionary-storage">æ•°æ®å­—å…¸å­˜å‚¨(Data Dictionary Storage)<a class="headerlink" href="#data-dictionary-storage" title="Permanent link">&para;</a></h3>
<p>ä¸Šé¢çš„ä¸‰ç±»æ–‡ä»¶ç»„ç»‡éƒ½æ˜¯å¯¹åº“ä¸­çš„å®ä¾‹è€Œè¨€çš„ï¼Œä½†æ˜¯æ•°æ®åº“è¿˜æœ‰ä¸€äº›æ¡†æ¶æ€§çš„å…¨å±€çš„ä¿¡æ¯éœ€è¦å‚¨å­˜ï¼Œæˆ‘ä»¬ç§°ä¸º<strong>Metadata</strong>ã€‚<strong>Data Dictionary</strong>(äº¦ç§°<strong>system catalog</strong>)å°±ç”¨æ¥å­˜å‚¨è¿™äº›ä¿¡æ¯ã€‚</p>
<p><img alt="data_dic_storage" src="../images/DB/db10.png" /></p>
<p>å…¶ä¸­ä¸€ç§å®ç°æ–¹å¼æ˜¯ç”¨äº‹å…ˆçº¦å®šçš„å›ºå®šçš„å‡ ä¸ªè¡¨ï¼Œå‚¨å­˜ç”¨æˆ·å®šä¹‰çš„ä¿¡æ¯ã€‚åœ¨ç£ç›˜ä¸­ï¼Œè¿™äº› metadata å¯ä»¥ç”¨ä¸‹é¢çš„å…³ç³»å›¾è¡¨ç¤ºï¼š</p>
<p><img alt="data_dic_storage_relation" src="../images/DB/db11.png" /></p>
<h3 id="_16">ç¼“å†²åŒº/ç¼“å­˜<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h3>
<p>æˆ‘ä»¬å¸Œæœ›æ›´å¿«é€Ÿåœ°è·å–ä¸€äº›çŸ­æ—¶é—´å†…é¢‘ç¹ä½¿ç”¨çš„æ•°æ®ã€‚<strong>ç¼“å†²åŒº(Buffer)</strong>å°±æ˜¯è¿™æ ·çš„è§’è‰²ã€‚Buffer æ˜¯ä¸»å†…å­˜ä¸­ç”¨äºå­˜å‚¨ç£ç›˜å—å‰¯æœ¬çš„ä¸“ç”¨åŒºåŸŸã€‚è€Œ<strong>ç¼“å†²åŒºç®¡ç†å™¨(Buffer Manager)</strong>å°±æ˜¯è´Ÿè´£åŠ¨æ€åˆ†é…å’Œç®¡ç†å†…å­˜ç¼“å†²åŒºçš„æ ¸å¿ƒå­ç³»ç»Ÿã€‚</p>
<p>ç¨‹åºè¿›ç¨‹éœ€è¦ç¼“å†²åŒºä¸­çš„æ•°æ®æ—¶ï¼Œå®ƒä»¬å°±ä¼šå”¤èµ·ç¼“å†²åŒºç®¡ç†å™¨ã€‚</p>
<p>è‹¥è¯¥å—å·²åœ¨ç¼“å†²åŒºä¸­ï¼Œç¼“å†²åŒºç®¡ç†å™¨è¿”å›å…¶åœ¨ä¸»å†…å­˜ä¸­çš„åœ°å€ã€‚  </p>
<p>è‹¥è¯¥å—ä¸åœ¨ç¼“å†²åŒºä¸­ï¼Œç¼“å†²åŒºç®¡ç†å™¨åˆ™ï¼š  </p>
<ol>
<li>
<p>åœ¨ç¼“å†²åŒºå†…ä¸ºè¯¥å—åˆ†é…ç©ºé—´  </p>
</li>
<li>
<p>å¦‚æœ‰å¿…è¦ï¼Œç½®æ¢(ç§»å‡º)å…¶ä»–å—ä»¥è…¾å‡ºç©ºé—´  </p>
<ul>
<li>ä»…å½“è¢«ç½®æ¢å—è‡ªä¸Šæ¬¡ç£ç›˜è¯»å†™åè¢«ä¿®æ”¹è¿‡ï¼Œæ‰å°†å…¶å†™å›ç£ç›˜  </li>
</ul>
</li>
<li>
<p>å°†ç›®æ ‡å—ä»ç£ç›˜è¯»å…¥ç¼“å†²åŒºï¼Œå¹¶å‘è¯·æ±‚è€…è¿”å›å…¶ä¸»å†…å­˜åœ°å€</p>
</li>
</ol>
<p>æœ€å¸¸ç”¨çš„æ˜¯ LRU ç­–ç•¥(Least Recently Used Stratergy)ï¼Œå³æ ¹æ®â€œæœ€è¿‘è®¿é—®è¿‡çš„å†…å®¹æ›´æœ‰å¯èƒ½å†æ¬¡è¢«è®¿é—®â€çš„åŸåˆ™ç®¡ç†ç¼“å­˜å†…å®¹ã€‚éœ€è¦ç†è§£ä¸‹å›¾æ‰€ç¤º buffer çš„å˜åŒ–(å®é™…ä¸Šè¿™éƒ¨åˆ†å†…å®¹è®¡ç»„ä¹Ÿæ¶‰åŠè¿‡)ï¼š</p>
<p><img alt="buffer_change" src="../images/DB/db12.png" /></p>
<p>å…¶ä½™ç¼“å­˜ç­–ç•¥ï¼š</p>
<p><img alt="other_buffer_rep_policy" src="../images/DB/db13.png" /></p>
<h2 id="indexing">ç´¢å¼•(Indexing)<a id="indexing"></a><a class="headerlink" href="#indexing" title="Permanent link">&para;</a></h2>
<p>ç´¢å¼•æœºåˆ¶æ—¨åœ¨åŠ é€Ÿå¯¹ç›®æ ‡æ•°æ®çš„è®¿é—®ã€‚æˆ‘ä»¬ç”Ÿæ´»ä¸­ä¹Ÿä¼šé‡åˆ°ç´¢å¼•ï¼Œæ¯”å¦‚å›¾ä¹¦é¦†ä¹¦ç›®çš„ç´¢å¼•ã€‚</p>
<p>ä¸€ä¸ª<strong>ç´¢å¼•æ–‡ä»¶(index file)</strong>ç”±å¦‚ä¸‹å½¢å¼çš„è®°å½•(ç§°ä¸º<strong>ç´¢å¼•æ¡ç›®(index entries)</strong>)</p>
<p><img alt="index_form" src="../images/DB/db14.png" /></p>
<p>å…¶ä¸­ï¼Œ<strong>search key(æœç´¢é”®)</strong>æ˜¯æ‰€æœ‰åˆ—ä¸­è¢«é€‰ä¸­ç”¨æ¥æŸ¥æ‰¾è®°å½•çš„å±æ€§(åˆ—å)ã€‚è¿™é‡Œçš„æŒ‡é’ˆéƒ½æŒ‡å‘å„æ¡è®°å½•ã€‚</p>
<h3 id="_17">æœ‰åºç´¢å¼•å’Œæ— åºç´¢å¼•<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<p>æœ‰ä¸¤ç§åŸºæœ¬çš„ç´¢å¼•æ–¹å¼ï¼š<strong>æœ‰åºç´¢å¼•</strong>å’Œ<strong>æ— åºç´¢å¼•</strong>ã€‚è¿™é‡Œçš„â€œåºâ€æŒ‡çš„æ˜¯ search key çš„å€¼æœ‰æ— é¡ºåºã€‚</p>
<p>æ— åºç´¢å¼•æ¯”è¾ƒå¸¸è§çš„æ˜¯<strong>å“ˆå¸Œç´¢å¼•(Hash indecies)</strong>ï¼Œå…¶åŸç†å°±æ˜¯é€šè¿‡å“ˆå¸Œæ“ä½œåˆ†å¸ƒï¼Œè€Œå“ˆå¸Œæ“ä½œæƒ³å¿…å¤§å®¶åœ¨ FDS è¯¾ç¨‹ä¸­éƒ½å·²ç»æœ‰æ‰€äº†è§£ã€‚</p>
<p>é¡ºåºç´¢å¼•å¯ä»¥æ ¹æ®ä¸åŒçš„æ’åºè§„åˆ™åˆ†ç±»æˆï¼š</p>
<ul>
<li>
<p><strong>Primary Index (clustering index)</strong></p>
<p>ç´¢å¼•(æœç´¢é”®)çš„é¡ºåºä¸ç‰©ç†å‚¨å­˜çš„é¡ºåºå¯¹åº”ã€‚</p>
<p><img alt="primary_index" src="../images/DB/db15.png" /></p>
<p><strong>Index-sequential file</strong>: ordered sequential file with a primary index.</p>
</li>
<li>
<p><strong>Secondary Index (non-clustering index)</strong></p>
<p>ç‰©ç†å­˜å‚¨ä¸æŒ‰ç…§æœç´¢é”®å­˜å‚¨ã€‚æ¯ä¸ªç´¢å¼•æ¡ç›®æŒ‡å‘ä¸€ä¸ªæŒ‡é’ˆæ¡¶ï¼Œè¿™ä¸ªæŒ‡é’ˆæ¡¶æŒ‡å‘ç›¸åŒæœç´¢é”®å€¼çš„æ‰€æœ‰æ•°æ®ã€‚</p>
<p><img alt="secondary_index" src="../images/DB/db16.png" /></p>
</li>
</ul>
<p><u>äºŒçº§ç´¢å¼•å¿…é¡»æ˜¯<strong>ç¨ å¯†(Dense)</strong>çš„</u>ã€‚ä¸€ä¸ªç¨ å¯†ç´¢å¼•ä¸­ï¼Œä¸€æ¡ç´¢å¼•å¿…é¡»å¯¹åº”ä¸€ä¸ªæœç´¢é”®å€¼ï¼Œæ¯ä¸ªæœç´¢é”®å€¼éƒ½è¦æœ‰ç›¸åº”çš„ç´¢å¼•å¯¹åº”ã€‚ç¨ å¯†ç´¢å¼•å¯¹æ–‡ä»¶æ˜¯å¦æ˜¯é¡ºåºçš„æ²¡æœ‰è¦æ±‚ã€‚</p>
<p><img alt="secondary_dense" src="../images/DB/db17.png" /></p>
<p>åœ¨ä¸Šå›¾ä¸­ï¼Œæ–‡ä»¶å¹¶æ²¡æœ‰æŒ‰ç…§ç´¢å¼•çš„æœç´¢é”®<code>dept_name</code>å­˜å‚¨ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªäºŒçº§ç´¢å¼•ï¼ŒåŒæ—¶æ˜¯ä¸€ä¸ªç¨ å¯†ç´¢å¼•ã€‚</p>
<p>ä¸ä¹‹å¯¹åº”çš„ï¼Œ<strong>ç¨€ç–ç´¢å¼•(Sparse Index)</strong>æŒ‡çš„æ˜¯åªæœ‰éƒ¨åˆ†æœç´¢é”®å€¼æœ‰å¯¹åº”ç´¢å¼•ã€‚</p>
<p><img alt="sparse_index" src="../images/DB/db18.png" /></p>
<p>æ¯”å¦‚æˆ‘ä»¬å¦‚æœæƒ³æ‰¾åˆ°æœç´¢é”®å€¼ä¸º K çš„è®°å½•ï¼š</p>
<ul>
<li>
<p>æ‰¾åˆ°æ¯” K å°çš„æœç´¢é”®å€¼ä¸­æœ€å¤§çš„é‚£ä¸ªçš„ç´¢å¼•</p>
</li>
<li>
<p>ä»ç´¢å¼•æŒ‡å‘çš„è®°å½•å¼€å§‹é¡ºåºæŸ¥æ‰¾</p>
</li>
</ul>
<p>ç¨€ç–ç´¢å¼•ç›¸è¾ƒäºç¨ å¯†ç´¢å¼•ï¼Œå…¶å¯ä»¥</p>
<ul>
<li>
<p>æ˜¾è‘—å‡å°‘ç´¢å¼•ä½“ç§¯ï¼›</p>
</li>
<li>
<p>ç»´æŠ¤æˆæœ¬ä½ï¼Œå¢åˆ æ“ä½œæ—¶ä¸€èˆ¬æƒ…å†µä¸‹åªéœ€è¦æ›´æ–°å°‘é‡ç´¢å¼•æ¡ç›®ã€‚ä¾‹å¦‚ï¼šå—å†…æ•°æ®å˜åŠ¨ä¸è§¦å‘ç´¢å¼•æ›´æ–°ï¼Œé™¤éæ¶‰åŠå—çš„è¾¹ç•Œé”®å€¼ã€‚</p>
</li>
</ul>
<p>ä½†æ˜¯ï¼Œç¨€ç–ç´¢å¼•ç”±äºéœ€è¦ä¸¤æ­¥å®šä½è®°å½•ï¼Œæ‰€ä»¥æ•´ä½“ä¸ŠæŸ¥è¯¢è®°å½•çš„æ•ˆç‡ä¸å¦‚ç¨ å¯†ç´¢å¼•ã€‚</p>
<p>æˆ‘ä»¬æœ‰ä¸€ä¸ªè¾ƒå¥½çš„æŠ˜ä¸­æ–¹æ¡ˆï¼Œ<strong>æŒ‰æ•°æ®å—å»ºç«‹ç¨€ç–ç´¢å¼•</strong>ï¼šæ¯ä¸ªæ–‡ä»¶å—(Block)åœ¨ç´¢å¼•ä¸­å¯¹åº”ä¸€ä¸ªæ¡ç›®ï¼Œå­˜å‚¨è¯¥å—çš„æœ€å°æœç´¢é”®å€¼ã€‚</p>
<p>æŒ‰ç…§è¿™ä¸ªæ–¹æ¡ˆï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­åµŒå¥—ä¸‹å»ï¼Œå½¢æˆ<strong>å¤šçº§ç´¢å¼•(Multilevel Index)</strong>ã€‚</p>
<h3 id="b">B+æ ‘ç´¢å¼•<a class="headerlink" href="#b" title="Permanent link">&para;</a></h3>
<p>æœ‰äº†å‰é¢çš„å¤šçº§ç´¢å¼•ç»“æ„ï¼Œæˆ‘ä»¬æˆ–è®¸èƒ½å¤Ÿè”æƒ³åˆ°æ ‘çš„ç»“æ„ã€‚äºæ˜¯ï¼Œ<strong>B+æ ‘ç´¢å¼•</strong>ä½œä¸ºä¸€ç§é¡ºåºç´¢å¼•çš„æ›¿ä»£å‡ºç°äº†ï¼Œå¹¶ä¸”å¹¿æ³›ä¸ºå¤§å®¶æ‰€ç”¨ï¼</p>
<p><strong>ç´¢å¼•é¡ºåºæ–‡ä»¶çš„ç¼ºç‚¹</strong>ï¼š  </p>
<ul>
<li>
<p>å› æº¢å‡ºå—(overflow block)å¢å¤šï¼Œå…¶æ€§èƒ½ä¼šéšç€æ–‡ä»¶å¢å¤§è€Œä¸‹é™ </p>
</li>
<li>
<p>éœ€å®šæœŸé‡ç»„æ•´ä¸ªæ–‡ä»¶  </p>
</li>
</ul>
<p><strong>B+æ ‘ç´¢å¼•æ–‡ä»¶çš„ä¼˜ç‚¹</strong>ï¼š  </p>
<ul>
<li>
<p>æ’å…¥/åˆ é™¤æ—¶å¯è‡ªåŠ¨å°å¹…é‡ç»„  </p>
</li>
<li>
<p>å¤šæ•°æƒ…å†µä¸‹æ— éœ€å…¨æ–‡ä»¶é‡ç»„å³å¯ç»´æŒæ€§èƒ½  </p>
</li>
</ul>
<p><strong>(æ¬¡è¦)B+æ ‘çš„åŠ£åŠ¿</strong>ï¼š  </p>
<ul>
<li>
<p>é¢å¤–çš„æ’å…¥/åˆ é™¤å¼€é”€  </p>
</li>
<li>
<p>ç©ºé—´å ç”¨ç•¥é«˜  </p>
</li>
</ul>
<p>ä½†æ˜¯ï¼Œ B+æ ‘ä¼˜ç‚¹è¿œèƒœç¼ºç‚¹ï¼Œå› è€Œè¢«å¹¿æ³›åº”ç”¨ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ª B+æ ‘çš„ä¾‹å­ï¼š</p>
<p><img alt="example_bplus" src="../images/DB/db19.png" /></p>
<h4 id="b_1">B+æ ‘çš„ç»“æ„<a class="headerlink" href="#b_1" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>æ‰€æœ‰å¶å­èŠ‚ç‚¹æ·±åº¦ç›¸åŒã€‚æˆ‘ä»¬å·²ç»å­¦è¿‡ï¼Œ n é˜¶é«˜åº¦ä¸º h çš„ B+ æ ‘çš„å¶å­å±‚æœ€å°‘æœ‰ <span class="arithmatex">\(2*(( \lceil n/2 \rceil )^{h-2}) * \lceil (n-1)/2 \rceil\)</span> ä¸ªèŠ‚ç‚¹ï¼Œæœ€å¤š <span class="arithmatex">\((n^{h-1}) * (n-1)\)</span> ä¸ªèŠ‚ç‚¹ï¼›</p>
</li>
<li>
<p>èŠ‚ç‚¹å¡«å……ç‡ï¼šéå¶å­èŠ‚ç‚¹éœ€æ»¡è¶³è‡³å°‘æœ‰ <span class="arithmatex">\(\lceil n/2 \rceil\)</span> åˆ° <span class="arithmatex">\(n\)</span> ä¸ªå­èŠ‚ç‚¹ï¼›</p>
</li>
<li>
<p>å¶å­èŠ‚ç‚¹é€šè¿‡æŒ‡é’ˆé“¾æ”¯æŒèŒƒå›´æŸ¥è¯¢ã€‚</p>
</li>
</ul>
<h4 id="b_2">B+æ ‘ç´¢å¼•çš„æ“ä½œ<a class="headerlink" href="#b_2" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong>æŸ¥è¯¢</strong>ï¼šä»æ ¹åˆ°å¶çš„è·¯å¾„æœç´¢(å¤æ‚åº¦ <span class="arithmatex">\(O(\log_{\lceil n/2 \rceil}K)\)</span> )</p>
</li>
<li>
<p><strong>æ’å…¥/åˆ é™¤</strong>ï¼šå¯èƒ½è§¦å‘èŠ‚ç‚¹åˆ†è£‚/åˆå¹¶ï¼Œå‘ä¸Šä¼ æ’­</p>
<p>æ’å…¥ä¹‹å‰å…ˆè¿›è¡Œæ’åºï¼Œæ¯”ä¹±åºæ’å…¥æ›´æ–°ç´¢å¼•çš„ä»£ä»·å°ï¼Œå°¤å…¶å¯¹äº B+æ ‘ç´¢å¼•è€Œè¨€ã€‚å¯¹ B+æ ‘ï¼Œæ‰¹é‡æ’å…¥è¿˜å¯ä»¥ç›´æ¥å»ºå¶èŠ‚ç‚¹ï¼Œç„¶åè‡ªå¶å‘æ ¹æ›´æ–°è€Œä¸æ˜¯ä»é¡¶è€Œä¸‹æ’å…¥ã€‚</p>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">B+æ ‘ä¸ä»…å¯ä»¥ä½œä¸ºè®°å½•çš„ç´¢å¼•ï¼Œè¿˜å¯ä»¥ä½œä¸ºæ–‡ä»¶çš„ç»“æ„ï¼Œå¶èŠ‚ç‚¹ä¸æ˜¯æŒ‡é’ˆè€Œæ˜¯è®°å½•æœ¬èº«å³å¯ã€‚</p>
</div>
<p>ä¸€ä¸ªé¡µä¸­å¯ä»¥å­˜æ”¾çš„ç´¢å¼•å¤§å°åº”è¯¥æ˜¯ï¼š</p>
<div class="arithmatex">\[
å•é¡µç´¢å¼•ä¸ªæ•° = \frac{é¡µå¤§å° - æŒ‡é’ˆå¤§å°}{ç´¢å¼•æ•°æ®å¤§å° + æŒ‡é’ˆå¤§å°} + 1
\]</div>
<h3 id="_18">å†…å­˜ç´¢å¼•ä¼˜åŒ–<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h3>
<p>å¯¹<strong>ç£ç›˜</strong>è€Œè¨€ï¼Œä¸ç£ç›˜é¡µå¤§å°ç›¸åŒ¹é…çš„ç´¢å¼•ç”¨èµ·æ¥æ›´å¿«ï¼›å› ä¸ºç£ç›˜ IO çš„æœ€å°å•ä½æ˜¯æ‰‡åŒºã€‚</p>
<p>è€Œå¯¹<strong>memory å’Œ cache</strong>è€Œè¨€ï¼ŒèŠ‚ç‚¹å¤§å°å°çš„ç”¨èµ·æ¥æ›´å¿«ï¼›å› ä¸ºéšæœºè®¿é—®æ€§èƒ½é«˜å¾—å¤šï¼Œä¹Ÿæ²¡æœ‰æ‰‡åŒºå¤§å°é™åˆ¶ã€‚</p>
<h3 id="_19">é«˜çº§ç´¢å¼•<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h3>
<p><strong>å¤šé”®ç´¢å¼•</strong></p>
<p>å¤åˆæœç´¢é”®éƒ½æ˜¯<strong>æŒ‰ç…§å­—å…¸åº(Lexicographic order)æ¥æ’åˆ—</strong>çš„ã€‚å¤šé”®å¤åˆç´¢å¼•å¯ä»¥é«˜æ•ˆåœ°æ”¯æŒå¤šæ¡ä»¶æŸ¥è¯¢ã€‚</p>
<details class="danger">
<summary>å­—å…¸åº</summary>
<p>å­—å…¸åºæ˜¯æŒ‡: <span class="arithmatex">\((a_1, a_2) &lt; (b_1, b_2)\)</span> if either</p>
<ul>
<li>
<p><span class="arithmatex">\(a_1 &lt; b_1\)</span>, or</p>
</li>
<li>
<p><span class="arithmatex">\(a_1 = b_1\)</span> and <span class="arithmatex">\(a_2 &lt; b_2\)</span></p>
</li>
</ul>
<p>å‡è®¾æˆ‘ä»¬æœ‰<code>(dept_name, salary)</code>ä½œä¸ºå¤åˆæœç´¢é”®ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥æœ‰æ•ˆå¤„ç†ï¼š</p>
<ul>
<li>
<p><code>where dept_name = "Finance" and salary = 80000</code></p>
</li>
<li>
<p><code>where dept_name = "Finance" and salary &lt; 80000</code></p>
</li>
</ul>
<p>è€Œä¸èƒ½æœ‰æ•ˆå¤„ç†</p>
<ul>
<li>
<p><code>where dept_name &lt; "Finance" and balance = 80000</code></p>
<p>è¿™ä¼šå¯¼è‡´è®¸å¤šåœ¨é€»è¾‘ä¸Šæ»¡è¶³ç¬¬ä¸€ä¸ªæ¡ä»¶ä½†æ˜¯ä¸æ»¡è¶³ç¬¬äºŒä¸ªæ¡ä»¶çš„è¡Œä¹Ÿè¢«é€‰ä¸­ã€‚</p>
</li>
</ul>
</details>
<h3 id="_20">å†™å…¥ä¼˜åŒ–ç´¢å¼•<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>LSM(Log Structured Merge)æ ‘</strong></p>
<p>å†…å­˜ç¼“å†²(L0) + å¤šå±‚ç£ç›˜åˆå¹¶(L1, L2...)ï¼Œå¤šçº§æ ‘å‹ç´¢å¼•åˆ†åˆ«æ”¾åœ¨ä¸åŒå±‚æ¬¡çš„å‚¨å­˜ä¸Š</p>
<ul>
<li>
<p>ä¼˜ç‚¹ï¼šå†™æ”¾å¤§ä½(é¡ºåº I/O)</p>
<p>ä¿è¯äº†å†™å…¥çš„é€Ÿåº¦(å…ˆå¾€æ›´å¿«çš„ mem å†™ï¼Œæ”’å¤Ÿä¸€å®šé‡åå†ä¸€æ¬¡æ€§å†™å…¥ disk)ï¼›å‡å°‘äº†ç£ç›˜çš„å†™å…¥é‡(å› ä¸ºç£ç›˜ IO çš„æœ€å°å•ä½æ˜¯æ‰‡åŒºï¼Œå•æ¬¡å¤§é‡å†™å…¥å¯¹ç£ç›˜çš„æ¶ˆè€—è¿œå°äºå¤šæ¬¡å°‘é‡å†™å…¥)</p>
</li>
<li>
<p>ç¼ºç‚¹ï¼šè¯»éœ€æŸ¥å¤šçº§(è¦åœ¨å¤šæ£µæ ‘é‡Œæ‰¾)</p>
<p>å¦‚æœæ¯ä¸€å±‚çº§å…è®¸åŒæ—¶å­˜åœ¨å¤šæ£µæ ‘ï¼Œç§°ä¸º<strong>Setpped-merge index</strong>ï¼Œè¿™ç§åšæ³•è¿›ä¸€æ­¥ç”¨ç¼–ç¨‹éš¾åº¦ã€ç©ºé—´å¤æ‚åº¦å’ŒæŸ¥è¯¢é€Ÿåº¦æ¢å†™é€Ÿåº¦ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>ç¼“å­˜æ ‘(Buffer Tree)</strong></p>
<p>å¯ä»¥æ›¿ä»£ LSM æ ‘ã€‚å…¶æ ¸å¿ƒç‚¹åœ¨äºï¼Œæ¯ä¸ªå†…éƒ¨èŠ‚ç‚¹éƒ½æœ‰ç¼“å†²å»ç¼“å†²å†™å…¥æ“ä½œï¼Œä¹‹åæ‰¹é‡ä¸‹æ¨ã€‚</p>
<ul>
<li>
<p>æ¯æ¡è®°å½•çš„ I/O æ“ä½œç›¸åº”å‡å°‘ï¼›æŸ¥è¯¢çš„å¼€æ”¯ä¹Ÿå‡å°‘äº†ã€‚Buffer Tree å¯ä»¥ç”¨äº<u>ä»»ä½•æ ‘ç»“æ„çš„ç´¢å¼•</u>ã€‚</p>
</li>
<li>
<p>ä½†æ˜¯ç›¸å¯¹äº LSM æ ‘å¢åŠ äº†éšæœº I/O</p>
</li>
</ul>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>è¯¾ç¨‹ PPT å°† B æ ‘ç´¢å¼•ã€å“ˆå¸Œç´¢å¼•ç­‰ä¸€æ¦‚éšè—äº†ï¼Œè¿™é‡Œå°±ä¸æ”¾äº†ï¼Œæ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥å»çœ‹æ•™æã€‚</p>
</div>
<hr />
<h2 id="_21">æŸ¥è¯¢å¤„ç†<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h2>
<p>åŸºæœ¬çš„æŸ¥è¯¢æµç¨‹å¦‚ä¸‹ï¼š</p>
<p>è§£æä¸ç¿»è¯‘ -&gt; ä¼˜åŒ– -&gt; æ‰§è¡Œ</p>
<div align="center">    
<img src="../images/DB/db24.png" alt="query_steps" style="zoom :80%;" />
</div>

<p>è¡¡é‡æŸ¥è¯¢å¼€é”€çš„ä¸»è¦æŒ‡æ ‡æœ‰ï¼š<strong>ç£ç›˜è®¿é—®æ—¶é—´</strong>ã€<strong>CPU å»¶è¿Ÿ</strong>ã€ç½‘ç»œè¿æ¥ç­‰ç­‰ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œç£ç›˜è®¿é—®æ˜¯ä¸»è¦çš„æ€§èƒ½å¼€é”€é¡¹ï¼Œå…¶æˆæœ¬ä¹Ÿç›¸å¯¹å®¹æ˜“ä¼°ç®—ã€‚è¿™ä¸€é¡¹å¯ä»¥é€šè¿‡ä»¥ä¸‹æŒ‡æ ‡è¿›è¡Œé‡åŒ–è®¡ç®—ï¼š</p>
<ul>
<li>
<p>å¯»é“(seek)æ¬¡æ•° Ã— å¹³å‡å•æ¬¡å¯»é“æˆæœ¬</p>
</li>
<li>
<p>è¯»å–çš„ç£ç›˜å—æ•° Ã— å¹³å‡å•å—è¯»å–æˆæœ¬</p>
</li>
<li>
<p>å†™å…¥çš„ç£ç›˜å—æ•° Ã— å¹³å‡å•å—å†™å…¥æˆæœ¬</p>
</li>
</ul>
<p>ç®€åŒ–èµ·è§ï¼Œæˆ‘ä»¬æœ¬ç« åªä½¿ç”¨<strong>å—ä¼ è¾“æ¬¡æ•°(number of block transfers)</strong>å’Œ<strong>å¯»é“æ¬¡æ•°(number of seeks)</strong>ä½œä¸ºå¼€é”€çš„è¡¡é‡ã€‚</p>
<div class="arithmatex">\[
\mathrm{ T_{cost} = b \times t_T + S \times t_s }
\]</div>
<p>ä¸Šå¼ä¸­ï¼Œ<span class="arithmatex">\(t_T\)</span> æŒ‡å•å—ä¼ è¾“æ—¶é—´ï¼Œ<span class="arithmatex">\(t_s\)</span> æŒ‡å•æ¬¡å¯»é“æ—¶é—´ã€‚è¿™ä¸¤ä¸ªæŒ‡æ ‡å–å†³äºæ•°æ®åœ¨å“ªé‡Œå­˜å‚¨ã€‚ç»éªŒä¸Šçœ‹ï¼Œå‡è®¾ä¸€ä¸ªå—çš„å¤§å°ä¸º 4KB ï¼š</p>
<ul>
<li>
<p>High end magnetic disk: <span class="arithmatex">\(t_S\)</span> = 4 ms and <span class="arithmatex">\(t_T\)</span> = 0.1 ms</p>
</li>
<li>
<p>SSD: <span class="arithmatex">\(t_S\)</span> = 20-90 <span class="arithmatex">\(\mu s\)</span> and <span class="arithmatex">\(t_T\)</span> = 2-10 <span class="arithmatex">\(\mu s\)</span> for 4KB</p>
</li>
</ul>
<h3 id="selection">é€‰æ‹©(Selection)æ“ä½œ<a class="headerlink" href="#selection" title="Permanent link">&para;</a></h3>
<p>é’ˆå¯¹é€‰æ‹©æ“ä½œ(<code>select</code>)çš„ç®—æ³•ä¸»è¦æœ‰ä¸¤ç±»ï¼šç›´æ¥å¯¹æ–‡ä»¶çš„çº¿æ€§(linear)æ‰«æå’Œä½¿ç”¨ç´¢å¼•çš„ç´¢å¼•(index)æ‰«æã€‚</p>
<ul>
<li>
<p>çº¿æ€§æ‰«æ(A1)</p>
<p>æ‰«ææ¯ä¸ªæ–‡ä»¶å—ï¼Œå¹¶é€æ¡æµ‹è¯•è®°å½•ï¼Œçœ‹å…¶æ˜¯å¦æ»¡è¶³é€‰æ‹©çš„æ¡ä»¶ã€‚</p>
<ul>
<li>ç”¨ <span class="arithmatex">\(b_r\)</span> æè¿°å­˜å‚¨äº†å…³ç³» <span class="arithmatex">\(r\)</span> è®°å½•çš„å—çš„æ•°é‡ã€‚å‡è®¾æ–‡ä»¶è¿ç»­å­˜å‚¨ï¼Œé‚£ä¹ˆä¸€æ¬¡çº¿æ€§æ‰«æå°±éœ€è¦ </li>
</ul>
<div class="arithmatex">\[
\mathrm{b_r \times t_T + 1 \times t_s}
\]</div>
<p>çš„æ—¶é—´ã€‚</p>
<ul>
<li>
<p>å¦‚æœé€‰æ‹©æ˜¯åŸºäºæŸä¸ªé”®çš„ï¼Œæ‰¾åˆ°ç›®æ ‡è®°å½•åå³å¯ç»ˆæ­¢æŸ¥è¯¢ã€‚æ­¤æ—¶ï¼Œ<strong>å¹³å‡æ¥çœ‹</strong>å—ä¼ è¾“çš„æ¬¡æ•°å°±ä¼šé™åˆ° <span class="arithmatex">\(b_r / 2\)</span>ã€‚</p>
</li>
<li>
<p>çº¿æ€§æœç´¢å¯é€‚ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š</p>
<ul>
<li>
<p>ä»»æ„é€‰æ‹©æ¡ä»¶</p>
</li>
<li>
<p>æ–‡ä»¶è®°å½•æ— åºå­˜å‚¨</p>
</li>
<li>
<p>æ— ç´¢å¼•å¯ç”¨</p>
</li>
</ul>
</li>
</ul>
<details class="tip">
<summary>Tip</summary>
<ul>
<li>
<p>äºŒåˆ†æœç´¢é€šå¸¸ä¸é€‚ç”¨ï¼Œå› ä¸ºæ•°æ®ç‰©ç†å­˜å‚¨ä¸è¿ç»­(é™¤éå­˜åœ¨ç´¢å¼•)</p>
</li>
<li>
<p>äºŒåˆ†æœç´¢çš„å¯»é“æ¬¡æ•°é€šå¸¸é«˜äºç´¢å¼•æ‰«æ</p>
</li>
</ul>
</details>
</li>
<li>
<p>ç´¢å¼•æ‰«æ</p>
<p>æ³¨æ„ï¼Œåœ¨ä¸‹é¢çš„è®¨è®ºä¸­ï¼Œ<span class="arithmatex">\(h_i\)</span> æ€»æ˜¯è¡¨ç¤ºç´¢å¼•çš„å±‚æ•°ã€‚</p>
<ul>
<li>
<p>ç­‰å€¼æŸ¥è¯¢</p>
<ul>
<li>
<p>A2(ä¸»ç´¢å¼• + åŸºäºä¸»é”®çš„ç­‰å€¼æŸ¥è¯¢) </p>
<p>è·å¾—å•æ¡ç¬¦åˆæ¡ä»¶çš„è®°å½•ã€‚</p>
<div class="arithmatex">\[
\mathrm{Cost = (h_i + 1) * (t_T + t_s)}
\]</div>
</li>
<li>
<p>A3(ä¸»ç´¢å¼• + åŸºäºéä¸»é”®çš„ç­‰å€¼æŸ¥è¯¢)</p>
<p>è·å¾—å¤šæ¡ç¬¦åˆæ¡ä»¶çš„è®°å½•ã€‚ç”¨ <span class="arithmatex">\(b\)</span> è¡¨ç¤ºå­˜æœ‰ç¬¦åˆæ¡ä»¶çš„è®°å½•çš„å—çš„æ•°é‡ï¼Œ</p>
<div class="arithmatex">\[
\mathrm{Cost = h_i * (t_T + t_s) + t_s + t_T \times b}
\]</div>
</li>
<li>
<p>A4(äºŒçº§ç´¢å¼• + åŸºäºéä¸»é”®çš„ç­‰å€¼æŸ¥è¯¢)</p>
<p>å¦‚æœæœç´¢é”®æ˜¯å€™é€‰é”®ï¼Œé‚£ä¹ˆå¯ä»¥å¾—åˆ°å•ä¸€çš„è®°å½•ã€‚</p>
<div class="arithmatex">\[
\mathrm{Cost = (h_i + 1) * (t_T + t_s)}
\]</div>
<p>å¦‚æœæœç´¢é”®ä¸æ˜¯å€™é€‰é”®ï¼Œé‚£ä¹ˆä¼šå¾—åˆ°å¤šæ¡è®°å½•ã€‚å‡å¦‚ä¸€å…±æœ‰ n æ¡ç¬¦åˆè¦æ±‚çš„è®°å½•ï¼Œè¿™äº›è®°å½•å¯èƒ½åˆ†å¸ƒåœ¨ä¸åŒçš„å—ä¸Šï¼Œå› è€Œå¼€é”€å¯èƒ½ä¼šå˜å¾—å¾ˆé«˜ï¼š</p>
<div class="arithmatex">\[
\mathrm{Cost = (h_i + n) * (t_T + t_s)}
\]</div>
</li>
</ul>
</li>
<li>
<p>æ¯”è¾ƒæ¡ä»¶æŸ¥è¯¢</p>
<p>æ¯”è¾ƒæ¡ä»¶æŸ¥è¯¢(<span class="arithmatex">\(\sigma_{A \leq V}(r)\)</span> æˆ–è€… <span class="arithmatex">\(\sigma_{A \geq V}(r)\)</span>)å¯ä»¥ä½¿ç”¨å‰é¢çš„çº¿æ€§æ‰«æå®Œæˆï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ç®—æ³•ï¼š</p>
<ul>
<li>
<p>A5(ä¸»ç´¢å¼•)ï¼Œå…³ç³»å·²ç»æŒ‰ç…§å±æ€§ A æ’åº</p>
<ul>
<li>
<p>å¯¹äº <span class="arithmatex">\(\sigma_{A \geq V}(r)\)</span>ï¼Œæˆ‘ä»¬ç”¨ç´¢å¼•æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³ <span class="arithmatex">\(\geq V\)</span> å…³ç³»çš„å…ƒç»„ï¼Œç„¶åä»è¿™é‡Œé¡ºåºæ‰«æå…³ç³»å³å¯ï¼›</p>
</li>
<li>
<p>å¯¹äº <span class="arithmatex">\(\sigma_{A \leq V}(r)\)</span>ï¼Œæˆ‘ä»¬ç”šè‡³ä¸éœ€è¦ç´¢å¼•ï¼Œåªéœ€è¦ä»å…³ç³»çš„å¼€å¤´é¡ºåºæ‰«æï¼Œç›´åˆ°é‡è§ç¬¬ä¸€ä¸ª <span class="arithmatex">\(&gt; V\)</span> çš„å…ƒç»„å³å¯ã€‚</p>
</li>
</ul>
</li>
<li>
<p>A6(äºŒçº§ç´¢å¼•)</p>
<ul>
<li>
<p>å¯¹äº <span class="arithmatex">\(\sigma_{A \geq V}(r)\)</span>ï¼š</p>
<ul>
<li>
<p>é€šè¿‡ç´¢å¼•å®šä½åˆ°é¦–ä¸ª <span class="arithmatex">\(\geq V\)</span> çš„ç´¢å¼•é¡¹</p>
</li>
<li>
<p>é¡ºåºæ‰«æåç»­ç´¢å¼•æ¡ç›®ï¼Œè·å–æŒ‡å‘æ•°æ®è®°å½•çš„æŒ‡é’ˆ</p>
</li>
</ul>
</li>
<li>
<p>å¯¹äº <span class="arithmatex">\(\sigma_{A \leq V}(r)\)</span>ï¼š</p>
<p>ç›´æ¥æ‰«æç´¢å¼•å¶å­é¡µï¼Œè·å–æŒ‡é’ˆç›´åˆ°å‡ºç°é¦–ä¸ª <span class="arithmatex">\(&gt; V\)</span> çš„æ¡ç›®</p>
</li>
</ul>
</li>
</ul>
<p>ä¸Šè¿°ä¸¤ç§ç®—æ³•ï¼š</p>
<ul>
<li>
<p>å…±åŒæ“ä½œï¼šæ ¹æ®æŒ‡é’ˆé€æ¡è¯»å–å¯¹åº”æ•°æ®è®°å½•</p>
</li>
<li>
<p>ä»£ä»·ç‰¹æ€§ï¼šæ¯æ¡è®°å½•éœ€å•ç‹¬ I/O æ“ä½œ</p>
</li>
<li>
<p>å½“æ»¡è¶³æ¡ä»¶çš„è®°å½•è¿‡å¤šæ—¶ï¼Œçº¿æ€§å…¨è¡¨æ‰«æå¯èƒ½æ›´é«˜æ•ˆ</p>
<details class="tip">
<summary>æ¨å¯¼</summary>
</details>
</li>
</ul>
</li>
<li>
<p>å¤æ‚æ¡ä»¶æŸ¥è¯¢ï¼šå¤šæ¡ä»¶åˆå–æŸ¥è¯¢(<span class="arithmatex">\(\sigma_{\theta_1 \land \theta_2 \land ... \land \theta_n}(r)\)</span>)</p>
<ul>
<li>
<p>A7(ä½¿ç”¨å•ç´¢å¼•)</p>
</li>
<li>
<p>A8(ä½¿ç”¨å¤åˆç´¢å¼•)</p>
</li>
<li>
<p>A9(ä½¿ç”¨æŒ‡é’ˆäº¤é›† [intersection of identifiers])</p>
</li>
</ul>
</li>
<li>
<p>å¤æ‚æ¡ä»¶æŸ¥è¯¢ï¼šå¤šæ¡ä»¶æå–æŸ¥è¯¢(<span class="arithmatex">\(\sigma_{\theta_1 \vee \theta_2 \vee ... \vee \theta_n}(r)\)</span>)</p>
<ul>
<li>A10(ä½¿ç”¨æŒ‡é’ˆå¹¶é›† [union of identifiers])</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>A1-A6 æ€»ç»“ï¼š</p>
<div align="center">    
<img src="../images/DB/db25.png" alt="seek_algorithms" style="zoom :80%;" />
</div>

<h3 id="sorting">æ’åº(Sorting)<a class="headerlink" href="#sorting" title="Permanent link">&para;</a></h3>
<p>ä»ä¸Šé¢ä¸€èŠ‚ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œåœ¨é€‰æ‹©æ“ä½œæ—¶æˆ‘ä»¬å¯èƒ½ä¼šé’ˆå¯¹å…³ç³»æ„å»ºç´¢å¼•ï¼Œç„¶åç”¨æœ‰é¡ºåºçš„ç´¢å¼•å»è¯»å–å…³ç³»ã€‚</p>
<p>å¦‚æœ memory å¯ä»¥å®¹çº³ç›®æ ‡å…³ç³»ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨è¯¸å¦‚å¿«é€Ÿæ’åºçš„æŠ€å·§ã€‚ä½†æ˜¯ï¼Œå®é™…æƒ…å†µå¾€å¾€æ˜¯ä¸€ä¸ªå…³ç³»çš„å¤§å°ä¸èƒ½è¢« memory å®¹çº³ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦<strong>å¤–éƒ¨å½’å¹¶æ’åº(external sort-merge)</strong>ã€‚è¿˜è®°ä¸è®°å¾— ADS è¯¾ç¨‹ä¸­çš„è®²è§£ï¼Ÿ</p>
<p>å¤–éƒ¨å½’å¹¶æ’åºæµç¨‹ï¼Œåˆ†æ²»ï¼š</p>
<div align="center">    
<img src="../images/DB/db26.png" alt="merge_sort" style="zoom :80%;" />
</div>

<ul>
<li>
<p><strong>Step 1 (åˆå§‹åŒ–)</strong>  </p>
<p>æ¯æ¬¡è¯»å…¥ M ä¸ªå—åˆ°å†…å­˜ä¸­ï¼Œå¹¶åœ¨å†…å­˜ä¸­è¿›è¡Œæ’åºï¼Œè®°ä¸ºä¸€ä¸ª run <span class="arithmatex">\(R_{i}\)</span>ï¼Œç„¶åå†™å›ç£ç›˜ã€‚è®¾å®Œæˆåˆå§‹åŒ–åå¾—åˆ°çš„ runs æ€»ä¸ªæ•°ä¸º <span class="arithmatex">\(N_{0}\)</span>ã€‚</p>
</li>
<li>
<p><strong>Step 2 (å½’å¹¶)</strong></p>
<ul>
<li>
<p>å¦‚æœ <span class="arithmatex">\(N_{0} &lt; M\)</span>ï¼š  å¯ä»¥åˆ†é… <span class="arithmatex">\(N_{0}\)</span> ä¸ªå—ç”¨äºå½’å¹¶ï¼Œå†ç”¨ä¸€ä¸ªå—ä½œä¸ºè¾“å‡ºç¼“å†²åŒºã€‚</p>
</li>
<li>
<p>å¦‚æœ <span class="arithmatex">\(N_{0} \geq M\)</span>ï¼šéœ€è¦è¿›è¡Œé€’å½’åˆå¹¶ï¼Œåœ¨æ¯ä¸€è½®ä¸­ï¼Œå¯åˆå¹¶è¿ç»­çš„ <span class="arithmatex">\(M-1\)</span> ä¸ª runs ï¼Œå¹¶è®© runs çš„æ€»æ•°é‡å˜ä¸º <span class="arithmatex">\(\lceil N/(M-1) \rceil\)</span>ï¼Œé€’å½’ç›´åˆ°æ‰€æœ‰ runs åˆå¹¶ä¸ºä¸€ä¸ªã€‚</p>
</li>
</ul>
</li>
</ul>
<p>ç»“è®ºé€Ÿé€šï¼š(M æŒ‡æ”¾è¿›å†…å­˜ä¸­çš„å—çš„æ•°é‡ï¼Œ<span class="arithmatex">\(b_r\)</span> å®šä¹‰åŒå‰)</p>
<ul>
<li>
<p><strong>runs</strong>æ€»æ•°ï¼š<span class="arithmatex">\(\lceil b_r / M \rceil\)</span></p>
</li>
<li>
<p>éœ€è¦çš„<strong>passes</strong>æ•°ï¼š<span class="arithmatex">\(\lceil \log_{M-1}{(b_r / M)} \rceil\)</span></p>
</li>
</ul>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œä¸€ä¸ªå—åœ¨è¿›è¡Œæ’åºçš„æ—¶å€™ä¼šäº§ç”Ÿä¸¤æ¬¡å—ä¼ è¾“ï¼Œå› ä¸ºè¦è¿›å…¥å†…å­˜ã€ä»å†…å­˜å–å‡ºã€‚æ‰€ä»¥ï¼Œæ¯ä¸€ä¸ª pass éƒ½ä¼šäº§ç”Ÿ <span class="arithmatex">\(2b_r\)</span> çš„å—ä¼ è¾“ã€‚æˆ‘ä»¬ä¸è€ƒè™‘æœ€åä¸€æ¬¡ pass çš„å†™ç›˜å¼€é”€ï¼Œå› ä¸ºä¸€ä¸ªæ“ä½œçš„æœ€ç»ˆç»“æœå¯èƒ½ä¼šè¢«ç›´æ¥ä¼ ç»™çˆ¶æ“ä½œï¼Œä¸ä¸€å®šä¼šå†™åˆ°ç›˜ä¸­ã€‚æ‰€ä»¥ï¼Œé‡‡ç”¨å½’å¹¶çš„<strong>å¤–éƒ¨æ’åºçš„å—ä¼ è¾“æ€»é‡</strong>æ˜¯</p>
<div class="arithmatex">\[
b_r (2\lceil \log_{M-1}{(b_r / M)}\rceil - 1) \to O (b_r \log b_r)
\]</div>
<p>æ¯ä¸€ä¸ª pass ä¹Ÿéœ€è¦ <span class="arithmatex">\(2b_r\)</span> æ¬¡å¯»é“ã€‚æ­¤å¤–ï¼Œåœ¨ç”Ÿæˆ runs çš„æ—¶å€™ï¼Œå¯¹äºæ¯ä¸ª run ï¼Œç£ç›˜éœ€è¦ä¸€æ¬¡å¯»é“æ¥è¯» run ï¼Œä¸€æ¬¡å¯»é“æ¥å†™ runã€‚å› æ­¤é‡‡ç”¨å½’å¹¶çš„<strong>å¤–éƒ¨æ’åºçš„å¯»é“æ€»æ•°</strong>æ˜¯</p>
<div class="arithmatex">\[
2\lceil b_r / M \rceil + b_r (2\lceil \log_{M-1}{(b_r / M)}\rceil - 1)
\]</div>
<ul>
<li>
<p>å­˜å‚¨ä¼˜åŒ–</p>
<ul>
<li>
<p><strong>Motivation</strong>  </p>
<p>ä¸ºäº†è¿›ä¸€æ­¥å‡å°‘å¯»é“æˆæœ¬ï¼Œå°†è¾“å…¥å’Œè¾“å‡ºç¼“å†²åŒºçš„å¤§å°éƒ½è®¾ç½®ä¸º <span class="arithmatex">\(b_{b}\)</span> ä¸ªå—ï¼Œè¿™æ ·å†…å­˜ä¸­å°±åªèƒ½æ”¾ä¸‹ <span class="arithmatex">\(\lfloor M/b_{b}\rfloor\)</span> ä¸ª runs äº†ã€‚</p>
</li>
<li>
<p><strong>block-transfer</strong>  </p>
<p>å…± <span class="arithmatex">\(b_{r}(2\lceil\log_{\lfloor M/b_{b}\rfloor-1}(b_{r}/M)\rceil+1)\)</span> æ¬¡ã€‚</p>
</li>
<li>
<p><strong>seek</strong>  </p>
<p>å…± <span class="arithmatex">\(2\lceil b_{r}/M\rceil + \lceil b_{r}/b_{b}\rceil(2\lceil\log_{\lfloor M/b_{b}\rfloor-1}(b_{r}/M)\rceil-1)\)</span> æ¬¡ã€‚</p>
</li>
</ul>
</li>
</ul>
<h3 id="join">è¿æ¥(Join)<a class="headerlink" href="#join" title="Permanent link">&para;</a></h3>
<p>æˆ‘ä»¬æœ‰å¤šç§æ–¹å¼æ¥å®ç°è¿æ¥æ“ä½œã€‚</p>
<h4 id="nested-loop-join"><strong>Nested-Loop Join</strong><a class="headerlink" href="#nested-loop-join" title="Permanent link">&para;</a></h4>
<p>ä¸€èˆ¬æ¥è¯´å°±æ˜¯ï¼Œä¸ºäº†è®¡ç®— <span class="arithmatex">\(\theta\)</span> - join <span class="arithmatex">\(r \bowtie_{\theta} s\)</span> (æ­¤æ—¶ç§° <span class="arithmatex">\(r\)</span> ä¸º<strong>å¤–å…³ç³»(outer relation)</strong>ï¼Œ<span class="arithmatex">\(s\)</span> ä¸º<strong>å†…å…³ç³»(inner relation)</strong>)ï¼š</p>
<div align="center">    
<img src="../images/DB/db27.png" alt="nestedloop_algo" style="zoom: 90%"/>
</div>

<ul>
<li>
<p>ä¸éœ€è¦ç´¢å¼•ï¼Œä»£ä»·æ˜¯æ—¶é—´å¼€é”€å¤§ï¼Œå¯¹äºæ¯ä¸€å¯¹å…ƒç»„éƒ½éœ€è¦æ£€æŸ¥ã€‚</p>
</li>
<li>
<p>æœ€åæƒ…å†µä¸‹ï¼Œå†…å­˜åªèƒ½å®¹çº³ä¸¤ä¸ªå…³ç³»ä¸­çš„å„ä¸€ä¸ªå—ã€‚æ­¤æ—¶å¼€é”€ä¸º <span class="arithmatex">\((n_r + b_r) \times t_s + (n_r \times b_s + b_r) \times t_T\)</span>ã€‚</p>
<ul>
<li>
<p>å› ä¸ºæ¯è½®éƒ½éœ€è¦é‡æ–°å¯»é“ï¼Œå¤–å…³ç³»éå†éœ€è¦ <span class="arithmatex">\(b_r \times (t_s + t_T)\)</span></p>
</li>
<li>
<p>å¯¹äº <span class="arithmatex">\(n_r\)</span> ä¸ªå¤–å…³ç³»å…ƒç»„ä¸­çš„æ¯ä¸€ä¸ªï¼Œéƒ½éœ€è¦å¯¹å†…å…³ç³»åšä¸€æ¬¡æ‰«æï¼Œå…±èŠ±è´¹ <span class="arithmatex">\(n_r \times (t_s + b_s \times t_T)\)</span>ã€‚</p>
</li>
</ul>
</li>
<li>
<p>å¦‚æœå†…å…³ç³»å¯ä»¥å®Œå…¨æ”¾è¿›å†…å­˜ï¼Œå¼€é”€å³å¯é™ä½ä¸º <span class="arithmatex">\(2 \times t_s + (b_s + b_r) \times t_T\)</span>ã€‚</p>
<p>å³åœ¨ä¸€å¼€å§‹å…ˆç”¨ <span class="arithmatex">\(t_s + b_s\times t_T\)</span> çš„æ—¶é—´å°†å†…å…³ç³»å…¨éƒ¨è¯»è¿›å†…å­˜ã€‚</p>
</li>
</ul>
<h4 id="block-nested-loop-join"><strong>Block Nested-Loop Join</strong><a class="headerlink" href="#block-nested-loop-join" title="Permanent link">&para;</a></h4>
<p>å’Œ Nested-Loop Join ç›¸ä¼¼ï¼Œä½†æ˜¯ä»å®ç°ä¸Šçœ‹ï¼Œå†…å¤–å…³ç³»å˜æˆäº†å¯¹åº”å…³ç³»çš„ block ï¼Œä» block ä¸­å†æå–å…ƒç»„ã€‚</p>
<div align="center">    
<img src="../images/DB/db28.png" alt="block_nestedloop_algo" style="zoom: 80%"/>
</div>

<ul>
<li>
<p>æœ€åæƒ…å†µçš„å¼€é”€ </p>
<p><span class="arithmatex">\(2b_{r} \times t_{S} + (b_{r} \times b_{s}) \times t_{T}\)</span></p>
</li>
<li>
<p>å†…å­˜ä¼˜åŒ–æ–¹æ¡ˆ</p>
<p>ä½¿ç”¨å†…å­˜ä¸­çš„ <span class="arithmatex">\(M-2\)</span> ä¸ªå—å‚¨å­˜å¤–å…³ç³»ï¼Œæˆæœ¬å¯é™ä½ä¸ºï¼š  <span class="arithmatex">\(2\lceil b_{r}/(M-2)\rceil \times t_{S} + (\lceil b_{r}/(M-2)\rceil \times b_{s} + b_{r}) \times t_{T}\)</span></p>
<ul>
<li>
<p><span class="arithmatex">\(M-2\)</span> ä¸ªå—ç”¨äºå­˜å‚¨å¤–å…³ç³»ï¼Œä¸€ä¸ªå—ç”¨äºå­˜å‚¨å†…å…³ç³»ï¼Œ ä¸€ä¸ªå—ç”¨äºç»“æœè¾“å‡ºã€‚</p>
</li>
<li>
<p>å…·ä½“æ¥è¯´ï¼Œæ¯è½®å–å‡º <span class="arithmatex">\(M-2\)</span> ä¸ªå—å¤„ç†ï¼Œå¤„ç†å¼€é”€æ˜¯ <span class="arithmatex">\(2 \times t_{s} + (b_{s} + b_{r,i}) \times t_{T}\)</span>ï¼Œå…¶ä¸­ <span class="arithmatex">\(\sum b_{r,i} = b_{r}\)</span>ã€‚æ¯æ¬¡éƒ½éœ€è¦é‡æ–°å¯»é“</p>
</li>
</ul>
</li>
<li>
<p>æœ€å¥½æƒ…å†µ</p>
<p><span class="arithmatex">\(2 \times t_{S} + (b_{r} + b_{s}) \times t_{T}\)</span></p>
</li>
<li>
<p>å…³é”®ç»“è®º</p>
<ol>
<li>
<p>æ‰«æç­–ç•¥ä¼˜åŒ–ï¼šäº¤æ›¿è¿›è¡Œå‘å‰/å‘åå¾ªç¯ï¼Œå……åˆ†åˆ©ç”¨ç¼“å†²åŒºä¸­çš„å‰©ä½™å—</p>
</li>
<li>
<p>å…³ç³»é€‰æ‹©åŸåˆ™ï¼šè‹¥ä¸¤ä¸ªå…³ç³»éƒ½ä¸èƒ½å®Œå…¨æ”¾å…¥å†…å­˜ï¼Œå°†å°å…³ç³»ä½œä¸ºå¤–å…³ç³»çš„æ•ˆç‡æ›´é«˜</p>
</li>
</ol>
</li>
</ul>
<h4 id="indexed-nested-loop-join"><strong>Indexed Nested-Loop Join</strong><a class="headerlink" href="#indexed-nested-loop-join" title="Permanent link">&para;</a></h4>
<p>å¦‚æœ</p>
<p><strong>(1)</strong> è¿æ¥æ˜¯ç­‰å€¼è¿æ¥æˆ–è€…è‡ªç„¶è¿æ¥ï¼›æˆ–è€…</p>
<p><strong>(2)</strong> å†…å…³ç³»çš„è¿æ¥å±æ€§ä¸Šæœ‰ç´¢å¼•(ä¹Ÿå¯ä»¥ä¸“é—¨ä¸ºè¿æ¥æ“ä½œè€Œå»ºç«‹)ï¼Œ</p>
<p>æˆ‘ä»¬å°±å¯ä»¥ç”¨ index lookup æ›¿æ¢ file scanã€‚</p>
<ul>
<li>
<p>æœ€åæƒ…å†µä¸‹ï¼Œç¼“å†²åŒºä»…èƒ½å®¹çº³ <span class="arithmatex">\(r\)</span> çš„ä¸€ä¸ªå—ï¼Œå¹¶ä¸”å¯¹äº <span class="arithmatex">\(r\)</span> ä¸­çš„æ¯ä¸ªå…ƒç»„éƒ½éœ€è¦åœ¨ <span class="arithmatex">\(s\)</span> ä¸Šè¿›è¡Œä¸€æ¬¡ç´¢å¼•æŸ¥æ‰¾ã€‚</p>
</li>
<li>
<p>å¼€é”€ä¸º <span class="arithmatex">\(b_r(t_T + t_s) + n_r \times c\)</span>ï¼Œå…¶ä¸­ <span class="arithmatex">\(c\)</span> æ˜¯ä½¿ç”¨è¿æ¥æ¡ä»¶è¿›è¡Œç´¢å¼•æŸ¥æ‰¾çš„ä»£ä»·ã€‚</p>
</li>
</ul>
<h4 id="merge-join">Merge Join<a class="headerlink" href="#merge-join" title="Permanent link">&para;</a></h4>
<p>è‹¥ä¸¤ä¸ªå…³ç³»éƒ½å·²ç»æ’åºï¼Œåˆ™å¯ä½¿ç”¨ç±»ä¼¼å½’å¹¶æ’åºçš„æ–¹æ³•è®¡ç®—è¿æ¥ï¼å¦‚æœå…³ç³»æœªæ’åºåˆ™éœ€åŠ ä¸Šäº‹å…ˆæ’åºçš„ä»£ä»·ã€‚</p>
<div class="admonition danger">
<p class="admonition-title">åˆå¹¶è¿æ¥ä»…å¯ç”¨äºç­‰å€¼è¿æ¥å’Œè‡ªç„¶è¿æ¥ï¼</p>
</div>
<p>è®¾ç³»ç»Ÿåˆ†åˆ«ä¸º <span class="arithmatex">\(r\)</span> å’Œ <span class="arithmatex">\(s\)</span> åˆ†é…äº† M ä¸ªå—ä¸­çš„ <span class="arithmatex">\(x_r\)</span> å’Œ <span class="arithmatex">\(x_s\)</span> ä¸ªå—(ä¿è¯ <span class="arithmatex">\(x_r + x_s = M\)</span> )ï¼Œåˆ™å¼€é”€ä¸º</p>
<div class="arithmatex">\[
(\lceil b_r / x_r \rceil + \lceil b_s / x_s \rceil) \times t_s + (b_r + b_s) \times t_T
\]</div>
<h4 id="hash-join">Hash Join<a class="headerlink" href="#hash-join" title="Permanent link">&para;</a></h4>
<p>æœ¬è´¨ä¸Šæ˜¯ä¸€ç§<strong>åˆ†æ²»</strong>çš„æ€æƒ³ï¼å“ˆå¸Œè¿æ¥ç®—æ³•æµç¨‹å¤§è‡´æ˜¯ï¼š</p>
<ul>
<li>
<p>Partition ï¼šé€šè¿‡å“ˆå¸Œå‡½æ•°å°†å…³ç³» <span class="arithmatex">\(r\)</span> å’Œ <span class="arithmatex">\(s\)</span> åˆ†åŒºå¹¶æ˜ å°„åˆ° <span class="arithmatex">\(\{0, 1, â€¦, n_h\}\)</span> ä¸Šï¼Œå¹¶å†™å›ç£ç›˜ã€‚</p>
</li>
<li>
<p>Build &amp; Probe ï¼šå¯¹äº <span class="arithmatex">\(s\)</span> çš„æ¯ä¸ªåˆ†åŒº <span class="arithmatex">\(s_i\)</span>ï¼Œå°†å…¶å…¨éƒ¨è½½å…¥å†…å­˜ä¸­ï¼Œå¹¶éå† <span class="arithmatex">\(r_i\)</span> ä¸­çš„æ¯ä¸ªå—ä¾æ¬¡è½½å…¥å†…å­˜ï¼Œè¿›è¡Œè¿æ¥ã€‚</p>
</li>
</ul>
<p>ä¸ºäº†ç¡®ä¿ <span class="arithmatex">\(s\)</span> ä¸­çš„æ¯ä¸ªåˆ†åŒºéƒ½èƒ½è¢«è½½å…¥åˆ°å†…å­˜ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä»¤å“ˆå¸Œè¡¨å®¹é‡ <span class="arithmatex">\(n_h \geq \lceil b_s / M \rceil \times f\)</span>ï¼Œ<span class="arithmatex">\(f\)</span> æ˜¯ <strong>fudge factor</strong>ï¼Œä¸€èˆ¬å– 1.2ã€‚<span class="arithmatex">\(f\)</span> çš„é€‰æ‹©åŠ¨æœºåœ¨äºå“ˆå¸Œå‡½æ•°å†³å®šä¸‹çš„åˆ†åŒºä¸ä¸€å®šæ˜¯å‡åŒ€çš„ã€‚<span class="arithmatex">\(r\)</span> ä¸­çš„åˆ†åŒºä¸éœ€è¦ä¸€å¼€å§‹å°±è½½å…¥å†…å­˜ï¼Œæ‰€ä»¥ä¸å½±å“å®¹é‡çš„ä¸‹ç•Œã€‚</p>
<p>åŒæ—¶ï¼Œä¸ºäº†é¿å…è¿›è¡Œ<strong>é€’å½’åˆ†åŒº(recursive partitioning)</strong>ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¹Ÿè¦æ±‚ <span class="arithmatex">\(n_h &lt; M - 1\)</span>ã€‚è¿™ä¹Ÿæ˜¯å®¹é‡çš„ä¸Šç•Œã€‚</p>
<p>æ ¹æ®ä¸Šè¿°ç•Œå®šï¼Œæˆ‘ä»¬ç»è¿‡æ•°å­¦è¿ç®—å¯çŸ¥ï¼Œ<span class="arithmatex">\(M &gt; \sqrt{b_s}\)</span>ã€‚</p>
<div class="admonition exercise">
<p class="admonition-title">åœ¨ä¸è¿›è¡Œé€’å½’åˆ†åŒºçš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨å“ˆå¸Œè¿æ¥æœ€å¤šèƒ½å¤„ç†å¤šå¤§çš„ relation ï¼Ÿ</p>
<p>å¯¹äº 12M å†…å­˜ï¼Œå—å¤§å°è®¾ç½®ä¸º 4K ï¼åˆ™å†…å­˜ä¸­æœ€å¤šå¯æ”¾ä¸‹ 3K (= 12M / 4K) ä¸ªå—ï¼Œå¯å¯¹æœ€å¤§ 3K Ã— 3K ä¸ªå—çš„å…³ç³»è¿›è¡Œåˆ†åŒºå¹¶å“ˆå¸Œè¿æ¥ï¼Œä¹Ÿå°±æ˜¯ 3K Ã— 3K Ã— 4K = 36G å¤§å°çš„å…³ç³»ã€‚</p>
</div>
<ul>
<li>
<p>ä¸è€ƒè™‘é€’å½’åˆ†åŒºï¼Œä¿è¯æ²¡æœ‰å“ˆå¸Œè¡¨æº¢å‡ºï¼š</p>
<ul>
<li>
<p>block-transfer</p>
<ul>
<li>
<p>partition: å…³ç³»ä¸­çš„æ¯ä¸ªå—éƒ½éœ€è¦ä»ç£ç›˜ä¸­å–å‡ºï¼Œå…± <span class="arithmatex">\(b_s + b_r\)</span> æ¬¡å—ä¼ è¾“ï¼›è¿˜éœ€è¦æŒ‰åˆ†åŒºè¿›è¡Œå†™å›ï¼Œå¹¶ä¸” <span class="arithmatex">\(n_h\)</span> ä¸ªåˆ†åŒºä¸­çš„æ¯ä¸€ä¸ªéƒ½å¯èƒ½å‰©ä¸€ä¸ªåªè£…äº†éƒ¨åˆ†çš„å—ï¼Œå…±éœ€ <span class="arithmatex">\(b_s + b_r + 2n_h\)</span> æ¬¡å—ä¼ è¾“ã€‚</p>
</li>
<li>
<p>build &amp; probe: åˆšæ‰æ¯ä¸ªå†™å›çš„å—éƒ½åˆšå¥½éœ€è¦è¢«å–å‡ºä¸€æ¬¡ï¼Œå…± <span class="arithmatex">\(b_s + b_r + 2n_h\)</span> æ¬¡å—ä¼ è¾“ã€‚</p>
</li>
<li>
<p>æˆæœ¬: <span class="arithmatex">\((3(b_s + b_r) + 4n_h) \times T_T\)</span></p>
</li>
</ul>
</li>
<li>
<p>seek</p>
<ul>
<li>
<p>partition: å‡è®¾ä¸ºè¾“å…¥è¾“å‡ºç¼“å†²åŒºå„åˆ†é…äº† <span class="arithmatex">\(b_b\)</span> ä¸ªå—ï¼Œåˆ™åˆ’åˆ†æ€»å…±éœ€è¦ <span class="arithmatex">\(2(\lceil b_s / b_b \rceil + \lceil b_r / b_b \rceil)\)</span> æ¬¡å¯»é“ã€‚</p>
</li>
<li>
<p>build &amp; probe: å¯¹äºæ¯ä¸ªåˆ†åŒºåªéœ€è¦è¿›è¡Œä¸€æ¬¡å¯»é“ï¼Œæ€»å…± <span class="arithmatex">\(2n_h\)</span> æ¬¡ã€‚</p>
</li>
<li>
<p>æˆæœ¬: <span class="arithmatex">\((2(\lceil b_s / b_b \rceil + \lceil b_r / b_b \rceil) + 2n_h) \times t_S\)</span>.</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>å¦‚æœéœ€è¦é€’å½’åˆ†åŒºï¼šé‚£ä¹ˆï¼Œæ¯ä¸€æ¬¡é€’å½’é¢„è®¡å¯ä»¥å‡å°ä¸ºåŸæ¥çš„ <span class="arithmatex">\(1/(M-1)\)</span> å¤§å°ï¼Œå…±éœ€è¦ <span class="arithmatex">\(d = \lceil \log_{M-1}(b_s) - 1 \rceil\)</span> æ¬¡é€’å½’ã€‚</p>
<ul>
<li>
<p>block-transfer:</p>
<ul>
<li>
<p>partition: <span class="arithmatex">\(2(b_s + b_r) \times d\)</span> æ¬¡å—ä¼ è¾“ã€‚</p>
</li>
<li>
<p>build &amp; probe: <span class="arithmatex">\((b_s + b_r)\)</span> æ¬¡å—ä¼ è¾“ (TBD)ã€‚</p>
</li>
</ul>
</li>
<li>
<p>seek: <span class="arithmatex">\(2(\lceil b_r / b_b \rceil + \lceil b_s / b_b \rceil) \times d \times t_S\)</span>.</p>
</li>
</ul>
</li>
</ul>
<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼šæˆ‘ä»¬å·²ç»å­¦ä¹ äº†é’ˆå¯¹å•ä¸ªæ“ä½œçš„ç®—æ³•ã€‚</p>
<h4 id="_22">æ•´ä½“è¡¨è¾¾å¼æ ‘çš„æ›¿ä»£æ–¹æ³•<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h4>
<div class="admonition warning">
<p class="admonition-title">è¿™æ®µæˆ‘ç¡®å®æœ‰ç‚¹æ²¡çœ‹æ‡‚ï¼Œå›æ¥è¡¥ä¸€ä¸‹</p>
</div>
<p><strong>1. ç‰©åŒ– (Materialization)</strong>ï¼šå¯¹äºä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå¦‚æœå…¶è¾“å…¥æ˜¯(æ•°æ®åº“ä¸­çš„)å…³ç³»æˆ–å·²ç»è®¡ç®—å‡ºçš„ç»“æœï¼Œå°±å…ˆè®¡ç®—è¿™ä¸ªè¡¨è¾¾å¼ï¼Œå¹¶å°†å…¶ç»“æœç‰©åŒ–(å­˜å‚¨)åˆ°ç£ç›˜ä¸Šã€‚ç„¶åé‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°è·å¾—æœ€ç»ˆç»“æœã€‚</p>
<ul>
<li>
<p><strong>ç‰©åŒ–æ±‚å€¼ (Materialized evaluation)</strong>ï¼šä»(è¡¨è¾¾å¼æ ‘çš„)æœ€åº•å±‚å¼€å§‹ï¼Œä¸€æ¬¡æ‰§è¡Œä¸€ä¸ªæ“ä½œã€‚è®¡ç®—å‡ºçš„ä¸­é—´ç»“æœä¼šè¢«ç‰©åŒ–ä¸ºä¸´æ—¶å…³ç³»ï¼Œå¹¶ç”¨äºå…¶ä¸Šä¸€å±‚æ“ä½œçš„æ±‚å€¼ã€‚</p>
<ul>
<li>
<p>ç‰©åŒ–æ±‚å€¼çš„ä¼˜ç‚¹æ˜¯å®ƒæ€»æ˜¯é€‚ç”¨çš„ï¼Œä½†æ˜¯ï¼Œå°†ç»“æœå†™å…¥ç£ç›˜å†ä»ç£ç›˜è¯»å›çš„<strong>æˆæœ¬</strong>å¯èƒ½ç›¸å½“é«˜ã€‚æˆ‘ä»¬ä¹‹å‰ç»™å‡ºçš„æ“ä½œæˆæœ¬å…¬å¼å¿½ç•¥äº†å°†ç»“æœå†™å…¥ç£ç›˜çš„æˆæœ¬ï¼Œå› æ­¤ï¼š</p>
</li>
<li>
<p><strong>æ€»æˆæœ¬ = å„ä¸ªç‹¬ç«‹æ“ä½œçš„æˆæœ¬ä¹‹å’Œ + å°†ä¸­é—´ç»“æœå†™å…¥ç£ç›˜çš„æˆæœ¬</strong></p>
</li>
<li>
<p><strong>åŒç¼“å†² (Double buffering)</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªä¼˜åŒ–æŠ€æœ¯ã€‚å®ƒä¸ºæ¯ä¸ªæ“ä½œä½¿ç”¨ä¸¤ä¸ªè¾“å‡ºç¼“å†²åŒºï¼Œå½“ä¸€ä¸ªç¼“å†²åŒºè¢«å†™æ»¡æ—¶ï¼Œç³»ç»Ÿä¼šå°†å…¶å†…å®¹å†™å…¥ç£ç›˜ï¼Œè€Œè®¡ç®—è¿‡ç¨‹å¯ä»¥åŒæ—¶åœ¨å¦ä¸€ä¸ªç¼“å†²åŒºä¸­è¿›è¡Œå¡«å……ã€‚åŒç¼“å†²æŠ€æœ¯ä½¿å¾—ç£ç›˜å†™å…¥å¯ä»¥å’Œè®¡ç®—é‡å è¿›è¡Œï¼Œä»è€Œå‡å°‘äº†æ€»çš„æ‰§è¡Œæ—¶é—´ã€‚</p>
</li>
</ul>
</li>
</ul>
<p><strong>2. æµæ°´çº¿ (Pipelining)</strong>ï¼šä¸€ä¸ªæ“ä½œåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ— éœ€ç­‰å¾…å…¶å…¨éƒ¨å®Œæˆï¼Œå°±å¯ä»¥å°†äº§ç”Ÿçš„å…ƒç»„(tuples)ç«‹å³ä¼ é€’ç»™å®ƒçš„çˆ¶æ“ä½œã€‚</p>
<ul>
<li>
<p><strong>æµæ°´çº¿æ±‚å€¼ (Pipelined evaluation)</strong>ï¼šåŒæ—¶è¯„ä¼°å¤šä¸ªæ“ä½œï¼Œå°†ä¸€ä¸ªæ“ä½œçš„ç»“æœç›´æ¥ä¼ é€’ç»™ä¸‹ä¸€ä¸ªæ“ä½œã€‚</p>
<ul>
<li>
<p>ä¾‹å¦‚ï¼Œåœ¨ä¹‹å‰çš„è¡¨è¾¾å¼æ ‘ä¸­ï¼Œä¸è¦å­˜å‚¨ <span class="arithmatex">\(\sigma_{building="Watson"}(department)\)</span> çš„ç»“æœã€‚è€Œæ˜¯åº”è¯¥å°†å…ƒç»„ç›´æ¥ä¼ é€’ç»™è¿æ¥(join)æ“ä½œã€‚åŒæ ·åœ°ï¼Œä¹Ÿä¸è¦å­˜å‚¨è¿æ¥çš„ç»“æœï¼Œè€Œæ˜¯å°†å…ƒç»„ç›´æ¥ä¼ é€’ç»™æŠ•å½±(projection)æ“ä½œã€‚</p>
</li>
<li>
<p>æˆæœ¬æ¯”ç‰©åŒ–(materialization)ä½å¾—å¤šï¼šå› ä¸ºæ— éœ€å°†ä¸´æ—¶å…³ç³»å­˜å‚¨åˆ°ç£ç›˜ã€‚</p>
</li>
<li>
<p>æµæ°´çº¿å¹¶éæ€»æ˜¯å¯è¡Œ â€”â€” ä¾‹å¦‚ï¼Œåƒæ’åº(sort)å’Œå“ˆå¸Œè¿æ¥(hash-join)è¿™ç±»æ“ä½œå°±ä¸æ”¯æŒã€‚</p>
</li>
</ul>
</li>
</ul>
<p>ä¸ºä½¿æµæ°´çº¿æœ‰æ•ˆï¼Œéœ€è¦ä½¿ç”¨é‚£äº›èƒ½åœ¨æ¥æ”¶è¾“å…¥å…ƒç»„çš„åŒæ—¶å°±å¼€å§‹ç”Ÿæˆè¾“å‡ºå…ƒç»„çš„æ±‚å€¼ç®—æ³•ã€‚æµæ°´çº¿å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼æ‰§è¡Œï¼š<strong>éœ€æ±‚é©±åŠ¨ (demand driven)</strong> å’Œ <strong>ç”Ÿäº§è€…é©±åŠ¨ (producer driven)</strong>ã€‚</p>
<p>åœ¨éœ€æ±‚é©±åŠ¨çš„é€»è¾‘ä¸­ï¼š</p>
<ul>
<li>ç³»ç»Ÿä¼šä¸æ–­å‘(è¡¨è¾¾å¼æ ‘çš„)é¡¶å±‚æ“ä½œè¯·æ±‚ä¸‹ä¸€ä¸ªå…ƒç»„ï¼Œæ¯ä¸ªæ“ä½œéƒ½ä¼šå‘å…¶å­æ“ä½œè¯·æ±‚ä¸‹ä¸€ä¸ªå…ƒç»„ã€‚åœ¨ä¸­é—´è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªæ“ä½œéƒ½å¿…é¡»ä¿æŒè‡ªèº«çš„â€œçŠ¶æ€â€(state)ä»¥æ˜ç¡®è‡ªå·±ç¨ååº”è¯¥è¿”å›ä»€ä¹ˆã€‚</li>
</ul>
<p>åœ¨ç”Ÿäº§è€…é©±åŠ¨çš„é€»è¾‘ä¸­ï¼š</p>
<ul>
<li>
<p>æ“ä½œç¬¦ä¼šè‡ªå·±ç»™çˆ¶èŠ‚ç‚¹ä¼ é€’è‡ªå·±ç”Ÿæˆçš„å…ƒç»„ã€‚</p>
</li>
<li>
<p>ä¸Šä¸‹å±‚çš„æ“ä½œä¹‹é—´ä¼šæœ‰ç¼“å†²åŒºã€‚å­æ“ä½œä¼šæŠŠè‡ªå·±ç”Ÿæˆçš„å…ƒç»„å…ˆæ”¾è¿›ç¼“å†²åŒºä¹‹ä¸­ï¼Œå‰¯æ“ä½œä¼šæ ¹æ®è‡ªèº«æ¡ä»¶ç­›é€‰å…¶ä¸­çš„å…ƒç»„å¹¶å‰”é™¤ä¸ç¬¦åˆè¦æ±‚çš„é‚£äº›ã€‚å¦‚æœç¼“å†²åŒºæš‚æ»¡è€Œå­æ“ä½œè¿˜æ²¡æœ‰å†™å…¥å…¨éƒ¨çš„å…ƒç»„ï¼Œå­æ“ä½œå°±è¿›å…¥ç­‰å¾…ï¼Œç›´åˆ°æœ‰ç©ºä½™ç©ºé—´ã€‚</p>
</li>
<li>
<p>ç³»ç»Ÿä¼šè°ƒåº¦é‚£äº›è¾“å‡ºç¼“å†²åŒºæœ‰ç©ºé—²ç©ºé—´ä¸”èƒ½ç»§ç»­å¤„ç†è¾“å…¥å…ƒç»„çš„æ“ä½œã€‚</p>
</li>
</ul>
<details class="success">
<summary>æµæ°´çº¿ä¸­å•ä¸ªæ“ä½œçš„å®ç°</summary>
<p>è¿™é‡Œä»¥éœ€æ±‚é©±åŠ¨çš„æµæ°´çº¿ä¸ºä¾‹ã€‚</p>
<p>æ¯ä¸ªæ“ä½œéƒ½æ˜¯ä»¥è¿­ä»£å™¨å®ç°çš„ã€‚è¿­ä»£å™¨æ¨¡å¼å°†æ¯ä¸ªå…³ç³»ä»£æ•°æ“ä½œå°è£…ä¸ºç»Ÿä¸€çš„æ¥å£ã€‚è¿­ä»£å™¨å®ç°äº†ä¸‹é¢çš„æ“ä½œï¼š</p>
<ul>
<li>
<p><code>open()</code>ï¼šåˆå§‹åŒ–æ“ä½œï¼Œåˆ›å»ºæ“ä½œåˆå§‹çŠ¶æ€(å¦‚æŒ‡é’ˆã€ç¼“å†²åŒº)</p>
<p>ä¾‹å¦‚ æ–‡ä»¶æ‰«æï¼šé‡ç½®æ–‡ä»¶æŒ‡é’ˆåˆ°èµ·å§‹ä½ç½®ï¼›åˆå¹¶è¿æ¥ï¼šå…ˆæ’åºå­å…³ç³»ï¼Œåˆå§‹åŒ–æ¸¸æ ‡ ç­‰ã€‚</p>
</li>
<li>
<p><code>next()</code>ï¼šè·å–ä¸‹ä¸€å…ƒç»„ï¼Œæ›´æ–°å†…éƒ¨çŠ¶æ€(å¦‚æ¸¸æ ‡ä½ç½®)</p>
<p>ä¾‹å¦‚ æ–‡ä»¶æ‰«æï¼šè¯»å–å½“å‰å…ƒç»„åæ¨è¿›æŒ‡é’ˆï¼›åˆå¹¶è¿æ¥ï¼šç»§ç»­å½’å¹¶æ’åºè¿‡ç¨‹ç›´è‡³ç”Ÿæˆä¸‹ä¸€ç»“æœå…ƒç»„ ç­‰ã€‚</p>
</li>
<li>
<p><code>close()</code>ï¼šé‡Šæ”¾èµ„æºï¼Œæ¸…é™¤æ‰€æœ‰çŠ¶æ€</p>
<p>ä¾‹å¦‚ å…³é—­æ–‡ä»¶/é‡Šæ”¾ç¼“å†²åŒºç­‰ã€‚</p>
</li>
</ul>
</details>
<h2 id="_23">æŸ¥è¯¢ä¼˜åŒ–<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h2>
<hr />
<h2 id="transaction">äº‹åŠ¡(Transaction)<a class="headerlink" href="#transaction" title="Permanent link">&para;</a></h2>
<p><strong>äº‹åŠ¡(Transaction)</strong>æ˜¯ç¨‹åºä¸€æ¬¡æ‰§è¡Œè‹¥å¹²æ¬¡æ“ä½œç»„æˆçš„æŠ½è±¡æ¦‚å¿µï¼Œæ˜¯ä¸€ä¸ª unitã€‚Transaction çš„æå‡ºæ˜¯ä¸ºäº†ç»´æŠ¤æ•°æ®çš„å®Œæ•´æ€§ã€‚æœ‰äº†äº‹åŠ¡è¿™ä¸€æ¦‚å¿µï¼Œæˆ‘ä»¬è¿˜æœ‰ä¸¤ä¸ªä¸»è¦çš„é—®é¢˜ï¼š</p>
<ul>
<li>
<p>å¦‚ä½•å¤„ç†å¹¶è¡Œäº‹åŠ¡ï¼Ÿ --&gt; <a href="#Concurrency_Control">#å¹¶å‘æ§åˆ¶(Concurrency Control)</a></p>
</li>
<li>
<p>å¦‚ä½•å¤„ç†ä¾‹å¦‚ç¡¬ä»¶æ•…éšœå’Œç³»ç»Ÿå´©æºƒè¿™æ ·çš„é”™è¯¯ï¼Ÿ --&gt; <a href="#Recovery">#é”™è¯¯æ¢å¤(Recovery)</a></p>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">äº‹åŠ¡çš„çŠ¶æ€</p>
<p><div align="center">  <br />
<img src="../images/DB/db23.png" alt="txn_states" style="zoom :75%;" />
</div></p>
<ul>
<li>
<p><strong>æ´»è·ƒ(Active)</strong> </p>
<p>The initial state; the transaction stays in this state while it is executing</p>
</li>
<li>
<p><strong>éƒ¨åˆ†æäº¤(Partially committed)</strong></p>
<p>After the final statement has been executed.</p>
</li>
<li>
<p><strong>å¤±è´¥(Failed)</strong></p>
<p>After the discovery that normal execution can no longer proceed.</p>
</li>
<li>
<p><strong>ä¸­æ­¢(Aborted)</strong></p>
<p>after the transaction has been rolled back and the database restored to its state prior to the start of the transaction. Two options after it has been aborted:</p>
<ul>
<li>
<p>Restart the transaction (can be done only if no internal logical error in the transaction)</p>
</li>
<li>
<p>Kill the transaction</p>
</li>
</ul>
</li>
<li>
<p><strong>æäº¤(Committed)</strong></p>
<p>After successful completion.</p>
</li>
</ul>
</div>
<h3 id="acid">ACID<a class="headerlink" href="#acid" title="Permanent link">&para;</a></h3>
<p>äº‹åŠ¡çš„å®ç°è¦æ±‚å››ä¸ªç‰¹æ€§ ACID ï¼š</p>
<ul>
<li>
<p><strong>A-Atomicity</strong> åŸå­æ€§</p>
<p>ä¸€ä¸ªäº‹åŠ¡åº”è¯¥è¢«ç³»ç»Ÿè§†ä½œä¸€ä¸ªæ•´ä½“ã€‚å‡å¦‚ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œä¸­é€”å‘ç”Ÿæ•…éšœï¼Œé‚£ä¹ˆæ•…éšœç‚¹å‰é¢å±äºè¯¥äº‹åŠ¡çš„æ“ä½œä¸èƒ½åæ˜ åˆ°æ•°æ®åº“ä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªäº‹ç‰©è¦ä¹ˆæ‰€æœ‰æ“ä½œ(åŒ…æ‹¬ Commit)æˆåŠŸå®Œæˆï¼Œè¦ä¹ˆæ‰€æœ‰æ“ä½œéƒ½åº”è¯¥è¢«å›æ»šã€‚</p>
</li>
<li>
<p><strong>C-Consistency</strong> ä¸€è‡´æ€§</p>
<p>æ€»ä½“æ¥è¯´å¯ä»¥è§£é‡Šæˆï¼šå¿…é¡»ä¿è¯æ•°æ®åœ¨æ“ä½œä¿®æ”¹å‰åä»ç„¶éµå¾ª</p>
<ul>
<li>
<p>æ˜¾å¼æŒ‡å®šçš„å®Œæ•´æ€§çº¦æŸ(å¦‚ä¸»é”®å’Œå¤–é”®)</p>
</li>
<li>
<p>éšå¼å®Œæ•´æ€§çº¦æŸï¼Œä¾‹å¦‚ï¼Œæ‰€æœ‰è´¦æˆ·ä½™é¢çš„æ€»å’Œå‡å»è´·æ¬¾æ€»é¢å¿…é¡»ç­‰äºç°é‡‘æŒæœ‰é‡</p>
</li>
</ul>
</li>
<li>
<p><strong>I-Isolation</strong> éš”ç¦»æ€§</p>
<p>å³ä½¿æœ‰å¤šä¸ªäº‹åŠ¡æ­£åœ¨åŒæ—¶è¿›è¡Œï¼Œå®ƒä»¬å½¼æ­¤ä¹‹é—´åº”è¯¥æ˜¯ä¸çŸ¥é“æœ‰å…¶ä»–äº‹åŠ¡æ­£åœ¨è¿›è¡Œçš„(è¿™å°±æ˜¯äº‹åŠ¡é”)ã€‚ä¸€ä¸ªäº‹åŠ¡ä¸­é€”çš„ç»“æœåº”è¯¥å¯¹å…¶ä»–äº‹åŠ¡ä¸å¯è§ã€‚</p>
</li>
<li>
<p><strong>D-Durability</strong> æŒä¹…æ€§</p>
<p>ä¸€ä¸ªäº‹åŠ¡å£°æ˜å·²ç»ç»“æŸåï¼Œæ–­ç”µç­‰ç­‰çš„æ„å¤–ä¸èƒ½å¯¹å·²ç»“æŸçš„äº‹åŠ¡çš„ç»“æœæ•°æ®é€ æˆä»»ä½•å½±å“ï¼Œä¹Ÿå³å·²æäº¤çš„ä¿®æ”¹å¿…é¡»è¦ä¸€ç›´å­˜åœ¨ã€‚</p>
</li>
</ul>
<p>ä¸ºäº†å®ç°éš”ç¦»æ€§ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªè‡ªç„¶çš„æƒ³æ³•ï¼Œå°±æ˜¯è®©ç³»ç»Ÿæ¯æ¬¡åªèƒ½æ‰§è¡Œä¸€ä¸ªäº‹åŠ¡ã€‚ä½†æ˜¯è¿™æ ·æ•ˆç‡å¤ªæ…¢äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è§£å†³<strong>å¹¶å‘æ§åˆ¶</strong>çš„é—®é¢˜ã€‚</p>
<h3 id="_24">å¹¶å‘æ§åˆ¶<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h3>
<p>åœ¨å…è®¸å¹¶è¡Œçš„æƒ…å†µä¸‹ï¼Œå®ç°äº‹åŠ¡éš”ç¦»æ€§çš„æœºåˆ¶æ˜¯<strong>Concurrency control schemes</strong>ã€‚æˆ‘ä»¬é¦–å…ˆå®šä¹‰ï¼Œå¹¶å‘äº‹åŠ¡çš„å„ä¸ªå­æ“ä½œåœ¨ DBMS å†…éƒ¨çš„å…·ä½“æ‰§è¡Œæ­¥éª¤è¢«ç§°ä¸º<strong>è°ƒåº¦(Schedule)</strong>ã€‚</p>
<p>schedule å¤§è‡´å¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼š</p>
<ul>
<li>
<p>ä¸²è¡Œè°ƒåº¦</p>
<p>ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œå®Œå†æ‰§è¡Œå¦ä¸€ä¸ªã€‚æ‰€ä»¥ï¼Œ n ä¸ªå¹¶è¡Œäº‹åŠ¡æœ‰ <span class="arithmatex">\(n!\)</span> ç§å¯é€‰æ‹©çš„ä¸²è¡Œè°ƒåº¦ã€‚</p>
<p><div align="center">  <br />
<img src="../images/DB/db32.png" alt="serial_schedule" style="zoom: 80%"/>
</div></p>
<p>ä¸²è¡Œè°ƒåº¦ä¸€å®šå¯ä»¥ä¿æŒä¸€è‡´æ€§ï¼Œä½†æ˜¯æ•ˆç‡è¾ƒä½ã€‚</p>
</li>
<li>
<p>å¹¶è¡Œè°ƒåº¦</p>
<p>å¥½çš„å¹¶è¡Œè°ƒåº¦ä¸ä¸²è¡Œè°ƒåº¦çš„ç»“æœåº”è¯¥ç›¸åŒ(S3 ä¸ S1)ï¼Œæ„å‘³ç€ä¸Šå±‚å§‹ç»ˆå¯ä»¥æŒ‰ç…§ä¸¥æ ¼ä¸²è¡Œæ¥ç†è§£å’Œè°ƒç”¨æ•°æ®åº“ï¼Œå³ä½¿å…¶å†…éƒ¨å¹¶ä¸ä¸€å®šæ˜¯ä¸²è¡Œè°ƒåº¦ã€‚</p>
<p><div align="center">  <br />
<img src="../images/DB/db33.png" alt="concurrent_schedule" style="zoom: 80%"/>
</div></p>
</li>
</ul>
<h4 id="serializability">å¯ä¸²è¡Œæ€§(Serializability)<a class="headerlink" href="#serializability" title="Permanent link">&para;</a></h4>
<p>æˆ‘ä»¬è¯´ï¼Œå¦‚æœä¸€ç§å¹¶è¡Œè°ƒåº¦å’ŒæŸç§ä¸²è¡Œè°ƒåº¦ç­‰ä»·ï¼Œé‚£ä¹ˆå®ƒæ˜¯<strong>å¯ä¸²è¡ŒåŒ–</strong>çš„ã€‚æ ¹æ®ä¸åŒçš„è°ƒåº¦ç­‰ä»·å½¢å¼ï¼Œå¯å¼•å‡ºä»¥ä¸‹ä¸¤ç§æ¦‚å¿µï¼š</p>
<ol>
<li>
<p>å†²çªå¯ä¸²è¡ŒåŒ–ï¼ˆ Conflict Serializability ï¼‰</p>
</li>
<li>
<p>è§†å›¾å¯ä¸²è¡ŒåŒ–ï¼ˆ View Serializability ï¼‰</p>
</li>
</ol>
<p>åœ¨æ¥ä¸‹æ¥çš„è®¨è®ºä¸­ï¼Œæˆ‘ä»¬åªå…³æ³¨è¯»å†™æŒ‡ä»¤ã€‚æˆ‘ä»¬è®¾ <span class="arithmatex">\(I_i\)</span> å’Œ <span class="arithmatex">\(I_j\)</span> åˆ†åˆ«æ˜¯äº‹åŠ¡ <span class="arithmatex">\(T_i\)</span> å’Œ <span class="arithmatex">\(T_j\)</span> çš„æŒ‡ä»¤ã€‚å¦‚æœ <span class="arithmatex">\(I_i\)</span> å’Œ <span class="arithmatex">\(I_j\)</span> åŒæ—¶å¯¹æŸä¸ªå¯¹è±¡ Q è¿›è¡Œè®¿é—®ï¼Œä¸”è‡³å°‘æœ‰ä¸€æ¡æŒ‡ä»¤æ­£åœ¨å‘ Q å†™å…¥æ•°æ®ï¼Œé‚£ä¹ˆè¿™ä¸¤æ¡æŒ‡ä»¤å°±æ˜¯<strong>å†²çª(conflict)</strong>çš„ã€‚åŒæ—¶è¯» Q ä¸æ„æˆå†²çªã€‚</p>
<p>å¦‚æœä¸€ä¸ª<u>è°ƒåº¦</u> <span class="arithmatex">\(S\)</span> ä»¥é€šè¿‡äº¤æ¢ç›¸äº’ä¸å†²çªçš„è¯­å¥è½¬æ¢ä¸º <span class="arithmatex">\(S'\)</span>ï¼Œæˆ–è€…è¯´ <span class="arithmatex">\(S\)</span> ä¸ <span class="arithmatex">\(S'\)</span> æ‰€æœ‰ç›¸äº’å†²çªçš„æŒ‡ä»¤ä»¥ç›¸åŒçš„é¡ºåºæ’åˆ—ï¼Œç§° <span class="arithmatex">\(S\)</span> å’Œ <span class="arithmatex">\(S'\)</span> æ˜¯<strong>å†²çªç­‰ä»·(conflict equivalent)</strong>çš„ã€‚å¦‚æœ <span class="arithmatex">\(S\)</span> å†²çªç­‰ä»·äºä¸€ä¸ªä¸²è¡Œè°ƒåº¦åºåˆ—ï¼Œç§° <span class="arithmatex">\(S\)</span> æ˜¯<strong>å†²çªå¯ä¸²è¡Œ(conflict serializable)</strong>çš„ã€‚</p>
<div class="admonition warning">
<p class="admonition-title">æ³¨æ„è¿™é‡Œâ€œå†²çªâ€å’Œâ€œå†²çªç­‰ä»·/å¯ä¸²è¡Œâ€å¯¹åº”çš„æè¿°å¯¹è±¡æ˜¯ä¸åŒçš„ï¼</p>
</div>
<p>ä¸ºäº†ç›´è§‚çœ‹åˆ°äº‹åŠ¡çš„æ‰§è¡Œé¡ºåºï¼Œæ–¹ä¾¿æˆ‘ä»¬åˆ¤æ–­è°ƒåº¦æ˜¯å¦å†²çªå¯ä¸²è¡Œï¼Œæˆ‘ä»¬å¯ä»¥é’ˆå¯¹æŸä¸ªè°ƒåº¦ç”»å‡º<strong>å‰è¶‹å›¾/ä¼˜å…ˆå›¾(Precedence Graph)</strong>ã€‚å‰è¶‹å›¾æ˜¯ä¸€ä¸ªæœ‰å‘å›¾ï¼Œå›¾çš„é¡¶ç‚¹æ˜¯è°ƒåº¦ä¸­çš„å„äº‹åŠ¡ã€‚å¦‚æœå¯¹äºä¸¤ä¸ªäº‹åŠ¡ <span class="arithmatex">\(T_i\)</span> å’Œ <span class="arithmatex">\(T_j\)</span>ï¼Œå­˜åœ¨ <span class="arithmatex">\(T_i\)</span> ä¸­çš„æ“ä½œ <span class="arithmatex">\(I_i\)</span> å’Œ <span class="arithmatex">\(T_j\)</span> ä¸­çš„æ“ä½œ <span class="arithmatex">\(I_j\)</span>ï¼Œæ»¡è¶³ <u><span class="arithmatex">\(I_i\)</span> åœ¨ <span class="arithmatex">\(I_j\)</span> å‰ï¼Œå¹¶ä¸” <span class="arithmatex">\(I_i\)</span> å’Œ <span class="arithmatex">\(I_j\)</span> å†²çª</u>ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä» <span class="arithmatex">\(T_i\)</span> çš„é¡¶ç‚¹å¼•å‡ºä¸€æ¡æœ‰å‘è¾¹æŒ‡å‘ <span class="arithmatex">\(T_j\)</span> çš„é¡¶ç‚¹ã€‚æˆ‘ä»¬ä¸€èˆ¬åœ¨è¾¹ä¸Šæ ‡æ³¨å†²çªæŒ‡ä»¤æ‰€è¦è®¿é—®çš„å¯¹è±¡ã€‚</p>
<p>å¦‚æœä¸€ä¸ªè°ƒåº¦çš„å‰è¶‹å›¾<u>æ²¡æœ‰ç¯(acyclic)</u>ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯å†²çªå¯ä¸²è¡ŒåŒ–çš„ã€‚å†²çªå¯ä¸²è¡Œçš„è°ƒåº¦æ‰€ç­‰ä»·çš„ä¸²è¡Œè°ƒåº¦çš„äº‹åŠ¡é¡ºåºå¯ä»¥ç”±å‰è¶‹å›¾çš„<strong>æ‹“æ‰‘æ’åº(topological sorting)</strong>è·å¾—ã€‚</p>
<div class="admonition note">
<p class="admonition-title">ç¯æ£€æµ‹ç®—æ³•</p>
<ul>
<li>
<p>å¦‚æœä½¿ç”¨é‚»æ¥çŸ©é˜µï¼Œåˆ™å…¶æ—¶é—´å¤æ‚åº¦æ˜¯ <span class="arithmatex">\(O(n^2)\)</span>ï¼Œè¿™é‡Œ <span class="arithmatex">\(n\)</span> æ˜¯é¡¶ç‚¹æ•°é‡ã€‚</p>
</li>
<li>
<p>å¦‚æœä½¿ç”¨ DFS ç®—æ³•ï¼Œåˆ™æ—¶é—´å¤æ‚åº¦å¯ä»¥ä¼˜åŒ–è‡³ <span class="arithmatex">\(O(n+e)\)</span>ï¼Œè¿™é‡Œ <span class="arithmatex">\(e\)</span> æ˜¯è¾¹çš„æ•°é‡ã€‚</p>
</li>
</ul>
<p>åœ¨äº‹åŠ¡å†²çªçš„è¯­å¢ƒä¸‹ï¼Œå‰è¶‹å›¾å¾€å¾€éƒ½æ˜¯<strong>ç¨€ç–å›¾</strong>ï¼Œè¿™ä¸ªæ—¶å€™é‡‡ç”¨ DFS æ–¹æ³•æ•ˆç‡æ›´é«˜ã€‚</p>
</div>
<div align="center">    
<img src="../images/DB/db34.png" alt="conflict_1" style="zoom: 80%"/>
</div>

<h4 id="_25">çº§è”è°ƒåº¦<a class="headerlink" href="#_25" title="Permanent link">&para;</a></h4>
<p>å¦‚æœå¹¶å‘è°ƒåº¦ä¸‹ï¼ŒæŸä¸€ä¸ªäº‹åŠ¡å¤±è´¥éœ€è¦å›æ»šä¼šå¸¦åŠ¨å…¶ä»–äº‹åŠ¡ä¸€èµ·å›æ»šï¼Œè¿™ç§æƒ…å†µè¢«ç§°ä¸º<strong>çº§è”å›æ»š(cascading rollback)</strong>ã€‚å¦‚æœä¸€ä¸ªè°ƒåº¦åºåˆ—ä¸ä¼šå¼•èµ·ä»»ä½•çº§è”å›æ»šï¼Œç§°å®ƒæ˜¯<strong>éçº§è”è°ƒåº¦(cascadeless schedule)</strong>ã€‚ä¸‹å›¾ä¸­æ˜¯ä¸€ä¸ªä¸æ˜¯éçº§è”è°ƒåº¦çš„ä¾‹å­ï¼Œè¿™æ ·çš„è°ƒåº¦è¢«è®¤ä¸ºæ˜¯ä¸å¥½çš„ã€‚</p>
<div align="center">    
<img src="../images/DB/db35.png" alt="cascading_schedule" style="zoom: 80%"/>
</div>

<p>å®ç°éçº§è”è°ƒåº¦çš„å…·ä½“è¦æ±‚æ˜¯ï¼Œå¹¶å‘äº‹åŠ¡å¯¹åŒä¸€ä¸ªæ•°æ®æœ‰è¯»æœ‰å†™æ—¶ï¼Œä»»æ„åšäº†å†™å…¥çš„äº‹åŠ¡å¿…é¡»æäº¤åï¼Œä¸‹ä¸€ä¸ªäº‹åŠ¡æ‰èƒ½ä»ä¸­è¯»ã€‚</p>
<p>åœ¨ä¸€ä¸ªå¹¶å‘è°ƒåº¦åºåˆ—ä¸­ï¼Œå¦‚æœä¸€ä¸ªäº‹åŠ¡ä»å¦å¤–ä¸€ä¸ªäº‹åŠ¡çš„ç»“æœä¸­è¯»å–æ•°æ®ï¼Œé‚£ä¹ˆå®ƒåº”è¯¥åœ¨å¦å¤–çš„äº‹åŠ¡ commit ä¹‹å commitã€‚æ»¡è¶³è¿™ä¸€æ¡ä»¶çš„è°ƒåº¦ç§°ä¸º<strong>å¯æ¢å¤çš„(Recoverable)</strong>ã€‚æ‰€ä»¥ï¼Œä»»ä½•éçº§è”è°ƒåº¦éƒ½æ˜¯å¯æ¢å¤çš„è°ƒåº¦ã€‚</p>
<p>ä¸€ä¸ªæ•°æ®åº“ç³»ç»Ÿå¿…é¡»æä¾›ä¸€ç§æœºåˆ¶ï¼Œå…¶åº”è¯¥è®©æ‰€æœ‰è°ƒåº¦æ˜¯å†²çªå¯ä¸²è¡Œçš„ï¼Œä¸”éƒ½æ˜¯éçº§è”è°ƒåº¦ã€‚</p>
<h4 id="_26">å¼±ä¸€è‡´æ€§ç­‰çº§<a class="headerlink" href="#_26" title="Permanent link">&para;</a></h4>
<p>æˆ‘ä»¬ä»å‰é¢å°±çŸ¥é“ä¸²è¡Œè°ƒåº¦æ•°æ®å®‰å…¨æ€§å¼ºè€Œæ€§èƒ½å¼±ï¼Œå¹¶è¡Œè°ƒåº¦åä¹‹ã€‚å®é™…ä½¿ç”¨ä¸­ï¼Œè¿™å¾€å¾€ä¸æ˜¯äºŒé€‰ä¸€ï¼Œè€Œæ˜¯å–æŠ˜ä¸­çš„é—®é¢˜ã€‚ä¸‹é¢åˆ—å‡ºäº†å¸¸è§çš„å››ç§å¹¶è¡ŒåŒ–çš„å±‚æ¬¡ã€‚</p>
<ul>
<li>
<p><strong>Serializable</strong> â€” default</p>
</li>
<li>
<p><strong>Repeatable read</strong> â€” only committed records to be read, repeated reads of same record must return same value.  However, a transaction may not be serializable â€“ it may find some records inserted by a transaction but not find others.</p>
</li>
<li>
<p><strong>Read committed</strong> â€” only committed records can be read, but successive reads of record may return different (but committed) values.</p>
</li>
<li>
<p><strong>Read uncommitted</strong> â€” even uncommitted records may be read. </p>
</li>
</ul>
<p>ä¸è¿‡ï¼Œä»¥ä¸Šæ‰€æœ‰å‡ä¸å…è®¸è„å†™ã€‚</p>
<hr />
<h2 id="_27">å¹¶å‘æ§åˆ¶å®ç°<a id="Concurrency_Control"></a><a class="headerlink" href="#_27" title="Permanent link">&para;</a></h2>
<h3 id="lock-based-protocols">Lock-Based Protocols<a class="headerlink" href="#lock-based-protocols" title="Permanent link">&para;</a></h3>
<p><strong>é”(lock)</strong>æ˜¯ä¸€ç§æ§åˆ¶å¹¶å‘è®¿é—®çš„æœºåˆ¶ã€‚æ•°æ®å¯¹è±¡ä¸€èˆ¬å¯ä»¥æ‹¥æœ‰ä¸¤ç§é”ï¼š</p>
<ul>
<li>
<p>å…±äº«é”(Shared - S é”)ã€‚è‹¥äº‹åŠ¡ T å¯¹æ•°æ®å¯¹è±¡ A åŠ ä¸Š S é”ï¼Œåˆ™äº‹åŠ¡ T å¯ä»¥è¯» A ä½†ä¸èƒ½ä¿®æ”¹ Aã€‚å…¶ä»–äº‹åŠ¡åªèƒ½å†å¯¹ A åŠ  S é”ï¼Œè€Œä¸èƒ½åŠ  X é”ï¼Œåªèƒ½ç­‰å¾…ç›´åˆ° T é‡Šæ”¾ A ä¸Šçš„ S é”ã€‚è¿™ä¿è¯äº†å…¶ä»–äº‹åŠ¡å¯ä»¥è¯» A ï¼Œä½†åœ¨ T é‡Šæ”¾ A ä¸Šçš„ S é”ä¹‹å‰ä¸èƒ½å¯¹ A åšä»»ä½•ä¿®æ”¹ã€‚</p>
</li>
<li>
<p>æ’ä»–é”(Exclusive - X é”)ã€‚è‹¥äº‹åŠ¡ T å¯¹æ•°æ®å¯¹è±¡ A åŠ ä¸Š X é”ï¼Œäº‹åŠ¡ T å¯ä»¥è¯» A ä¹Ÿå¯ä»¥ä¿®æ”¹ Aã€‚å…¶ä»–äº‹åŠ¡ä¸èƒ½å†å¯¹ A åŠ ä»»ä½•é”ï¼Œåªèƒ½ç­‰å¾…ç›´åˆ° T é‡Šæ”¾ A ä¸Šçš„é”ã€‚è¿™ä¿è¯äº†å…¶ä»–äº‹åŠ¡åœ¨ T é‡Šæ”¾ A ä¸Šçš„é”ä¹‹å‰ä¸èƒ½å†è¯»å–å’Œä¿®æ”¹ Aã€‚</p>
</li>
</ul>
<p>é”ç›¸å®¹çŸ©é˜µå¦‚ä¸‹ã€‚è¯¥è¡¨çš„å«ä¹‰æ˜¯ä¸¤ä¸ªäº‹åŠ¡æ˜¯å¦å¯ä»¥<strong>åŒæ—¶</strong>å¯¹åŒä¸€ä¸ªå¯¹è±¡åŠ æŒ‡å®šçš„é”ã€‚å†æ¬¡æé†’ï¼Œ<strong>é”æ˜¯å’Œäº‹åŠ¡ç´§å¯†ç›¸å…³</strong>çš„ã€‚</p>
<div align="center">    
<img src="../images/DB/db36.png" alt="Lock-compatibility_matrix"/>
</div>

<h3 id="two-phase-locking-2pl-protocol">Two-Phase Locking (2PL) Protocol<a class="headerlink" href="#two-phase-locking-2pl-protocol" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>ç¬¬ä¸€é˜¶æ®µ(Growing Phase)</p>
<p>åœ¨è¿™ä¸ªé˜¶æ®µï¼Œäº‹åŠ¡å…è®¸æŒæœ‰é”ï¼Œä¸å…è®¸å…¶é‡Šæ”¾é”ã€‚å¦‚æœæˆ‘ä»¬å…è®¸é”ç±»å‹è½¬æ¢ï¼Œè¿™ä¸ªé˜¶æ®µäº‹åŠ¡å¯ä»¥å¯¹æ•°æ®å¯¹è±¡æ–½åŠ  S é”æˆ–è€… X é”ï¼Œæˆ–è€…<strong>å‡çº§(upgrade)</strong>S é”è‡³ X é”ã€‚</p>
</li>
<li>
<p>ç¬¬äºŒé˜¶æ®µ(Shrinking Phase)</p>
<p>åœ¨è¿™ä¸ªé˜¶æ®µï¼Œäº‹åŠ¡å…è®¸é‡Šæ”¾é”ï¼Œä¸å…è®¸å…¶ä»ç„¶æŒæœ‰åŒç±»å‹é”ã€‚å¦‚æœæˆ‘ä»¬å…è®¸é”ç±»å‹è½¬æ¢ï¼Œè¿™ä¸ªé˜¶æ®µäº‹åŠ¡å¯ä»¥é‡Šæ”¾æ–½åŠ çš„ S é”æˆ–è€… X é”ï¼Œæˆ–è€…<strong>é™çº§(downgrade)</strong>X é”è‡³ S é”ã€‚</p>
</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥é‡‡å–è‡ªåŠ¨é”è·å–(Automatic Acquisition of Locks)æ–¹æ³•æ¥èŠ‚çœæ‰‹åŠ¨å·¥ä½œé‡ï¼š</p>
<ul>
<li>
<p><code>read(D)</code>ï¼šè‡ªåŠ¨è·å– S é”ï¼ˆè‹¥æ— å…¶ä»–äº‹åŠ¡æŒæœ‰ X é”ï¼‰ã€‚</p>
</li>
<li>
<p><code>write(D)</code>ï¼šè‡ªåŠ¨è·å– X é”ï¼ˆå¿…è¦æ—¶ç­‰å¾…å¹¶å‡çº§ S é”ï¼‰ã€‚</p>
</li>
</ul>
<p>ä¸è¿‡æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œåœ¨ 2PL æœºåˆ¶ä¸‹ï¼Œçº§è”å›æ»šä»ç„¶å¯èƒ½å‘ç”Ÿã€‚ä¸ºäº†é¿å…çº§è”å›æ»šï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨</p>
<ul>
<li>
<p><strong>ä¸¥æ ¼ä¸¤é˜¶æ®µé”(strict two-phase locking)</strong>ï¼šå…¶è¦æ±‚äº‹åŠ¡æŒæœ‰çš„ X é”å¿…é¡»ä¿æŒåˆ°æäº¤/ä¸­æ­¢ï¼Œé¿å…çº§è”å›æ»šã€‚</p>
</li>
<li>
<p><strong>å¼ºä¸¤é˜¶æ®µé”(rigorous two-phase locking)</strong>ï¼šæ‰€æœ‰é”ä¿æŒåˆ°æäº¤/ä¸­æ­¢ï¼Œç¡®ä¿äº‹åŠ¡æŒ‰æäº¤é¡ºåºåºåˆ—åŒ–ã€‚</p>
</li>
</ul>
<p>ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯èƒ½é‡åˆ°ä»¥ä¸‹æƒ…å†µï¼š</p>
<div align="center">    
<img src="../images/DB/db38.png" alt="deadlock_example"/>
</div>

<p>T3 å’Œ T4 å‡æ— æ³•ç»§ç»­æ‰§è¡Œ â€‹â€‹ã€‚æ‰§è¡Œ lock-S(B) ä¼šå¯¼è‡´ T4 ç­‰å¾… T3 é‡Šæ”¾ B çš„é”ï¼›è€Œæ‰§è¡Œ lock-X(A) ä¼šå¯¼è‡´ T3 ç­‰å¾… T4 é‡Šæ”¾ A çš„é”ã€‚ç±»ä¼¼è¿™ç§æƒ…å†µè¢«ç§°ä¸º<strong>æ­»é”(deadlock)</strong>ã€‚æ­¤æ—¶ï¼Œç³»ç»Ÿä¼šå°† T3 å’Œ T4 è¿›è¡Œå›æ»šï¼Œå¹¶é‡Šæ”¾é”ã€‚2PL æœºåˆ¶å¹¶ä¸èƒ½å®Œå…¨è§„é¿æ­»é”ã€‚æ›´åçš„æ˜¯ï¼Œæˆ‘ä»¬è¿˜æœ‰å¯èƒ½é‡åˆ°è¿™ç§æƒ…å†µï¼š</p>
<blockquote>
<p>ä¸€ä¸ªäº‹åŠ¡æ­£åœ¨ç­‰å¾…å¯¹æŸæ•°æ®å¯¹è±¡çš„ X é”ï¼Œç„¶è€ŒåŒæ—¶ï¼Œä¸€ç³»åˆ—å…¶ä»–äº‹åŠ¡å·²ç»é’ˆå¯¹åŒä¸€ä¸ªæ•°æ®å¯¹è±¡è¢«æˆäºˆäº† S é”ã€‚è¿™ä¼šé€ æˆæ­»é”ã€‚ç³»ç»Ÿå°†æŒç»­å›æ»šäº‹åŠ¡ï¼Œè¿™ä¸ªå¯æ€œçš„ç­‰å¾… X é”çš„äº‹åŠ¡å°±ä¼šè¢«åå¤å›æ»šã€‚</p>
</blockquote>
<p>æˆ‘ä»¬ç§°ä¸Šé¢è¿™ç§æƒ…å†µå‘ç”Ÿäº†<strong>é¥¥è’(starvation)</strong>ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡å®ç°ä¸€ä¸ª Lock Manager æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚é”ç®¡ç†å™¨éœ€è¦å®ç°ä¸€ä¸ª Lock Table ï¼Œåœ¨å†…å­˜ä¸­ç”¨å“ˆå¸Œè¡¨å½’ç±»æ•°æ®ï¼Œæ¯ä¸ªæ•°æ®ä¸‹è¾–é“¾è¡¨å‚¨å­˜å½“å‰é”çš„æƒ…å†µã€‚ä¾‹å¦‚ä¸‹å›¾ä¸­ I7 æ•°æ®æ´¾é”ç»™ T23 ï¼Œ I23 æ•°æ®æ´¾é”ç»™ T1ã€T8 è€Œ T2 åœ¨ç­‰å¾…ã€‚</p>
<div align="center">    
<img src="../images/DB/db37.png" alt="lock_example" style="zoom: 70%"/>
</div>

<div class="admonition danger">
<p class="admonition-title">å¹»è¯»</p>
<p>å‡å¦‚æˆ‘ä»¬åº”ç”¨äº†ä¸¤é˜¶æ®µé”ç®¡ç†äº‹åŠ¡ï¼Œé‚£ä¹ˆåˆ é™¤æˆ–æ’å…¥æ“ä½œæ—¶ï¼Œè¦æ’å…¥æˆ–è€…åˆ é™¤çš„è¡Œéƒ½ä¼šè¢«åŠ ä¸Š X é”...è¿™çœ‹èµ·æ¥æ²¡é—®é¢˜ï¼Œä½†æ˜¯...</p>
<blockquote>
<p>ä¸€ä¸ªäº‹åŠ¡æ­£åœ¨æ‰«æå…¨è¡¨ï¼Œæ­¤æ—¶å¦ä¸€ä¸ªäº‹åŠ¡æ­£åœ¨å‘è¯¥è¡¨ä¸­æ’å…¥è¡Œã€‚é¦–å…ˆä»è¯­ä¹‰ä¸Šï¼Œè¿™é‡Œå·²ç»å‘ç”Ÿäº†å†²çªã€‚å¦‚æœè¿™æ—¶åªå¯¹å˜åŠ¨è¡ŒåŠ é”ï¼Œéä¸²è¡Œè°ƒåº¦å°±ä¼šå¯¼è‡´â€”â€”æ‰«æå…¨è¡¨çš„äº‹åŠ¡å¹¶ä¸çŸ¥é“æ–°è¡Œçš„åŠ å…¥ï¼Œä½†æ˜¯è¯»å‡ºæ¥çš„ç»“æœå´æœ‰è¿™ä¸ªæ–°åŠ çš„è¡Œã€‚(åˆ é™¤ä¹Ÿæ˜¯åŒç†)</p>
</blockquote>
<p>è¿™æ ·å°±å‘ç”Ÿäº†<strong>å¹»è¯»(phantom phenomenon)</strong>ã€‚</p>
</div>
<p>æˆ‘ä»¬æœ‰æ–¹æ³•å¯ä»¥è§£å†³å¹»è¯»ï¼š</p>
<ul>
<li>
<p>å…³ç³»(relation)çº§é”ï¼šæ‰«ææ—¶åŠ  S é”ï¼Œæ’å…¥/åˆ é™¤æ—¶åŠ  X é”ã€‚</p>
</li>
<li>
<p>ç´¢å¼•é”åè®®ï¼šé”å®šç´¢å¼•å¶å­èŠ‚ç‚¹ï¼ˆ S/X é”ï¼‰é¿å…å¹»è¯»ã€‚</p>
</li>
</ul>
<h3 id="_28">æ­»é”å¤„ç†<a class="headerlink" href="#_28" title="Permanent link">&para;</a></h3>
<p>å¯¹æ­»é”çš„å¤„ç†å¯ä»¥åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šé¢„é˜²å’Œæ£€æµ‹ã€‚</p>
<ul>
<li>
<p><strong>é¢„é˜²</strong></p>
<p>ç³»ç»Ÿä¼šç»™æ¯ä¸ªäº‹åŠ¡èµ‹äºˆæ—¶é—´æˆ³ã€‚é¢„é˜²å­˜åœ¨å‡ ç§æœºåˆ¶ï¼š</p>
<ul>
<li>
<p>Wait-Die ï¼šè¿™æ˜¯ä¸€ç§ä¸æŠ¢å (non-preemptive)çš„ç­–ç•¥ã€‚è€äº‹åŠ¡å¯ä»¥ç­‰å¾…æ–°äº‹åŠ¡çš„èµ„æºï¼Œä½†æ–°äº‹åŠ¡è‹¥éœ€è€äº‹åŠ¡çš„èµ„æºåˆ™ç›´æ¥å›æ»šï¼ˆä¸æŠ¢å ï¼‰ã€‚</p>
</li>
<li>
<p>Wound-Wait ï¼šè¿™æ˜¯ä¸€ç§æŠ¢å (preemptive)çš„ç­–ç•¥ã€‚è€äº‹åŠ¡å¯ä»¥æŠ¢å ï¼ˆå¼ºåˆ¶å›æ»šï¼‰æ–°äº‹åŠ¡æŒæœ‰çš„èµ„æºã€‚</p>
</li>
</ul>
<p>è¿™ä¸¤ç§æœºåˆ¶éƒ½å¯ä»¥ä¿è¯åœ¨ç­‰å¾…åˆ—è¡¨é‡Œä¸å­˜åœ¨ç¯ã€‚</p>
<ul>
<li>Timeout-Based ï¼šä¸€ä¸ªäº‹åŠ¡ç­‰å¾…è¶…æ—¶åå›æ»šè¯¥äº‹åŠ¡ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ£€æµ‹</strong></p>
<p>æˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ªç­‰å¾…å›¾(wait-for graph)ã€‚ç­‰å¾…å›¾æ˜¯ä¸€ç§æœ‰å‘å›¾ï¼Œå…¶é¡¶ç‚¹æ˜¯ç³»ç»Ÿä¸­çš„æ‰€æœ‰äº‹åŠ¡ã€‚å¦‚æœäº‹åŠ¡ <span class="arithmatex">\(T_i\)</span> æ­£åœ¨ç­‰å¾… <span class="arithmatex">\(T_j\)</span>ï¼Œæˆ‘ä»¬å°±ä» <span class="arithmatex">\(T_i\)</span> å¼•å‡ºä¸€æ¡æœ‰å‘è¾¹æŒ‡å‘ <span class="arithmatex">\(T_j\)</span>ã€‚æ­»é”æ£€æµ‹å°±å¯ä»¥åŸºäºæ­¤è¿›è¡Œï¼šå¦‚æœæˆ‘ä»¬çš„ç­‰å¾…å›¾æ˜¯æ²¡æœ‰æœ‰å‘ç¯çš„ï¼Œé‚£ä¹ˆç³»ç»Ÿä¸­å°±ä¸å­˜åœ¨æ­»é”ã€‚</p>
<p>å¦‚æœæ£€æµ‹åˆ°æ­»é”ï¼Œæˆ‘ä»¬ä¸€èˆ¬é€‰æ‹©ä»£ä»·æœ€å°çš„äº‹åŠ¡ä½œä¸ºç‰ºç‰²è€…å›æ»šã€‚</p>
</li>
</ul>
<h3 id="tree-based-protocol">Tree-Based Protocol<a class="headerlink" href="#tree-based-protocol" title="Permanent link">&para;</a></h3>
<p>æ ‘çŠ¶é”çš„è¦æ±‚æ˜¯ï¼š</p>
<ul>
<li>
<p>äº‹åŠ¡åªèƒ½ç”³è¯· X é”ï¼Œå¹¶ä¸”å¯¹ä¸€ä¸ªæ•°æ®å¯¹è±¡åªèƒ½ç”³é”ä¸€æ¬¡ã€‚</p>
</li>
<li>
<p>äº‹åŠ¡çš„ç¬¬ä¸€æŠŠé”å¯ä»¥æ˜¯ä»»ä½•æ•°æ®å¯¹è±¡çš„ï¼›æ¥ä¸‹æ¥ï¼Œåªæœ‰è¯¥äº‹åŠ¡æŒæœ‰äº†æ•°æ®å¯¹è±¡çš„çˆ¶èŠ‚ç‚¹çš„é”ï¼Œæ‰å¯ä»¥ç»™æ•°æ®å¯¹è±¡åŠ é”ã€‚</p>
</li>
<li>
<p>æ•°æ®å¯¹è±¡å¯ä»¥åœ¨ä»»ä½•æ—¶å€™è§£é”ã€‚</p>
</li>
</ul>
<div align="center">    
<img src="../images/DB/db39.png" alt="tree_lock_example" style="zoom: 70%"/>
</div>

<p>ç‰¹æ€§ï¼š</p>
<ul>
<li>
<p>ä¿è¯å†²çªå¯ä¸²è¡ŒåŒ–</p>
</li>
<li>
<p>ä¿è¯æ— æ­»é”ï¼ˆä¼˜äº 2PL ï¼‰</p>
</li>
<li>
<p>ä¸ä¿è¯æ— è”çº§å›æ»šï¼Œä½†å¯é€šè¿‡å¢åŠ é™åˆ¶â€œæ’ä»–é”åªæœ‰åˆ°äº‹åŠ¡ç»“æŸæ—¶æ‰å¯ä»¥é‡Šæ”¾â€æ¥å®ç°</p>
</li>
<li>
<p>ç›¸æ¯”äºŒé˜¶æ®µé”åè®®è§£é”æ—¶é—´è‡ªç”±</p>
</li>
</ul>
<p>é—®é¢˜ï¼š</p>
<ul>
<li>æœ‰æ—¶ä¼šç»™ä¸éœ€è¦è®¿é—®çš„æ•°æ®é¡¹åŠ é”ï¼ˆè¦æ±‚å…ˆç»™çˆ¶èŠ‚ç‚¹åŠ é”ï¼‰ï¼Œä¼šå¢åŠ é”å¼€é”€</li>
</ul>
<h3 id="multiple-granularity-locking">å¤šç²’åº¦é”(Multiple Granularity Locking)<a class="headerlink" href="#multiple-granularity-locking" title="Permanent link">&para;</a></h3>
<p>å¤šç²’åº¦é”ï¼ˆ Multiple Granularity Locking ï¼‰çš„å­˜åœ¨æ˜¯ä¸ºäº†<strong>è§£å†³æ•°æ®åº“ç³»ç»Ÿä¸­å¹¶å‘æ§åˆ¶ä¸ç³»ç»Ÿæ€§èƒ½ä¹‹é—´çš„æ ¸å¿ƒçŸ›ç›¾</strong>ï¼Œå³å¦‚ä½•åœ¨ä¿è¯æ•°æ®ä¸€è‡´æ€§çš„åŒæ—¶ï¼Œæœ€å¤§é™åº¦åœ°æå‡å¹¶å‘æ•ˆç‡ã€‚ä»¥ä¸‹æ˜¯å…¶å­˜åœ¨çš„å…³é”®åŸå› å’Œè®¾è®¡é€»è¾‘ï¼š</p>
<p><strong>1. è§£å†³â€œé”å¼€é”€â€ä¸â€œå¹¶å‘åº¦â€çš„æƒè¡¡é—®é¢˜</strong></p>
<ul>
<li>
<p><strong>é—®é¢˜èƒŒæ™¯</strong>ï¼š</p>
</li>
<li>
<p><strong>ç»†ç²’åº¦é”</strong>ï¼ˆå¦‚è¡Œé”ï¼‰ï¼šå¹¶å‘åº¦é«˜ï¼ˆå¤šä¸ªäº‹åŠ¡å¯åŒæ—¶ä¿®æ”¹ä¸åŒè¡Œï¼‰ï¼Œä½†ç®¡ç†å¼€é”€å¤§ï¼ˆéœ€ç»´æŠ¤å¤§é‡é”ï¼‰ã€‚</p>
</li>
<li>
<p><strong>ç²—ç²’åº¦é”</strong>ï¼ˆå¦‚è¡¨é”ï¼‰ï¼šç®¡ç†ç®€å•ï¼ˆåªéœ€ä¸€ä¸ªé”ï¼‰ï¼Œä½†å¹¶å‘åº¦ä½ï¼ˆæ•´ä¸ªè¡¨è¢«é”ä½ï¼Œé˜»å¡å…¶ä»–äº‹åŠ¡ï¼‰ã€‚</p>
</li>
<li>
<p><strong>å¤šç²’åº¦é”çš„æŠ˜ä¸­</strong>ï¼š</p>
</li>
<li>
<p>å…è®¸ç³»ç»Ÿ<strong>åŠ¨æ€é€‰æ‹©é”çš„ç²’åº¦</strong>ï¼ˆæ•°æ®åº“ â†’ åŒºåŸŸ â†’ æ–‡ä»¶ â†’ è®°å½•ï¼‰ï¼Œæ ¹æ®æ“ä½œéœ€æ±‚å¹³è¡¡å¼€é”€ä¸å¹¶å‘ã€‚</p>
</li>
</ul>
<p><strong>2. æ”¯æŒå¤æ‚æ“ä½œçš„çµæ´»æ€§</strong></p>
<ul>
<li>
<p><strong>åœºæ™¯ä¸¾ä¾‹</strong>ï¼š</p>
</li>
<li>
<p><strong>äº‹åŠ¡ A</strong>ï¼šéœ€è¦æ‰«ææ•´å¼ è¡¨ï¼ˆé€‚åˆè¡¨çº§ S é”ï¼‰ã€‚</p>
</li>
<li>
<p><strong>äº‹åŠ¡ B</strong>ï¼šåªéœ€ä¿®æ”¹æŸä¸€è¡Œï¼ˆé€‚åˆè¡Œçº§ X é”ï¼‰ã€‚</p>
</li>
<li>
<p><strong>å¤šç²’åº¦é”çš„ä½œç”¨</strong>ï¼š</p>
</li>
<li>
<p>äº‹åŠ¡ A åŠ è¡¨çº§ S é”åï¼Œäº‹åŠ¡ B ä»å¯å¯¹æœªå†²çªçš„è¡ŒåŠ  X é”ï¼Œé¿å…å…¨è¡¨é˜»å¡ã€‚</p>
</li>
</ul>
<p><strong>3. é¿å…â€œéšå¼èµ„æºå†²çªâ€</strong></p>
<p>ä¾‹å¦‚å¹»è¯»é—®é¢˜ã€‚</p>
<ul>
<li>
<p><strong>å¤šç²’åº¦é”çš„è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
</li>
<li>
<p>é€šè¿‡<strong>æ„å‘é”ï¼ˆ Intention Lock ï¼‰</strong>åœ¨é«˜å±‚çº§ï¼ˆå¦‚è¡¨ï¼‰æ ‡è®°ä½å±‚çº§ï¼ˆå¦‚è¡Œï¼‰çš„é”å®šæ„å›¾ï¼Œä½¿æ‰«æäº‹åŠ¡ï¼ˆåŠ è¡¨çº§ IS é”ï¼‰å’Œæ’å…¥äº‹åŠ¡ï¼ˆåŠ è¡¨çº§ IX é”ï¼‰èƒ½æå‰å‘ç°å†²çªã€‚</p>
</li>
</ul>
<p><strong>4. æ„å‘é”çš„æ ¸å¿ƒä½œç”¨</strong></p>
<p>å¤šç²’åº¦é”é€šè¿‡å¼•å…¥<strong>æ„å‘é”ï¼ˆ IS/IX/SIX ï¼‰</strong>å®ç°å±‚çº§åè°ƒï¼š</p>
<ol>
<li>
<p><strong>æ„å‘å…±äº«é”ï¼ˆ IS ï¼‰</strong>ï¼š  </p>
</li>
<li>
<p>è¡¨ç¤ºäº‹åŠ¡å°†åœ¨ä½å±‚çº§ï¼ˆå¦‚è¡Œï¼‰åŠ  S é”ã€‚  </p>
</li>
<li>
<p>å…¶ä»–äº‹åŠ¡å¯åŒæ—¶è·å–è¡¨çº§ IS é”ï¼ˆå…è®¸å¹¶è¡Œè¯»ï¼‰ã€‚</p>
</li>
<li>
<p><strong>æ„å‘æ’ä»–é”ï¼ˆ IX ï¼‰</strong>ï¼š  </p>
</li>
<li>
<p>è¡¨ç¤ºäº‹åŠ¡å°†åœ¨ä½å±‚çº§åŠ  X é”ã€‚  </p>
</li>
<li>
<p>ä¸è¡¨çº§ S é”äº’æ–¥ï¼ˆé˜²æ­¢è„è¯»ï¼‰ã€‚</p>
</li>
<li>
<p><strong>å…±äº«æ„å‘æ’ä»–é”ï¼ˆ SIX ï¼‰</strong>ï¼š  </p>
</li>
<li>
<p>è¡¨ç¤ºäº‹åŠ¡æŒæœ‰è¡¨çº§ S é”ï¼Œå¹¶å°†åœ¨ä½å±‚çº§åŠ  X é”ï¼ˆå¦‚å…ˆè¯»å…¨è¡¨å†æ”¹æŸè¡Œï¼‰ã€‚</p>
</li>
</ol>
<p><strong>å…¼å®¹æ€§çŸ©é˜µ</strong>ï¼š</p>
<table>
<thead>
<tr>
<th>è¯·æ±‚ \ æŒæœ‰</th>
<th>IS</th>
<th>IX</th>
<th>SIX</th>
<th>S</th>
<th>X</th>
</tr>
</thead>
<tbody>
<tr>
<td>IS</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âŒ</td>
</tr>
<tr>
<td>IX</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âŒ</td>
<td>âŒ</td>
<td>âŒ</td>
</tr>
<tr>
<td>SIX</td>
<td>âœ…</td>
<td>âŒ</td>
<td>âŒ</td>
<td>âŒ</td>
<td>âŒ</td>
</tr>
<tr>
<td>S</td>
<td>âœ…</td>
<td>âŒ</td>
<td>âŒ</td>
<td>âœ…</td>
<td>âŒ</td>
</tr>
<tr>
<td>X</td>
<td>âŒ</td>
<td>âŒ</td>
<td>âŒ</td>
<td>âŒ</td>
<td>âŒ</td>
</tr>
</tbody>
</table>
<p><strong>5. æ€§èƒ½ä¼˜åŒ–ç¤ºä¾‹</strong></p>
<ul>
<li><strong>åœºæ™¯</strong>ï¼š  </li>
</ul>
<p>äº‹åŠ¡ A éœ€æ›´æ–° 1 ä¸‡è¡Œä¸­çš„ 10 è¡Œã€‚</p>
<ul>
<li><strong>æ— å¤šç²’åº¦é”</strong>ï¼š  </li>
</ul>
<p>éœ€ç”³è¯· 1 ä¸‡ä¸ªè¡Œé”ï¼Œå¼€é”€æå¤§ã€‚</p>
<ul>
<li>
<p><strong>å¤šç²’åº¦é”</strong>ï¼š  </p>
</li>
<li>
<p>å¯¹è¡¨åŠ  IX é”ï¼ˆæ ‡è®°â€œåç»­ä¼šä¿®æ”¹æŸäº›è¡Œâ€ï¼‰ã€‚  </p>
</li>
<li>
<p>ä»…å¯¹ç›®æ ‡ 10 è¡ŒåŠ  X é”ã€‚  </p>
</li>
</ul>
<p>å…¶ä»–äº‹åŠ¡ä»å¯è¯»å–æœªå†²çªçš„è¡Œã€‚</p>
<p><strong>å¤šç²’åº¦é”çš„ä»·å€¼</strong></p>
<ol>
<li>
<p><strong>æå‡å¹¶å‘</strong>ï¼šä¸åŒç²’åº¦é”ç»„åˆå‡å°‘ä¸å¿…è¦çš„é˜»å¡ã€‚  </p>
</li>
<li>
<p><strong>é™ä½å¼€é”€</strong>ï¼šé¿å…ä¸ºæ¯ä¸ªå°æ•°æ®é¡¹å•ç‹¬åŠ é”ã€‚  </p>
</li>
<li>
<p><strong>é˜²æ­¢å¹»è¯»</strong>ï¼šé€šè¿‡é«˜å±‚çº§æ„å‘é”æ£€æµ‹æ½œåœ¨å†²çªã€‚  </p>
</li>
<li>
<p><strong>çµæ´»é€‚é…</strong>ï¼šæ ¹æ®æ“ä½œç±»å‹ï¼ˆå…¨è¡¨æ‰«æ vs å•è¡Œä¿®æ”¹ï¼‰é€‰æ‹©æœ€ä¼˜é”ç­–ç•¥ã€‚  </p>
</li>
</ol>
<p>å¤šç²’åº¦é”æ˜¯æ•°æ®åº“ç³»ç»Ÿåœ¨<strong>ä¸€è‡´æ€§</strong>ã€<strong>å¹¶å‘åº¦</strong>å’Œ<strong>æ€§èƒ½</strong>ä¹‹é—´æ‰¾åˆ°çš„æœ€ä½³å¹³è¡¡ç‚¹ä¹‹ä¸€ã€‚</p>
<h2 id="_29">é”™è¯¯æ¢å¤<a id="Recovery"></a><a class="headerlink" href="#_29" title="Permanent link">&para;</a></h2>
<p>åœ¨æ•°æ®åº“ç³»ç»Ÿè¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½é‡åˆ°å„ç§å„æ ·çš„æ•…éšœ(failure)ï¼š</p>
<ul>
<li>
<p>äº‹åŠ¡æ•…éšœï¼ˆ Transaction Failure ï¼‰</p>
<ul>
<li>
<p>é€»è¾‘é”™è¯¯ï¼ˆ Logical Errors ï¼‰</p>
<p>äº‹åŠ¡å› å†…éƒ¨é”™è¯¯æ¡ä»¶ï¼ˆå¦‚è¿åä¸šåŠ¡è§„åˆ™ï¼‰æ— æ³•ç»§ç»­æ‰§è¡Œï¼›å¦‚è½¬è´¦é‡‘é¢ä¸ºè´Ÿå€¼ã€é™¤é›¶é”™è¯¯ç­‰ã€‚</p>
</li>
<li>
<p>ç³»ç»Ÿé”™è¯¯ï¼ˆ System Errors ï¼‰</p>
<p>æ•°æ®åº“ç³»ç»Ÿå¿…é¡»ä¸»åŠ¨ç»ˆæ­¢æ´»åŠ¨äº‹åŠ¡çš„é”™è¯¯æ¡ä»¶ï¼›å¦‚æ­»é”ç­‰ã€‚</p>
</li>
</ul>
</li>
<li>
<p>ç³»ç»Ÿå´©æºƒï¼ˆ System Crash ï¼‰</p>
<p>ç”±ç”µæºæ•…éšœã€ç¡¬ä»¶/è½¯ä»¶æ•…éšœå¯¼è‡´ç³»ç»Ÿæ„å¤–ç»ˆæ­¢ã€‚</p>
<ul>
<li>
<p><strong>æ•…éšœåœæ­¢å‡è®¾ï¼ˆ Fail-stop Assumption ï¼‰</strong>ï¼šå‡å®šéæ˜“å¤±æ€§å­˜å‚¨ï¼ˆ Non-volatile Storage ï¼‰å†…å®¹åœ¨å´©æºƒæ—¶ä¸ä¼šè¢«ç ´åã€‚</p>
<ul>
<li>å®Œæ•´æ€§æ£€æŸ¥ï¼ˆ Integrity Checks ï¼‰ï¼šæ•°æ®åº“ç³»ç»Ÿé€šè¿‡å¤šé‡æ ¡éªŒé˜²æ­¢ç£ç›˜æ•°æ®æŸåã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="_30">æ—¥å¿—<a class="headerlink" href="#_30" title="Permanent link">&para;</a></h3>
<p>ä¸ºäº†ç¡®ä¿å‘ç”Ÿæ•…éšœæ—¶ä»ç„¶èƒ½ä¿æŒåŸå­æ€§ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆä¿å­˜æè¿°æ›´æ”¹çš„ä¿¡æ¯ï¼Œè€Œä¸æ˜¯ç›´æ¥æ›´æ”¹æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚</p>
<div align="center">    
<img src="../images/DB/db40.png" alt="data_access_example" style="zoom: 70%"/>
</div>

<p>å¯¹æ¯ä¸€ä¸ªäº‹åŠ¡çš„æ¯ä¸€ä¸ª write åšè®°å½•ï¼š</p>
<ul>
<li>
<p>Transaction å¼€å§‹æ—¶ï¼Œè®°å½• \&lt; Ti start &gt;</p>
</li>
<li>
<p>å¯¹æ¯ä¸€ä¸ªå†™æ“ä½œï¼Œè®°å½• \&lt; äº‹åŠ¡ç¼–å· Ti ï¼Œå†™æ•°æ®çš„ä½ç½® D ï¼ŒåŸå€¼ V0 ï¼Œæ–°å€¼ V1 &gt;</p>
</li>
<li>
<p>æäº¤æ—¶ï¼Œè®°å½• \&lt; T1 commit/abort &gt;</p>
</li>
</ul>
<p>å¯¹äºæ—¥å¿—çš„æ›´æ–°æ—¶æœŸï¼Œæˆ‘ä»¬åˆæœ‰ä¸¤ç§æ–¹æ¡ˆï¼š</p>
<ul>
<li>
<p><strong>deferred-modification</strong>ï¼š</p>
<p>å†™æ“ä½œåœ¨ commit ä»¥å‰éƒ½æ˜¯åœ¨ä¸´æ—¶å˜é‡ä¸­åšï¼Œ commit åä¸€æ¬¡å†™å…¥ buff/disk</p>
</li>
<li>
<p><strong>immediate-modification</strong>ï¼š</p>
<p>å…è®¸åœ¨ commit ä¹‹å‰å°†å€¼å†™å…¥ buff/diskã€‚</p>
<p><strong>æ•°æ®é¡¹å†™å…¥å‰ï¼Œå…¶æ›´æ–°æ—¥å¿—è®°å½•å¿…é¡»å·²æŒä¹…åŒ–ï¼›æ•°æ®åº“é¡µåˆ·å‡ºåˆ°ç£ç›˜å‰ï¼Œå…¶å…³è”çš„æ‰€æœ‰æ—¥å¿—è®°å½•å¿…é¡»å·²è¾“å‡ºã€‚</strong></p>
</li>
</ul>
<p>æœ¬ç« ä¸­æˆ‘ä»¬åªè®¨è®º immediate çš„åšæ³•ã€‚</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  å›åˆ°é¡µé¢é¡¶éƒ¨
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["toc.follow", "content.code.copy", "search.share", "search.suggest", "search.highlight", "navigation.tracking", "navigation.tabs", "navigation.indexes", "navigation.top"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://cdn.tonycrane.cc/utils/katex.min.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>