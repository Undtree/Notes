# 期末复习

> ~~孩子们，这门课真的不能速通...~~

---

## 第一章：引言
*   **网络模型**：
    *   **C/S 模式**：客户端/服务器模式。
    *   **P2P 模式**：对等网络模式。
*   **网络硬件分类**：
    *   按传输技术：广播式网络、点对点网络。
    *   按规模：PAN (蓝牙，RFID)、LAN (以太网/WiFi)、MAN (有线电视)、WAN (由主机和子网组成，子网由传输线和交换设备组成)、互联网络 (Inter-networks)。
*   **网络软件**：
    *   **协议 (Protocol)**：通信双方关于如何通信的协议，定义了报文格式和意义。
    *   **服务 (Service)**：层与层之间的接口，下层为上层提供的原语操作。
*   **参考模型**：
    *   **OSI (Open Systems Interconnection) 模型**：7层（物理、数据链路、网络、传输、会话、表示、应用）。
    *   **TCP/IP 模型**：4层（主机-网络、互联、传输、应用）。
    !!! Note "OSI 和 TCP/IP 参考模型的不同"
        -   服务/接口/协议
            -   OSI 对这三个核心概念加以明确区分；TCP/IP 则没有清晰划分。
        -   设计方法
            -   OSI 模型优先；TCP/IP 协议优先。
        -   层数不同。
        -   面向连接 vs 无连接
            -   OSI 认为“网络应该尽力提供完美的连接”，所以网络层支持面向连接和无连接两种方式，传输层是面向连接的；TCP/IP 认为网络内部应该尽可能简单，复杂的逻辑应该放在网络边缘的设备上，所以网络层是无连接的，传输层支持面向连接和无连接两种方式。
    *   我们使用五层模型（物理、数据链路、网络、传输、应用）。
*   网络的例子：
    *   因特网（从 1969 年 12 月发明的 APARNET 发源）；
    *   无线局域网：802.11.
*   **网络标准相关**：
    *   ITU，国际电信联盟
    *   ISO，国际标准化组织
    *   IEEE，电气与电子工程师协会；主要负责 LAN 和 MAN 标准
    *   IAB，互联网架构委员会
        *   IAB 有两个主要分支： IRTF + IETF（研究、工程）
        *   RFC 是 IETF 发布的所有互联网正式标准的文件形式。

---

## 第二章：物理层
!!! Abstact "要点速览"
    -   理论基础
    -   传输介质
    -   数字调制 (Modulation) 与复用 (Multiplexing)
    -   公共交换电话网络，PSTN

*   **数据速率计算**：
    *   **比特率 = 码元速率 (波特率) $\times$ 每个码元携带的比特数**。调制方法决定了 bits per symbol
    *   **奈奎斯特定理 (无噪声)**：最大波特率 $B = 2H$，数据速率 $B = 2H \log_2 V$ (H为带宽，V为离散电平数)。
    *   **香农定理 (有噪声)**：最大数据速率 $B = H \log_2 (1 + S/N)$。
    *   **信噪比 (SNR)**：用分贝表示，$dB = 10 \log_{10} S/N$。
*   **传输介质**：有线（双绞线、同轴电缆、电力线、光纤）和无线（无线电、微波、红外、光波）。
    
    ![freq-of-waves](images/Network/freq.png){ width="600" style="display: block; margin: 0 auto;" }

*   **数字调制与复用**：
    *   **基带传输**：编码方式包括 NRZ、NRZI、曼彻斯特编码（Ex 2: 两个码元代表1比特，效率50%）、AMI。
    *   **通带传输**：调幅、调频、调相。星座图包括 QPSK、QAM-16、QAM-64。
    *   **复用技术**：FDM (频分)、TDM (时分)、WDM (波分)、CDM (码分)。
        *   **CDM (码分复用)**：每个站分配一个唯一的、互相正交的码片序列。发送 1 为原码，发送 0 为反码。
*   **PSTN**
    *   三个主要部分：Local loops (客户 -> 交换所) / trunks (交换所间的长距离链接) / switching offices
---

## 第三章：数据链路层
*   **功能**：成帧 (Framing)、差错控制、流量控制。
*   **成帧方法**：字节计数法、带字节填充的定界符法、带比特填充的定界符法（例如 `01111110`，逢5个1填0）、物理层编码违例法。
*   **差错控制**：
    *   **海明距离**：两个码字之间不同位的个数。
    *   **检错/纠错能力**：**检测** $d$ 个错误需要距离 $d+1$；**纠正** $d$ 个错误需要 $2d+1$。
    *   **校验方式**：奇偶校验、校验和 (Checksum)、**CRC (循环冗余校验)**（基于多项式模2除法，加减法等同于异或）。
*   **流量控制 (滑动窗口)**：
    *   **停止-等待协议**：利用率 $U = 1 / (2\alpha + 1)$，其中 $\alpha = T_{prop} / T_{frame}$。

    ![stop-and-wait](images/Network/stop-and-wait.png)

    *   **滑动窗口协议**：GBN (回退N帧)、SR (选择重传)。窗口大小需满足：$发送窗口 + 接收窗口 \le 2^n$。
*   **PPP 协议**：点对点协议。包含 LCP (链路控制) 和 NCP (网络控制)。

---

## 第四章：介质访问控制子层 (MAC Sublayer)
*   **信道分配协议**：
    *   **ALOHA**：纯 ALOHA (吞吐量 $S=G e^{-2G}$)、分隙 ALOHA ($S=G e^{-G}$)。
    *   **CSMA (载波侦听多路访问)**：1-坚持、非坚持、p-坚持。
    *   **CSMA/CD**：带冲突检测。检测冲突最长时间为 $2\tau$（两倍传播时延）。
    *   **无冲突协议**：位图协议、令牌环、二进制倒数协议。
*   **无线局域网 (802.11)**：
    *   **问题**：隐藏终端问题、暴露终端问题。
    *   **解决**：CSMA/CA (带冲突避免)，使用 RTS/CTS 握手及 NAV (虚拟侦听)。
*   **冲突避免协议**：
    *   位图 (Bitmap) / 令牌 (Token passing) / 二进制倒数 (Binary count down)
*   **以太网 (802.3)**：
    *   **二进制指数退避算法**：第 $i$ 次冲突后，随机等待 $0 \sim 2^i-1$ 个时隙。
    *   **设备**：集线器 (Hub) 属于一层，交换机 (Switch) 属于二层。冲突域 vs 广播域。

---

## 第五章：网络层
*   **服务类型**：无连接服务 (数据报) vs 面向连接服务 (虚电路)。
*   **路由算法**：
    *   **距离矢量路由 (DV)**：Bellman-Ford 算法，存在“无穷大计数”问题。
    *   **链路状态路由 (LS)**：OSPF 协议基础，使用 Dijkstra 算法计算最短路径。
    *   **分层路由**：通过区域划分减少路由表规模。
    *   **其他**：广播 (逆向路径转发)、组播 (剪枝生成树)、Anycast (选播)。
*   **互联网协议 (IPv4)**：
    *   **首部**：版本、IHL、总长度、标识/标志/偏移 (用于分片)、TTL、协议、校验和、源/目地址。
    *   **CIDR (无分类域间路由)**：最长前缀匹配。
    *   **NAT (网络地址转换)**：私有地址转换，缓解 IP 枯竭，涉及 NAT 穿透问题。
*   **IPv6**：128位地址，简化首部，取消校验和，支持扩展首部。
*   **辅助协议**：ICMP (控制报文)、ARP (IP 转 MAC)、DHCP (动态获取 IP)。
*   **路由协议**：RIP (内部, DV)、OSPF (内部, LS)、BGP (外部, 策略路由)。
*   **SDN (软件定义网络)**：数据平面（局部转发）与控制平面（全局逻辑）分离。

---

## 第六章：传输层
*   **服务原语 (Sockets)**：SOCKET, BIND, LISTEN, ACCEPT, CONNECT, SEND, RECEIVE, CLOSE。
*   **UDP**：无连接、不可靠、8字节首部。
*   **TCP**：面向连接、全双工字节流。
    *   **连接管理**：三次握手建立，四次挥手释放。
    *   **计时器管理**：$SRTT$ (平滑RTT)、$RTO$ (重传超时) 计算。
        *   公式：$RTO = SRTT + 4 \times RTTVAR$。
    *   **拥塞控制**：
        *   **TCP Tahoe**：慢启动 (SS) + 拥塞避免 (CA)。
        *   **TCP Reno**：引入快重传/快恢复 (Fast Recovery)。
        *   **算法逻辑**：收到3个冗余确认时，门限设为当前窗口的一半。

---

## 第七章：应用层
*   **DNS (域名系统)**：
    *   资源记录：A (IPv4), AAAA (IPv6), MX (邮件), CNAME (别名) 等。
    *   查询方式：递归查询 vs 迭代查询。
*   **电子邮件**：
    *   协议：SMTP (发送), POP3/IMAP (接收)。
    *   格式：MIME (多用途互联网邮件扩展)、Base64 编码。
*   **WWW (万维网)**：
    *   **HTTP 协议**：1.0 (短连接)、1.1 (持久连接/流水线)、2.0 (二进制分帧/多路复用/服务器推送)、3.0 (基于 QUIC/UDP)。
    *   **动态网页**：AJAX (异步 JS 和 XML) 技术栈。
    *   **Cookies**：包含 Domain, Path, Content, Expires, Secure 五个字段。